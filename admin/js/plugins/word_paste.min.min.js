/*!
 * froala_editor v2.7.6 (https://www.froala.com/wysiwyg-editor)
 * License https://froala.com/wysiwyg-editor/terms/
 * Copyright 2014-2018 Froala Labs
 */
;!function(b){"function"==typeof define&&define.amd?define(["jquery"],b):"object"==typeof module&&module.exports?module.exports=function(a,d){return void 0===d&&(d="undefined"!=typeof window?require("jquery"):require("jquery")(a)),b(d)}:b(window.jQuery)}(function(b){b.extend(b.FE.DEFAULTS,{wordDeniedTags:[],wordDeniedAttrs:[],wordAllowedStyleProps:["font-family","font-size","background","color","width","text-align","vertical-align","background-color","padding","margin","height","margin-top","margin-left","margin-right","margin-bottom","text-decoration","font-weight","font-style"],wordPasteModal:!0}),b.FE.PLUGINS.wordPaste=function(aj){function ai(){aj.events.on("paste.wordPaste",function(c){return Q=c,aj.opts.wordPasteModal?ag():ae(!0),!1})}function ah(){var c='<div class="fr-word-paste-modal" style="padding: 20px 20px 10px 20px;">';return c+='<p style="text-align: left;">'+aj.language.translate("The pasted content is coming from a Microsoft Word document. Do you want to keep the format or clean it up?")+"</p>",c+='<div style="text-align: right; margin-top: 50px;"><button class="fr-remove-word fr-command">'+aj.language.translate("Clean")+'</button> <button class="fr-keep-word fr-command">'+aj.language.translate("Keep")+"</button></div>",c+="</div>"}function ag(){if(!S){var j='<h4><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 74.95 73.23" style="height: 25px; vertical-align: text-bottom; margin-right: 5px; display: inline-block"><defs><style>.a{fill:#2a5699;}.b{fill:#fff;}</style></defs><path class="a" d="M615.15,827.22h5.09V834c9.11.05,18.21-.09,27.32.05a2.93,2.93,0,0,1,3.29,3.25c.14,16.77,0,33.56.09,50.33-.09,1.72.17,3.63-.83,5.15-1.24.89-2.85.78-4.3.84-8.52,0-17,0-25.56,0v6.81h-5.32c-13-2.37-26-4.54-38.94-6.81q0-29.8,0-59.59c13.05-2.28,26.11-4.5,39.17-6.83Z" transform="translate(-575.97 -827.22)"/><path class="b" d="M620.24,836.59h28.1v54.49h-28.1v-6.81h22.14v-3.41H620.24v-4.26h22.14V873.2H620.24v-4.26h22.14v-3.41H620.24v-4.26h22.14v-3.41H620.24v-4.26h22.14v-3.41H620.24V846h22.14v-3.41H620.24Zm-26.67,15c1.62-.09,3.24-.16,4.85-.25,1.13,5.75,2.29,11.49,3.52,17.21,1-5.91,2-11.8,3.06-17.7,1.7-.06,3.41-.15,5.1-.26-1.92,8.25-3.61,16.57-5.71,24.77-1.42.74-3.55,0-5.24.09-1.13-5.64-2.45-11.24-3.47-16.9-1,5.5-2.29,10.95-3.43,16.42q-2.45-.13-4.92-.3c-1.41-7.49-3.07-14.93-4.39-22.44l4.38-.18c.88,5.42,1.87,10.82,2.64,16.25,1.2-5.57,2.43-11.14,3.62-16.71Z" transform="translate(-575.97 -827.22)"/></svg> '+aj.language.translate("Word Paste Detected")+"</h4>",i=ah(),h=aj.modals.create(O,j,i),d=h.$body;S=h.$modal,h.$modal.addClass("fr-middle"),aj.events.bindClick(d,"button.fr-remove-word",function(){var c=S.data("instance")||aj;c.wordPaste.clean()}),aj.events.bindClick(d,"button.fr-keep-word",function(){var c=S.data("instance")||aj;c.wordPaste.clean(!0)}),aj.events.$on(b(aj.o_win),"resize",function(){aj.modals.resize(O)})}aj.modals.show(O),aj.modals.resize(O)}function af(){aj.modals.hide(O)}function ae(e){var g=aj.opts.wordAllowedStyleProps;e||(aj.opts.wordAllowedStyleProps=[]),0===Q.indexOf("<colgroup>")&&(Q="<table>"+Q+"</table>"),Q=Q.replace(/<span[\n\r ]*style='mso-spacerun:yes'>[\r\n\u00a0 ]*<\/span>/g,"&nbsp;"),Q=U(Q,aj.paste.getRtfClipboard());var f=aj.doc.createElement("DIV");f.innerHTML=Q,aj.html.cleanBlankSpaces(f),Q=f.innerHTML,Q=aj.paste.cleanEmptyTagsAndDivs(Q),Q=Q.replace(/\u200b/g,""),af(),aj.paste.clean(Q,!0,!0),aj.opts.wordAllowedStyleProps=g}function ad(d){var c=d.parentNode;c&&d.parentNode.removeChild(d)}function ac(g,f){if(f(g)){for(var j=g.firstChild;j;){var i=j,h=j.previousSibling;j=j.nextSibling,ac(i,f),i.previousSibling||i.nextSibling||i.parentNode||!j||h==j.previousSibling||!j.parentNode?i.previousSibling||i.nextSibling||i.parentNode||!j||j.previousSibling||j.nextSibling||j.parentNode||(h?j=h.nextSibling?h.nextSibling.nextSibling:null:g.firstChild&&(j=g.firstChild.nextSibling)):j=h?h.nextSibling:g.firstChild}}}function ab(d){if(!d.getAttribute("style")||!/mso-list:[\s]*l/gi.test(d.getAttribute("style").replace(/\n/gi,""))){return !1}try{if(!d.querySelector('[style="mso-list:Ignore"]')){return !1}}catch(c){return !1}return !0}function aa(c){return c.getAttribute("style").replace(/\n/gi,"").replace(/.*level([0-9]+?).*/gi,"$1")}function Z(g,f){var j=g.cloneNode(!0);if(-1!=["H1","H2","H3","H4","H5","H6"].indexOf(g.tagName)){var i=document.createElement(g.tagName.toLowerCase());i.setAttribute("style",g.getAttribute("style")),i.innerHTML=j.innerHTML,j.innerHTML=i.outerHTML}ac(j,function(c){return c.nodeType==Node.ELEMENT_NODE&&("mso-list:Ignore"==c.getAttribute("style")&&c.parentNode.removeChild(c),H(c,f)),!0});var h=j.innerHTML;return h=h.replace(/<!--[\s\S]*?-->/gi,"")}function Y(A,z){var y=/[0-9a-zA-Z]./gi,x=!1;A.firstElementChild&&A.firstElementChild.firstElementChild&&A.firstElementChild.firstElementChild.firstChild&&(x=x||y.test(A.firstElementChild.firstElementChild.firstChild.data||""),!x&&A.firstElementChild.firstElementChild.firstElementChild&&A.firstElementChild.firstElementChild.firstElementChild.firstChild&&(x=x||y.test(A.firstElementChild.firstElementChild.firstElementChild.firstChild.data||"")));var w=x?"ol":"ul",v=aa(A),u="<"+w+"><li>"+Z(A,z),t=A.nextElementSibling,m=A.parentNode;for(ad(A),A=null;t&&ab(t);){var l=t.previousElementSibling,k=aa(t);if(k>v){u+=Y(t,z).outerHTML}else{if(v>k){break}u+="</li><li>"+Z(t,z)}if(v=k,t.previousElementSibling||t.nextElementSibling||t.parentNode){var j=t;t=t.nextElementSibling,ad(j),j=null}else{t=l?l.nextElementSibling:m.firstElementChild}}u+="</li></"+w+">";var h=document.createElement("div");h.innerHTML=u;var B=h.firstElementChild;return B}function X(g,f){for(var j=document.createElement(f),i=0;i<g.attributes.length;i++){var h=g.attributes[i].name;j.setAttribute(h,g.getAttribute(h))}return j.innerHTML=g.innerHTML,g.parentNode.replaceChild(j,g),j}function W(aw,av){aj.node.clearAttributes(aw);for(var au=aw.firstElementChild,at=0,ar=!1,aq=null;au;){au.firstElementChild&&-1!=au.firstElementChild.tagName.indexOf("W:")&&(au.innerHTML=au.firstElementChild.innerHTML),aq=au.getAttribute("width"),aq||ar||(ar=!0),at+=parseInt(aq,10),(!au.firstChild||au.firstChild&&au.firstChild.data==b.FE.UNICODE_NBSP)&&(au.firstChild&&ad(au.firstChild),au.innerHTML="<br>");for(var ap=au.firstElementChild,ao=1==au.children.length;ap;){"P"!=ap.tagName||ab(ap)||ao&&V(ap),ap=ap.nextElementSibling}if(av){var an=au.getAttribute("class");if(an){an=T(an);var am=an.match(/xl[0-9]+/gi);if(am){var al=am[0],E="."+al;av[E]&&R(au,av[E])}}av.td&&R(au,av.td)}var D=au.getAttribute("style");D&&(D=T(D),D&&";"!=D.slice(-1)&&(D+=";"));var C=au.getAttribute("valign");if(!C&&D){var r=D.match(/vertical-align:.+?[; "]{1,1}/gi);r&&(C=r[r.length-1].replace(/vertical-align:(.+?)[; "]{1,1}/gi,"$1"))}var q=null;if(D){var p=D.match(/text-align:.+?[; "]{1,1}/gi);p&&(q=p[p.length-1].replace(/text-align:(.+?)[; "]{1,1}/gi,"$1")),"general"==q&&(q=null)}var j=null;if(D){var h=D.match(/background:.+?[; "]{1,1}/gi);h&&(j=h[h.length-1].replace(/background:(.+?)[; "]{1,1}/gi,"$1"))}var ak=au.getAttribute("colspan"),F=au.getAttribute("rowspan");ak&&au.setAttribute("colspan",ak),F&&au.setAttribute("rowspan",F),C&&(au.style["vertical-align"]=C),q&&(au.style["text-align"]=q),j&&(au.style["background-color"]=j),aq&&au.setAttribute("width",aq),au=au.nextElementSibling}for(au=aw.firstElementChild;au;){aq=au.getAttribute("width"),ar?au.removeAttribute("width"):au.setAttribute("width",100*parseInt(aq,10)/at+"%"),au=au.nextElementSibling}}function V(e){var d=e.parentNode,f=e.getAttribute("align");f&&(d&&"TD"==d.tagName?(d.setAttribute("style",d.getAttribute("style")+"text-align:"+f+";"),e.removeAttribute("align")):(e.style["text-align"]=f,e.removeAttribute("align")))}function T(c){return c.replace(/\n|\r|\n\r|&quot;/g,"")}function R(g,f,j){if(f){var i=g.getAttribute("style");i&&";"!=i.slice(-1)&&(i+=";"),f&&";"!=f.slice(-1)&&(f+=";"),f=f.replace(/\n/gi,"");var h=null;h=j?(i||"")+f:f+(i||""),g.setAttribute("style",h)}}function P(v){var u=v.getAttribute("style");if(u){u=T(u),u&&";"!=u.slice(-1)&&(u+=";");var t=u.match(/(^|\S+?):.+?;{1,1}/gi);if(t){for(var s={},r=0;r<t.length;r++){var q=t[r],p=q.split(":");2==p.length&&("text-align"!=p[0]||"SPAN"!=v.tagName)&&(s[p[0]]=p[1])}var o="";for(var n in s){if(s.hasOwnProperty(n)){if("font-size"==n&&"pt;"==s[n].slice(-3)){var m=null;try{m=parseFloat(s[n].slice(0,-3),10)}catch(l){}m&&(m=Math.round(1.33*m),s[n]=m+"px;")}o+=n+":"+s[n]}}o&&v.setAttribute("style",o)}}}function N(g){for(var f=g.match(/[0-9a-f]{2}/gi),j=[],i=0;i<f.length;i++){j.push(String.fromCharCode(parseInt(f[i],16)))}var h=j.join("");return btoa(h)}function L(z,y,x){for(var w=z.split(x),v=1;v<w.length;v++){var u=w[v];if(u=u.split("shplid"),u.length>1){u=u[1];for(var t="",s=0;s<u.length&&"\\"!=u[s]&&"{"!=u[s]&&" "!=u[s]&&"\r"!=u[s]&&"\n"!=u[s];){t+=u[s],s++}var r=u.split("bliptag");if(r&&r.length<2){continue}var q=null;if(-1!=r[0].indexOf("pngblip")?q="image/png":-1!=r[0].indexOf("jpegblip")&&(q="image/jpeg"),!q){continue}var p=r[1].split("}");if(p&&p.length<2){continue}var o;if(p.length>2&&-1!=p[0].indexOf("blipuid")){o=p[1].split(" ")}else{if(o=p[0].split(" "),o&&o.length<2){continue}o.shift()}var n=o.join("");M[y+t]={image_hex:n,image_type:q}}}}function J(c){M={},L(c,"i","\\shppict"),L(c,"s","\\shp{")}function I(i,o){if(o){var n;if("IMG"==i.tagName){var m=i.getAttribute("src");if(!m||-1==m.indexOf("file://")){return}n=K[i.getAttribute("v:shapes")],n||(n=i.getAttribute("v:shapes"))}else{n=i.parentNode.getAttribute("o:spid")}if(i.removeAttribute("height"),n){J(o);var l=M[n.substring(7)];if(l){var k=N(l.image_hex),j="data:"+l.image_type+";base64,"+k;"IMG"===i.tagName?(i.src=j,i.setAttribute("data-fr-image-pasted",!0)):b(i.parentNode).before('<img data-fr-image-pasted="true" src="'+j+'" style="'+i.parentNode.getAttribute("style")+'">').remove()}}}}function H(ar,aq){var ap=ar.tagName,ao=ap.toLowerCase();ar.firstElementChild&&("I"==ar.firstElementChild.tagName?X(ar.firstElementChild,"em"):"B"==ar.firstElementChild.tagName&&X(ar.firstElementChild,"strong"));var an=["SCRIPT","APPLET","EMBED","NOFRAMES","NOSCRIPT"];if(-1!=an.indexOf(ap)){return ad(ar),!1}var am=-1,al=["META","LINK","XML","ST1:","O:","W:","FONT"];for(am=0;am<al.length;am++){if(-1!=ap.indexOf(al[am])){return ar.innerHTML?(ar.outerHTML=ar.innerHTML,ad(ar),!1):(ad(ar),!1)}}if("TD"!=ap){var ak=ar.getAttribute("class");if(aq&&ak){ak=T(ak);var F=ak.split(" ");for(am=0;am<F.length;am++){var E=F[am],D=[],C="."+E;D.push(C),C=ao+C,D.push(C);for(var B=0;B<D.length;B++){aq[D[B]]&&R(ar,aq[D[B]])}}ar.removeAttribute("class")}aq&&aq[ao]&&R(ar,aq[ao])}var A=["P","H1","H2","H3","H4","H5","H6","PRE"];if(-1!=A.indexOf(ap)){var r=ar.getAttribute("class");if(r&&(aq&&aq[ap.toLowerCase()+"."+r]&&R(ar,aq[ap.toLowerCase()+"."+r]),-1!=r.toLowerCase().indexOf("mso"))){var q=T(r);q=q.replace(/[0-9a-z-_]*mso[0-9a-z-_]*/gi,""),q?ar.setAttribute("class",q):ar.removeAttribute("class")}var p=ar.getAttribute("style"),o=null;if(p){var n=p.match(/text-align:.+?[; "]{1,1}/gi);n&&(o=n[n.length-1].replace(/(text-align:.+?[; "]{1,1})/gi,"$1"))}V(ar)}if("TR"==ap&&W(ar,aq),"A"==ap&&!ar.attributes.getNamedItem("href")&&ar.innerHTML&&(ar.outerHTML=ar.innerHTML),"TD"!=ap&&"TH"!=ap||ar.innerHTML||(ar.innerHTML="<br>"),"TABLE"==ap&&(ar.style.width="100%"),ar.getAttribute("lang")&&ar.removeAttribute("lang"),ar.getAttribute("style")&&-1!=ar.getAttribute("style").toLowerCase().indexOf("mso")){var h=T(ar.getAttribute("style"));h=h.replace(/[0-9a-z-_]*mso[0-9a-z-_]*:.+?(;{1,1}|$)/gi,""),h?ar.setAttribute("style",h):ar.removeAttribute("style")}return !0}function G(v){var u={},t=v.getElementsByTagName("style");if(t.length){var s=t[0],r=s.innerHTML.match(/[\S ]+\s+{[\s\S]+?}/gi);if(r){for(var q=0;q<r.length;q++){var p=r[q],o=p.replace(/([\S ]+\s+){[\s\S]+?}/gi,"$1"),n=p.replace(/[\S ]+\s+{([\s\S]+?)}/gi,"$1");o=o.replace(/^[\s]|[\s]$/gm,""),n=n.replace(/^[\s]|[\s]$/gm,""),o=o.replace(/\n|\r|\n\r/g,""),n=n.replace(/\n|\r|\n\r/g,"");for(var m=o.split(", "),l=0;l<m.length;l++){u[m[l]]=n}}}}return u}function a(h){for(var g=h.split("v:shape"),l=1;l<g.length;l++){var k=g[l],j=k.split(' id="')[1];if(j&&j.length>1){j=j.split('"')[0];var i=k.split(' o:spid="')[1];i&&i.length>1&&(i=i.split('"')[0],K[j]=i)}}}function U(x,w){x=x.replace(/[.\s\S\w\W<>]*(<html[^>]*>[.\s\S\w\W<>]*<\/html>)[.\s\S\w\W<>]*/i,"$1"),a(x);var v=new DOMParser,u=v.parseFromString(x,"text/html"),t=u.head,s=u.body,r=G(t);ac(s,function(c){if(c.nodeType==Node.TEXT_NODE&&/\n|\u00a0|\r/.test(c.data)){if(!/\S| /.test(c.data)){return c.data==b.FE.UNICODE_NBSP?(c.data="\u200b",!0):1==c.data.length&&10==c.data.charCodeAt(0)?(c.data=" ",!0):(ad(c),!1)}c.data=c.data.replace(/\n|\r/gi," ")}return !0}),ac(s,function(c){return c.nodeType!=Node.ELEMENT_NODE||"V:IMAGEDATA"!=c.tagName&&"IMG"!=c.tagName||I(c,w),!0});for(var m=s.querySelectorAll("ul > ul, ul > ol, ol > ul, ol > ol"),j=m.length-1;j>=0;j--){m[j].previousElementSibling&&"LI"===m[j].previousElementSibling.tagName&&m[j].previousElementSibling.appendChild(m[j])}ac(s,function(g){if(g.nodeType==Node.TEXT_NODE){return g.data=g.data.replace(/<br>(\n|\r)/gi,"<br>"),!1}if(g.nodeType==Node.ELEMENT_NODE){if(ab(g)){var f=g.parentNode,n=g.previousSibling,l=Y(g,r),k=null;return k=n?n.nextSibling:f.firstChild,k?f.insertBefore(l,k):f.appendChild(l),!1}return H(g,r)}return g.nodeType==Node.COMMENT_NODE?(ad(g),!1):!0}),ac(s,function(e){if(e.nodeType==Node.ELEMENT_NODE){var d=e.tagName;if(!e.innerHTML&&-1==["BR","IMG"].indexOf(d)){for(var f=e.parentNode;f&&(ad(e),e=f,!e.innerHTML);){f=e.parentNode}return !1}P(e)}return !0});var i=s.outerHTML,h=aj.opts.htmlAllowedStyleProps;return aj.opts.htmlAllowedStyleProps=aj.opts.wordAllowedStyleProps,i=aj.clean.html(i,aj.opts.wordDeniedTags,aj.opts.wordDeniedAttrs,!1),aj.opts.htmlAllowedStyleProps=h,i}var S,Q,O="word_paste",M=null,K={};return{_init:ai,clean:ae}}});