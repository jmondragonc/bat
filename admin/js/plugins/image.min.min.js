/*!
 * froala_editor v2.7.6 (https://www.froala.com/wysiwyg-editor)
 * License https://froala.com/wysiwyg-editor/terms/
 * Copyright 2014-2018 Froala Labs
 */
;!function(b){"function"==typeof define&&define.amd?define(["jquery"],b):"object"==typeof module&&module.exports?module.exports=function(a,d){return void 0===d&&(d="undefined"!=typeof window?require("jquery"):require("jquery")(a)),b(d)}:b(window.jQuery)}(function(b){b.extend(b.FE.POPUP_TEMPLATES,{"image.insert":"[_BUTTONS_][_UPLOAD_LAYER_][_BY_URL_LAYER_][_PROGRESS_BAR_]","image.edit":"[_BUTTONS_]","image.alt":"[_BUTTONS_][_ALT_LAYER_]","image.size":"[_BUTTONS_][_SIZE_LAYER_]"}),b.extend(b.FE.DEFAULTS,{imageInsertButtons:["imageBack","|","imageUpload","imageByURL"],imageEditButtons:["imageReplace","imageAlign","imageCaption","imageRemove","|","imageLink","linkOpen","linkEdit","linkRemove","-","imageDisplay","imageStyle","imageAlt","imageSize"],imageAltButtons:["imageBack","|"],imageSizeButtons:["imageBack","|"],imageUpload:!0,imageUploadURL:"https://i.froala.com/upload",imageCORSProxy:"https://cors-anywhere.froala.com",imageUploadRemoteUrls:!0,imageUploadParam:"file",imageUploadParams:{},imageUploadToS3:!1,imageUploadMethod:"POST",imageMaxSize:10485760,imageAllowedTypes:["jpeg","jpg","png","gif"],imageResize:!0,imageResizeWithPercent:!1,imageRoundPercent:!1,imageDefaultWidth:300,imageDefaultAlign:"center",imageDefaultDisplay:"block",imageSplitHTML:!1,imageStyles:{"fr-rounded":"Rounded","fr-bordered":"Bordered","fr-shadow":"Shadow"},imageMove:!0,imageMultipleStyles:!0,imageTextNear:!0,imagePaste:!0,imagePasteProcess:!1,imageMinWidth:16,imageOutputSize:!1,imageDefaultMargin:5}),b.FE.PLUGINS.image=function(aU){function aT(){var d=aU.popups.get("image.insert"),e=d.find(".fr-image-by-url-layer input");e.val(""),al&&e.val(al.attr("src")),e.trigger("change")}function aQ(){var f=aU.$tb.find('.fr-command[data-cmd="insertImage"]'),i=aU.popups.get("image.insert");if(i||(i=bc()),ax(),!i.hasClass("fr-active")){if(aU.popups.refresh("image.insert"),aU.popups.setContainer("image.insert",aU.$tb),f.is(":visible")){var h=f.offset().left+f.outerWidth()/2,g=f.offset().top+(aU.opts.toolbarBottom?10:f.outerHeight()-10);aU.popups.show("image.insert",h,g,f.outerHeight())}else{aU.position.forSelection(i),aU.popups.show("image.insert")}}}function aP(){var f=aU.popups.get("image.edit");if(f||(f=az()),f){var i=bJ();bi()&&(i=i.find(".fr-img-wrap")),aU.popups.setContainer("image.edit",aU.$sc),aU.popups.refresh("image.edit");var h=i.offset().left+i.outerWidth()/2,g=i.offset().top+i.outerHeight();aU.popups.show("image.edit",h,g,i.outerHeight())}}function aO(){ax()}function aN(c){c.parents(".fr-img-caption").length>0&&(c=c.parents(".fr-img-caption:first")),c.hasClass("fr-dii")||c.hasClass("fr-dib")||(c.addClass("fr-fi"+af(c)[0]),c.addClass("fr-di"+bM(c)[0]),c.css("margin",""),c.css("float",""),c.css("display",""),c.css("z-index",""),c.css("position",""),c.css("overflow",""),c.css("vertical-align",""))}function aM(e){e.parents(".fr-img-caption").length>0&&(e=e.parents(".fr-img-caption:first"));var d=e.hasClass("fr-dib")?"block":e.hasClass("fr-dii")?"inline":null,f=e.hasClass("fr-fil")?"left":e.hasClass("fr-fir")?"right":af(e);aR(e,d,f),e.removeClass("fr-dib fr-dii fr-fir fr-fil")}function aJ(){for(var h="IMG"==aU.el.tagName?[aU.el]:aU.el.querySelectorAll("img"),g=0;g<h.length;g++){var f=b(h[g]);!aU.opts.htmlUntouched&&aU.opts.useClasses?((aU.opts.imageDefaultAlign||aU.opts.imageDefaultDisplay)&&aN(f),aU.opts.imageTextNear||(f.parents(".fr-img-caption").length>0?f.parents(".fr-img-caption:first").removeClass("fr-dii").addClass("fr-dib"):f.removeClass("fr-dii").addClass("fr-dib"))):aU.opts.htmlUntouched||aU.opts.useClasses||(aU.opts.imageDefaultAlign||aU.opts.imageDefaultDisplay)&&aM(f),aU.opts.iframe&&f.on("load",aU.size.syncIframe)}}function aI(p){"undefined"==typeof p&&(p=!0);var o,n=Array.prototype.slice.call(aU.el.querySelectorAll("img")),m=[];for(o=0;o<n.length;o++){if(m.push(n[o].getAttribute("src")),b(n[o]).toggleClass("fr-draggable",aU.opts.imageMove),""===n[o].getAttribute("class")&&n[o].removeAttribute("class"),""===n[o].getAttribute("style")&&n[o].removeAttribute("style"),n[o].parentNode&&n[o].parentNode.parentNode&&aU.node.hasClass(n[o].parentNode.parentNode,"fr-img-caption")){var l=n[o].parentNode.parentNode;aU.browser.mozilla||l.setAttribute("contenteditable",!1),l.setAttribute("draggable",!1),l.classList.add("fr-draggable");var k=n[o].nextSibling;k&&k.setAttribute("contenteditable",!0)}}if(ab){for(o=0;o<ab.length;o++){m.indexOf(ab[o].getAttribute("src"))<0&&aU.events.trigger("image.removed",[b(ab[o])])}}if(ab&&p){var j=[];for(o=0;o<ab.length;o++){j.push(ab[o].getAttribute("src"))}for(o=0;o<n.length;o++){j.indexOf(n[o].getAttribute("src"))<0&&aU.events.trigger("image.loaded",[b(n[o])])}}ab=n}function aH(){if(ae||bD(),!al){return !1}var f=aU.$wp||aU.$sc;f.append(ae),ae.data("instance",aU);var i=f.scrollTop()-("static"!=f.css("position")?f.offset().top:0),h=f.scrollLeft()-("static"!=f.css("position")?f.offset().left:0);h-=aU.helpers.getPX(f.css("border-left-width")),i-=aU.helpers.getPX(f.css("border-top-width")),aU.$el.is("img")&&aU.$sc.is("body")&&(i=0,h=0);var g=bJ();bi()&&(g=g.find(".fr-img-wrap")),ae.css("top",(aU.opts.iframe?g.offset().top:g.offset().top+i)-1).css("left",(aU.opts.iframe?g.offset().left:g.offset().left+h)-1).css("width",g.get(0).getBoundingClientRect().width).css("height",g.get(0).getBoundingClientRect().height).addClass("fr-active")}function aG(c){return'<div class="fr-handler fr-h'+c+'"></div>'}function aF(c){bi()?al.parents(".fr-img-caption").css("width",c):al.css("width",c)}function aD(t){if(!aU.core.sameInstance(ae)){return !0}if(t.preventDefault(),t.stopPropagation(),aU.$el.find("img.fr-error").left){return !1}aU.undo.canDo()||aU.undo.saveStep();var s=t.pageX||t.originalEvent.touches[0].pageX;if("mousedown"==t.type){var r=aU.$oel.get(0),q=r.ownerDocument,p=q.defaultView||q.parentWindow,o=!1;try{o=p.location!=p.parent.location&&!(p.$&&p.$.FE)}catch(n){}o&&p.frameElement&&(s+=aU.helpers.getPX(b(p.frameElement).offset().left)+p.frameElement.clientLeft)}bL=b(this),bL.data("start-x",s),bL.data("start-width",al.width()),bL.data("start-height",al.height());var m=al.width();if(aU.opts.imageResizeWithPercent){var l=al.parentsUntil(aU.$el,aU.html.blockTagsQuery()).get(0)||aU.el;m=(m/b(l).outerWidth()*100).toFixed(2)+"%"}aF(m),bC.show(),aU.popups.hideAll(),bB()}function aC(p){if(!aU.core.sameInstance(ae)){return !0}var o;if(bL&&al){if(p.preventDefault(),aU.$el.find("img.fr-error").left){return !1}var n=p.pageX||(p.originalEvent.touches?p.originalEvent.touches[0].pageX:null);if(!n){return !1}var m=bL.data("start-x"),l=n-m,k=bL.data("start-width");if((bL.hasClass("fr-hnw")||bL.hasClass("fr-hsw"))&&(l=0-l),aU.opts.imageResizeWithPercent){var j=al.parentsUntil(aU.$el,aU.html.blockTagsQuery()).get(0)||aU.el;k=((k+l)/b(j).outerWidth()*100).toFixed(2),aU.opts.imageRoundPercent&&(k=Math.round(k)),aF(k+"%"),o=bi()?(aU.helpers.getPX(al.parents(".fr-img-caption").css("width"))/b(j).outerWidth()*100).toFixed(2):(aU.helpers.getPX(al.css("width"))/b(j).outerWidth()*100).toFixed(2),o===k||aU.opts.imageRoundPercent||aF(o+"%"),al.css("height","").removeAttr("height")}else{k+l>=aU.opts.imageMinWidth&&(aF(k+l),o=bi()?aU.helpers.getPX(al.parents(".fr-img-caption").css("width")):aU.helpers.getPX(al.css("width"))),o!==k+l&&aF(o),((al.attr("style")||"").match(/(^height:)|(; *height:)/)||al.attr("height"))&&(al.css("height",bL.data("start-height")*al.width()/bL.data("start-width")),al.removeAttr("height"))}aH(),aU.events.trigger("image.resize",[bw()])}}function aB(c){if(!aU.core.sameInstance(ae)){return !0}if(bL&&al){if(c&&c.stopPropagation(),aU.$el.find("img.fr-error").left){return !1}bL=null,bC.hide(),aH(),aP(),aU.undo.saveStep(),aU.events.trigger("image.resizeEnd",[bw()])}}function aA(e,g,f){aU.edit.on(),al&&al.addClass("fr-error"),av(aU.language.translate("Something went wrong. Please try again.")),!al&&f&&aW(f),aU.events.trigger("image.error",[{code:e,message:ai[e]},g,f])}function az(f){if(f){return aU.$wp&&aU.events.$on(aU.$wp,"scroll",function(){al&&aU.popups.isVisible("image.edit")&&(aU.events.disableBlur(),at(al))}),!0}var i="";if(aU.opts.imageEditButtons.length>0){i+='<div class="fr-buttons">',i+=aU.button.buildList(aU.opts.imageEditButtons),i+="</div>";var h={buttons:i},g=aU.popups.create("image.edit",h);return g}return !1}function ay(g){var k=aU.popups.get("image.insert");if(k||(k=bc()),k.find(".fr-layer.fr-active").removeClass("fr-active").addClass("fr-pactive"),k.find(".fr-image-progress-bar-layer").addClass("fr-active"),k.find(".fr-buttons").hide(),al){var j=bJ();aU.popups.setContainer("image.insert",aU.$sc);var i=j.offset().left+j.width()/2,h=j.offset().top+j.height();aU.popups.show("image.insert",i,h,j.outerHeight())}"undefined"==typeof g&&aw(aU.language.translate("Uploading"),0)}function ax(e){var g=aU.popups.get("image.insert");if(g&&(g.find(".fr-layer.fr-pactive").addClass("fr-active").removeClass("fr-pactive"),g.find(".fr-image-progress-bar-layer").removeClass("fr-active"),g.find(".fr-buttons").show(),e||aU.$el.find("img.fr-error").length)){if(aU.events.focus(),aU.$el.find("img.fr-error").length&&(aU.$el.find("img.fr-error").remove(),aU.undo.saveStep(),aU.undo.run(),aU.undo.dropRedo()),!aU.$wp&&al){var f=al;ad(!0),aU.selection.setAfter(f.get(0)),aU.selection.restore()}aU.popups.hide("image.insert")}}function aw(f,i){var h=aU.popups.get("image.insert");if(h){var g=h.find(".fr-image-progress-bar-layer");g.find("h3").text(f+(i?" "+i+"%":"")),g.removeClass("fr-error"),i?(g.find("div").removeClass("fr-indeterminate"),g.find("div > span").css("width",i+"%")):g.find("div").addClass("fr-indeterminate")}}function av(f){ay();var i=aU.popups.get("image.insert"),h=i.find(".fr-image-progress-bar-layer");h.addClass("fr-error");var g=h.find("h3");g.text(f),aU.events.disableBlur(),g.focus()}function au(){var f=aU.popups.get("image.insert"),i=f.find(".fr-image-by-url-layer input");if(i.val().length>0){ay(),aw(aU.language.translate("Loading image"));var h=i.val();if(aU.opts.imageUploadRemoteUrls&&aU.opts.imageCORSProxy&&aU.opts.imageUpload){var g=new XMLHttpRequest;g.responseType="blob",g.onload=function(){200==this.status?bj([new Blob([this.response],{type:this.response.type||"image/png"})],al):aA(aS)},g.onerror=function(){aq(h,!0,[],al)},g.open("GET",aU.opts.imageCORSProxy+"/"+h,!0),g.send()}else{aq(h,!0,[],al)}i.val(""),i.blur()}}function at(c){ak.call(c.get(0))}function ar(){var d=b(this);aU.popups.hide("image.insert"),d.removeClass("fr-uploading"),d.next().is("br")&&d.next().remove(),at(d),aU.events.trigger("image.loaded",[d])}function aq(h,m,l,k,j){aU.edit.off(),aw(aU.language.translate("Loading image")),m&&(h=aU.helpers.sanitizeURL(h));var i=new Image;i.onload=function(){var p,o;if(k){aU.undo.canDo()||k.hasClass("fr-uploading")||aU.undo.saveStep();var n=k.data("fr-old-src");k.data("fr-image-pasted")&&(n=null),aU.$wp?(p=k.clone().removeData("fr-old-src").removeClass("fr-uploading").removeAttr("data-fr-image-pasted"),p.off("load"),n&&k.attr("src",n),k.replaceWith(p)):p=k;for(var f=p.get(0).attributes,e=0;e<f.length;e++){var d=f[e];0===d.nodeName.indexOf("data-")&&p.removeAttr(d.nodeName)}if("undefined"!=typeof l){for(o in l){l.hasOwnProperty(o)&&"link"!=o&&p.attr("data-"+o,l[o])}}p.on("load",ar),p.attr("src",h),aU.edit.on(),aI(!1),aU.undo.saveStep(),aU.events.disableBlur(),aU.$el.blur(),aU.events.trigger(n?"image.replaced":"image.inserted",[p,j])}else{p=bm(h,l,ar),aI(!1),aU.undo.saveStep(),aU.$el.blur(),aU.events.trigger("image.inserted",[p,j])}},i.onerror=function(){aA(aS)},ay(aU.language.translate("Loading image")),i.src=h}function bt(e){try{if(aU.events.trigger("image.uploaded",[e],!0)===!1){return aU.edit.on(),!1}var g=JSON.parse(e);return g.link?g:(aA(an,e),!1)}catch(f){return aA(bN,e),!1}}function bs(j){try{var i=b(j).find("Location").text(),h=b(j).find("Key").text();return aU.events.trigger("image.uploadedToS3",[i,h,j],!0)===!1?(aU.edit.on(),!1):i}catch(g){return aA(bN,j),!1}}function br(j){aw(aU.language.translate("Loading image"));var q=this.status,p=this.response,o=this.responseXML,n=this.responseText;try{if(aU.opts.imageUploadToS3){if(201==q){var m=bs(o);m&&aq(m,!1,[],j,p||o)}else{aA(bN,p||o,j)}}else{if(q>=200&&300>q){var l=bt(n);l&&aq(l.link,!1,l,j,p||n)}else{aA(ag,p||n,j)}}}catch(k){aA(bN,p||n,j)}}function bq(){aA(bN,this.response||this.responseText||this.responseXML)}function bn(d){if(d.lengthComputable){var e=d.loaded/d.total*100|0;aw(aU.language.translate("Uploading"),e)}}function bm(r,q,p){var o,n="";if(q&&"undefined"!=typeof q){for(o in q){q.hasOwnProperty(o)&&"link"!=o&&(n+=" data-"+o+'="'+q[o]+'"')}}var m=aU.opts.imageDefaultWidth;m&&"auto"!=m&&(m+=aU.opts.imageResizeWithPercent?"%":"px");var l=b('<img src="'+r+'"'+n+(m?' style="width: '+m+';"':"")+">");aR(l,aU.opts.imageDefaultDisplay,aU.opts.imageDefaultAlign),l.on("load",p),l.on("error",function(){b(this).addClass("fr-error"),aA(ap)}),aU.edit.on(),aU.events.focus(!0),aU.selection.restore(),aU.undo.saveStep(),aU.opts.imageSplitHTML?aU.markers.split():aU.markers.insert(),aU.html.wrap();var k=aU.$el.find(".fr-marker");return k.length?(k.parent().is("hr")&&k.parent().after(k),aU.node.isLastSibling(k)&&k.parent().hasClass("fr-deletable")&&k.insertAfter(k.parent()),k.replaceWith(l)):aU.$el.append(l),aU.selection.clear(),l}function bl(){aU.edit.on(),ax(!0)}function bk(p,o,n,m){function l(){var c=b(this);c.off("load"),c.addClass("fr-uploading"),c.next().is("br")&&c.next().remove(),aU.placeholder.refresh(),at(c),aH(),ay(),aU.edit.off(),p.onload=function(){br.call(p,c)},p.onerror=bq,p.upload.onprogress=bn,p.onabort=bl,c.off("abortUpload").on("abortUpload",function(){4!=p.readyState&&p.abort()}),p.send(o)}var k,j=new FileReader;j.addEventListener("load",function(){var f=j.result;if(j.result.indexOf("svg+xml")<0){for(var i=atob(j.result.split(",")[1]),h=[],g=0;g<i.length;g++){h.push(i.charCodeAt(g))}f=window.URL.createObjectURL(new Blob([new Uint8Array(h)],{type:"image/jpeg"}))}m?(m.on("load",l),m.one("error",function(){m.off("load"),m.attr("src",m.data("fr-old-src")),aA(ap)}),aU.edit.on(),aU.undo.saveStep(),m.data("fr-old-src",m.attr("src")),m.attr("src",f)):k=bm(f,null,l)},!1),j.readAsDataURL(n)}function bj(i,o){if("undefined"!=typeof i&&i.length>0){if(aU.events.trigger("image.beforeUpload",[i,o])===!1){return !1}var n=i[0];if(n.name||(n.name=(new Date).getTime()+".jpg"),n.size>aU.opts.imageMaxSize){return aA(bF),!1}if(aU.opts.imageAllowedTypes.indexOf(n.type.replace(/image\//g,""))<0){return aA(bv),!1}var m;if(aU.drag_support.formdata&&(m=aU.drag_support.formdata?new FormData:null),m){var l;if(aU.opts.imageUploadToS3!==!1){m.append("key",aU.opts.imageUploadToS3.keyStart+(new Date).getTime()+"-"+(n.name||"untitled")),m.append("success_action_status","201"),m.append("X-Requested-With","xhr"),m.append("Content-Type",n.type);for(l in aU.opts.imageUploadToS3.params){aU.opts.imageUploadToS3.params.hasOwnProperty(l)&&m.append(l,aU.opts.imageUploadToS3.params[l])}}for(l in aU.opts.imageUploadParams){aU.opts.imageUploadParams.hasOwnProperty(l)&&m.append(l,aU.opts.imageUploadParams[l])}m.append(aU.opts.imageUploadParam,n,n.name);var k=aU.opts.imageUploadURL;aU.opts.imageUploadToS3&&(k=aU.opts.imageUploadToS3.uploadURL?aU.opts.imageUploadToS3.uploadURL:"https://"+aU.opts.imageUploadToS3.region+".amazonaws.com/"+aU.opts.imageUploadToS3.bucket);var j=aU.core.getXHR(k,aU.opts.imageUploadMethod);bk(j,m,n,o||al)}}}function bg(d){aU.events.$on(d,"dragover dragenter",".fr-image-upload-layer",function(){return b(this).addClass("fr-drop"),!1},!0),aU.events.$on(d,"dragleave dragend",".fr-image-upload-layer",function(){return b(this).removeClass("fr-drop"),!1},!0),aU.events.$on(d,"drop",".fr-image-upload-layer",function(h){h.preventDefault(),h.stopPropagation(),b(this).removeClass("fr-drop");var g=h.originalEvent.dataTransfer;if(g&&g.files){var c=d.data("instance")||aU;c.events.disableBlur(),c.image.upload(g.files),c.events.enableBlur()}},!0),aU.helpers.isIOS()&&aU.events.$on(d,"touchstart",'.fr-image-upload-layer input[type="file"]',function(){b(this).trigger("click")},!0),aU.events.$on(d,"change",'.fr-image-upload-layer input[type="file"]',function(){if(this.files){var c=d.data("instance")||aU;c.events.disableBlur(),d.find("input:focus").blur(),c.events.enableBlur(),c.image.upload(this.files,al)}b(this).val("")},!0)}function bf(c){return c.is("img")&&c.parents(".fr-img-caption").length>0?c.parents(".fr-img-caption"):void 0}function be(n){var m=n.originalEvent.dataTransfer;if(m&&m.files&&m.files.length){var l=m.files[0];if(l&&l.type&&-1!==l.type.indexOf("image")&&aU.opts.imageAllowedTypes.indexOf(l.type.replace(/image\//g,""))>=0){if(!aU.opts.imageUpload){return n.preventDefault(),n.stopPropagation(),!1}aU.markers.remove(),aU.markers.insertAtPoint(n.originalEvent),aU.$el.find(".fr-marker").replaceWith(b.FE.MARKERS),0===aU.$el.find(".fr-marker").length&&aU.selection.setAtEnd(aU.el),aU.popups.hideAll();var k=aU.popups.get("image.insert");k||(k=bc()),aU.popups.setContainer("image.insert",aU.$sc);var j=n.originalEvent.pageX,i=n.originalEvent.pageY;return aU.opts.iframe&&(i+=aU.$iframe.offset().top,j+=aU.$iframe.offset().left),aU.popups.show("image.insert",j,i),ay(),aU.opts.imageAllowedTypes.indexOf(l.type.replace(/image\//g,""))>=0?(ad(!0),bj(m.files)):aA(bv),n.preventDefault(),n.stopPropagation(),!1}}}function bd(){aU.events.$on(aU.$el,aU._mousedown,"IMG"==aU.el.tagName?null:'img:not([contenteditable="false"])',function(d){return"false"==b(this).parents("[contenteditable]:not(.fr-element):not(.fr-img-caption):not(body):first").attr("contenteditable")?!0:(aU.helpers.isMobile()||aU.selection.clear(),bp=!0,aU.popups.areVisible()&&aU.events.disableBlur(),aU.browser.msie&&(aU.events.disableBlur(),aU.$el.attr("contenteditable",!1)),aU.draggable||"touchstart"==d.type||d.preventDefault(),void d.stopPropagation())}),aU.events.$on(aU.$el,aU._mouseup,"IMG"==aU.el.tagName?null:'img:not([contenteditable="false"])',function(d){return"false"==b(this).parents("[contenteditable]:not(.fr-element):not(.fr-img-caption):not(body):first").attr("contenteditable")?!0:void (bp&&(bp=!1,d.stopPropagation(),aU.browser.msie&&(aU.$el.attr("contenteditable",!0),aU.events.enableBlur())))}),aU.events.on("keyup",function(h){if(h.shiftKey&&""===aU.selection.text().replace(/\n/g,"")&&aU.keys.isArrow(h.which)){var g=aU.selection.element(),f=aU.selection.endElement();g&&"IMG"==g.tagName?at(b(g)):f&&"IMG"==f.tagName&&at(b(f))}},!0),aU.events.on("drop",be),aU.events.on("element.beforeDrop",bf),aU.events.on("mousedown window.mousedown",bK),aU.events.on("window.touchmove",bB),aU.events.on("mouseup window.mouseup",function(){return al?(ad(),!1):void bB()}),aU.events.on("commands.mousedown",function(c){c.parents(".fr-toolbar").length>0&&ad()}),aU.events.on("blur image.hideResizer commands.undo commands.redo element.dropped",function(){bp=!1,ad(!0)}),aU.events.on("modals.hide",function(){al&&(a(),aU.selection.clear())})}function bc(u){if(u){return aU.popups.onRefresh("image.insert",aT),aU.popups.onHide("image.insert",aO),!0}var t,s="";aU.opts.imageUpload||aU.opts.imageInsertButtons.splice(aU.opts.imageInsertButtons.indexOf("imageUpload"),1),aU.opts.imageInsertButtons.length>1&&(s='<div class="fr-buttons">'+aU.button.buildList(aU.opts.imageInsertButtons)+"</div>");var r=aU.opts.imageInsertButtons.indexOf("imageUpload"),q=aU.opts.imageInsertButtons.indexOf("imageByURL"),p="";r>=0&&(t=" fr-active",q>=0&&r>q&&(t=""),p='<div class="fr-image-upload-layer'+t+' fr-layer" id="fr-image-upload-layer-'+aU.id+'"><strong>'+aU.language.translate("Drop image")+"</strong><br>("+aU.language.translate("or click")+')<div class="fr-form"><input type="file" accept="image/'+aU.opts.imageAllowedTypes.join(", image/").toLowerCase()+'" tabIndex="-1" aria-labelledby="fr-image-upload-layer-'+aU.id+'" role="button"></div></div>');var o="";q>=0&&(t=" fr-active",r>=0&&q>r&&(t=""),o='<div class="fr-image-by-url-layer'+t+' fr-layer" id="fr-image-by-url-layer-'+aU.id+'"><div class="fr-input-line"><input id="fr-image-by-url-layer-text-'+aU.id+'" type="text" placeholder="http://" tabIndex="1" aria-required="true"></div><div class="fr-action-buttons"><button type="button" class="fr-command fr-submit" data-cmd="imageInsertByURL" tabIndex="2" role="button">'+aU.language.translate("Insert")+"</button></div></div>");var n='<div class="fr-image-progress-bar-layer fr-layer"><h3 tabIndex="-1" class="fr-message">Uploading</h3><div class="fr-loader"><span class="fr-progress"></span></div><div class="fr-action-buttons"><button type="button" class="fr-command fr-dismiss" data-cmd="imageDismissError" tabIndex="2" role="button">OK</button></div></div>',f={buttons:s,upload_layer:p,by_url_layer:o,progress_bar:n},c=aU.popups.create("image.insert",f);return aU.$wp&&aU.events.$on(aU.$wp,"scroll",function(){al&&aU.popups.isVisible("image.insert")&&ah()}),bg(c),c}function bb(){if(al){var c=aU.popups.get("image.alt");c.find("input").val(al.attr("alt")||"").trigger("change")}}function a8(){var f=aU.popups.get("image.alt");f||(f=a7()),ax(),aU.popups.refresh("image.alt"),aU.popups.setContainer("image.alt",aU.$sc);var i=bJ();bi()&&(i=i.find(".fr-img-wrap"));var h=i.offset().left+i.outerWidth()/2,g=i.offset().top+i.outerHeight();aU.popups.show("image.alt",h,g,i.outerHeight())}function a7(g){if(g){return aU.popups.onRefresh("image.alt",bb),!0}var k="";k='<div class="fr-buttons">'+aU.button.buildList(aU.opts.imageAltButtons)+"</div>";var j="";j='<div class="fr-image-alt-layer fr-layer fr-active" id="fr-image-alt-layer-'+aU.id+'"><div class="fr-input-line"><input id="fr-image-alt-layer-text-'+aU.id+'" type="text" placeholder="'+aU.language.translate("Alternate Text")+'" tabIndex="1"></div><div class="fr-action-buttons"><button type="button" class="fr-command fr-submit" data-cmd="imageSetAlt" tabIndex="2" role="button">'+aU.language.translate("Update")+"</button></div></div>";var i={buttons:k,alt_layer:j},h=aU.popups.create("image.alt",i);return aU.$wp&&aU.events.$on(aU.$wp,"scroll.image-alt",function(){al&&aU.popups.isVisible("image.alt")&&a8()}),h}function a6(d){if(al){var e=aU.popups.get("image.alt");al.attr("alt",d||e.find("input").val()||""),e.find("input:focus").blur(),at(al)}}function a5(){if(al){var c=aU.popups.get("image.size");c.find('input[name="width"]').val(al.get(0).style.width).trigger("change"),c.find('input[name="height"]').val(al.get(0).style.height).trigger("change")}}function a4(){var f=aU.popups.get("image.size");f||(f=a3()),ax(),aU.popups.refresh("image.size"),aU.popups.setContainer("image.size",aU.$sc);var i=bJ();bi()&&(i=i.find(".fr-img-wrap"));var h=i.offset().left+i.outerWidth()/2,g=i.offset().top+i.outerHeight();aU.popups.show("image.size",h,g,i.outerHeight())}function a3(g){if(g){return aU.popups.onRefresh("image.size",a5),!0}var k="";k='<div class="fr-buttons">'+aU.button.buildList(aU.opts.imageSizeButtons)+"</div>";var j="";j='<div class="fr-image-size-layer fr-layer fr-active" id="fr-image-size-layer-'+aU.id+'"><div class="fr-image-group"><div class="fr-input-line"><input id="fr-image-size-layer-width-'+aU.id+'" type="text" name="width" placeholder="'+aU.language.translate("Width")+'" tabIndex="1"></div><div class="fr-input-line"><input id="fr-image-size-layer-height'+aU.id+'" type="text" name="height" placeholder="'+aU.language.translate("Height")+'" tabIndex="1"></div></div><div class="fr-action-buttons"><button type="button" class="fr-command fr-submit" data-cmd="imageSetSize" tabIndex="2" role="button">'+aU.language.translate("Update")+"</button></div></div>";var i={buttons:k,size_layer:j},h=aU.popups.create("image.size",i);return aU.$wp&&aU.events.$on(aU.$wp,"scroll.image-size",function(){al&&aU.popups.isVisible("image.size")&&a4()}),h}function a2(f,i){if(al){var h=aU.popups.get("image.size");f=f||h.find('input[name="width"]').val()||"",i=i||h.find('input[name="height"]').val()||"";var g=/^[\d]+((px)|%)*$/g;al.removeAttr("width").removeAttr("height"),f.match(g)?al.css("width",f):al.css("width",""),i.match(g)?al.css("height",i):al.css("height",""),bi()&&(al.parent().removeAttr("width").removeAttr("height"),f.match(g)?al.parent().css("width",f):al.parent().css("width",""),i.match(g)?al.parent().css("height",i):al.parent().css("height","")),h.find("input:focus").blur(),at(al)}}function a1(h){var m,l,k=aU.popups.get("image.insert");if(al||aU.opts.toolbarInline){if(al){var j=bJ();bi()&&(j=j.find(".fr-img-wrap")),l=j.offset().top+j.outerHeight(),m=j.offset().left+j.outerWidth()/2}}else{var i=aU.$tb.find('.fr-command[data-cmd="insertImage"]');m=i.offset().left+i.outerWidth()/2,l=i.offset().top+(aU.opts.toolbarBottom?10:i.outerHeight()-10)}!al&&aU.opts.toolbarInline&&(l=k.offset().top-aU.helpers.getPX(k.css("margin-top")),k.hasClass("fr-above")&&(l+=k.outerHeight())),k.find(".fr-layer").removeClass("fr-active"),k.find(".fr-"+h+"-layer").addClass("fr-active"),aU.popups.show("image.insert",m,l,al?al.outerHeight():0),aU.accessibility.focusPopup(k)}function a0(d){var e=aU.popups.get("image.insert");e.find(".fr-image-upload-layer").hasClass("fr-active")&&d.addClass("fr-active").attr("aria-pressed",!0)}function aZ(d){var e=aU.popups.get("image.insert");e.find(".fr-image-by-url-layer").hasClass("fr-active")&&d.addClass("fr-active").attr("aria-pressed",!0)}function aY(f,e,h,g){return f.pageX=e,aD.call(this,f),f.pageX=f.pageX+h*Math.floor(Math.pow(1.1,g)),aC.call(this,f),aB.call(this,f),++g}function bD(){var j;if(aU.shared.$image_resizer?(ae=aU.shared.$image_resizer,bC=aU.shared.$img_overlay,aU.events.on("destroy",function(){ae.removeClass("fr-active").appendTo(b("body:first"))},!0)):(aU.shared.$image_resizer=b('<div class="fr-image-resizer"></div>'),ae=aU.shared.$image_resizer,aU.events.$on(ae,"mousedown",function(c){c.stopPropagation()},!0),aU.opts.imageResize&&(ae.append(aG("nw")+aG("ne")+aG("sw")+aG("se")),aU.shared.$img_overlay=b('<div class="fr-image-overlay"></div>'),bC=aU.shared.$img_overlay,j=ae.get(0).ownerDocument,b(j).find("body:first").append(bC))),aU.events.on("shared.destroy",function(){ae.html("").removeData().remove(),ae=null,aU.opts.imageResize&&(bC.remove(),bC=null)},!0),aU.helpers.isMobile()||aU.events.$on(b(aU.o_win),"resize",function(){al&&!al.hasClass("fr-uploading")?ad(!0):al&&(aH(),ah(),ay(!1))}),aU.opts.imageResize){j=ae.get(0).ownerDocument,aU.events.$on(ae,aU._mousedown,".fr-handler",aD),aU.events.$on(b(j),aU._mousemove,aC),aU.events.$on(b(j.defaultView||j.parentWindow),aU._mouseup,aB),aU.events.$on(bC,"mouseleave",aB);var i=1,h=null,g=0;aU.events.on("keydown",function(f){if(al){var e=-1!=navigator.userAgent.indexOf("Mac OS X")?f.metaKey:f.ctrlKey,d=f.which;(d!==h||f.timeStamp-g>200)&&(i=1),(d==b.FE.KEYCODE.EQUALS||aU.browser.mozilla&&d==b.FE.KEYCODE.FF_EQUALS)&&e&&!f.altKey?i=aY.call(this,f,1,1,i):(d==b.FE.KEYCODE.HYPHEN||aU.browser.mozilla&&d==b.FE.KEYCODE.FF_HYPHEN)&&e&&!f.altKey?i=aY.call(this,f,2,-1,i):aU.keys.ctrlKey(f)||d!=b.FE.KEYCODE.ENTER||(al.before("<br>"),at(al)),h=d,g=f.timeStamp}},!0),aU.events.on("keyup",function(){i=1})}}function aW(d){d=d||bJ(),d&&aU.events.trigger("image.beforeRemove",[d])!==!1&&(aU.popups.hideAll(),a(),ad(!0),aU.undo.canDo()||aU.undo.saveStep(),d.get(0)==aU.el?d.removeAttr("src"):("A"==d.get(0).parentNode.tagName?(aU.selection.setBefore(d.get(0).parentNode)||aU.selection.setAfter(d.get(0).parentNode)||d.parent().after(b.FE.MARKERS),b(d.get(0).parentNode).remove()):(aU.selection.setBefore(d.get(0))||aU.selection.setAfter(d.get(0))||d.after(b.FE.MARKERS),d.remove()),aU.html.fillEmptyBlocks(),aU.selection.restore()),aU.undo.saveStep())}function by(j){var i=j.which;if(al&&(i==b.FE.KEYCODE.BACKSPACE||i==b.FE.KEYCODE.DELETE)){return j.preventDefault(),j.stopPropagation(),aW(),!1}if(al&&i==b.FE.KEYCODE.ESC){var h=al;return ad(!0),aU.selection.setAfter(h.get(0)),aU.selection.restore(),j.preventDefault(),!1}if(al&&(i==b.FE.KEYCODE.ARROW_LEFT||i==b.FE.KEYCODE.ARROW_RIGHT)){var g=al.get(0);return ad(!0),i==b.FE.KEYCODE.ARROW_LEFT?aU.selection.setBefore(g):aU.selection.setAfter(g),aU.selection.restore(),j.preventDefault(),!1}return al&&i!=b.FE.KEYCODE.F10&&!aU.keys.isBrowserAction(j)?(j.preventDefault(),j.stopPropagation(),!1):void 0}function a9(g){if(g&&"IMG"==g.tagName){if(aU.node.hasClass(g,"fr-uploading")||aU.node.hasClass(g,"fr-error")?g.parentNode.removeChild(g):aU.node.hasClass(g,"fr-draggable")&&g.classList.remove("fr-draggable"),g.parentNode&&g.parentNode.parentNode&&aU.node.hasClass(g.parentNode.parentNode,"fr-img-caption")){var k=g.parentNode.parentNode;k.removeAttribute("contenteditable"),k.removeAttribute("draggable"),k.classList.remove("fr-draggable");var j=g.nextSibling;j&&j.removeAttribute("contenteditable")}}else{if(g&&g.nodeType==Node.ELEMENT_NODE){for(var i=g.querySelectorAll("img.fr-uploading, img.fr-error, img.fr-draggable"),h=0;h<i.length;h++){a9(i[h])}}}}function aE(){if(bd(),"IMG"==aU.el.tagName&&aU.$el.addClass("fr-view"),aU.events.$on(aU.$el,aU.helpers.isMobile()&&!aU.helpers.isWindowsPhone()?"touchend":"click","IMG"==aU.el.tagName?null:'img:not([contenteditable="false"])',ak),aU.helpers.isMobile()&&(aU.events.$on(aU.$el,"touchstart","IMG"==aU.el.tagName?null:'img:not([contenteditable="false"])',function(){bH=!1}),aU.events.$on(aU.$el,"touchmove",function(){bH=!0})),aU.$wp?(aU.events.on("window.keydown keydown",by,!0),aU.events.on("keyup",function(c){return al&&c.which==b.FE.KEYCODE.ENTER?!1:void 0},!0)):aU.events.$on(aU.$win,"keydown",by),aU.events.on("toolbar.esc",function(){if(al){if(aU.$wp){aU.events.disableBlur(),aU.events.focus()}else{var c=al;ad(!0),aU.selection.setAfter(c.get(0)),aU.selection.restore()}return !1}},!0),aU.events.on("toolbar.focusEditor",function(){return al?!1:void 0},!0),aU.events.on("window.cut window.copy",function(f){if(al&&aU.popups.isVisible("image.edit")&&!aU.popups.get("image.edit").find(":focus").length){var e=bJ();bi()?(e.before(b.FE.START_MARKER),e.after(b.FE.END_MARKER),aU.selection.restore(),aU.paste.saveCopiedText(e.get(0).outerHTML,e.text())):(a(),aU.paste.saveCopiedText(al.get(0).outerHTML,al.attr("alt"))),"copy"==f.type?setTimeout(function(){at(al)}):(ad(!0),aU.undo.saveStep(),setTimeout(function(){aU.undo.saveStep()},0))}},!0),aU.browser.msie&&aU.events.on("keydown",function(f){if(!aU.selection.isCollapsed()||!al){return !0}var e=f.which;e==b.FE.KEYCODE.C&&aU.keys.ctrlKey(f)?aU.events.trigger("window.copy"):e==b.FE.KEYCODE.X&&aU.keys.ctrlKey(f)&&aU.events.trigger("window.cut")}),aU.events.$on(b(aU.o_win),"keydown",function(e){var f=e.which;return al&&f==b.FE.KEYCODE.BACKSPACE?(e.preventDefault(),!1):void 0}),aU.events.$on(aU.$win,"keydown",function(e){var f=e.which;al&&al.hasClass("fr-uploading")&&f==b.FE.KEYCODE.ESC&&al.trigger("abortUpload")}),aU.events.on("destroy",function(){al&&al.hasClass("fr-uploading")&&al.trigger("abortUpload")}),aU.events.on("paste.before",bh),aU.events.on("paste.beforeCleanup",aK),aU.events.on("paste.after",ac),aU.events.on("html.set",aJ),aU.events.on("html.inserted",aJ),aJ(),aU.events.on("destroy",function(){ab=[]}),aU.events.on("html.processGet",a9),aU.opts.imageOutputSize){var d;aU.events.on("html.beforeGet",function(){d=aU.el.querySelectorAll("img");for(var h=0;h<d.length;h++){var g=d[h].style.width||b(d[h]).width(),c=d[h].style.height||b(d[h]).height();g&&d[h].setAttribute("width",(""+g).replace(/px/,"")),c&&d[h].setAttribute("height",(""+c).replace(/px/,""))}})}aU.opts.iframe&&aU.events.on("image.loaded",aU.size.syncIframe),aU.$wp&&(aI(),aU.events.on("contentChanged",aI)),aU.events.$on(b(aU.o_win),"orientationchange.image",function(){setTimeout(function(){al&&at(al)},100)}),az(!0),bc(!0),a3(!0),a7(!0),aU.events.on("node.remove",function(c){return"IMG"==c.get(0).tagName?(aW(c),!1):void 0})}function aj(l){if(aU.events.trigger("image.beforePasteUpload",[l])===!1){return !1}al=b(l),aH(),aP(),ah(),ay();for(var k=atob(b(l).attr("src").split(",")[1]),j=[],i=0;i<k.length;i++){j.push(k.charCodeAt(i))}var e=new Blob([new Uint8Array(j)],{type:"image/jpeg"});bj([e],al)}function ac(){aU.opts.imagePaste?aU.$el.find("img[data-fr-image-pasted]").each(function(j,i){if(aU.opts.imagePasteProcess){var h=aU.opts.imageDefaultWidth;h&&"auto"!=h&&(h+=aU.opts.imageResizeWithPercent?"%":"px"),b(i).css("width",h).removeClass("fr-dii fr-dib fr-fir fr-fil"),aR(b(i),aU.opts.imageDefaultDisplay,aU.opts.imageDefaultAlign)}if(0===i.src.indexOf("data:")){aj(i)}else{if(0===i.src.indexOf("blob:")||0===i.src.indexOf("http")&&aU.opts.imageUploadRemoteUrls&&aU.opts.imageCORSProxy){var g=new Image;g.crossOrigin="Anonymous",g.onload=function(){var d=aU.o_doc.createElement("CANVAS"),e=d.getContext("2d");d.height=this.naturalHeight,d.width=this.naturalWidth,e.drawImage(this,0,0),i.src=d.toDataURL("image/png"),aj(i)},g.src=(0===i.src.indexOf("blob:")?"":aU.opts.imageCORSProxy+"/")+i.src}else{0!==i.src.indexOf("http")||0===i.src.indexOf("https://mail.google.com/mail")?(aU.selection.save(),b(i).remove(),aU.selection.restore()):b(i).removeAttr("data-fr-image-pasted")}}}):aU.$el.find("img[data-fr-image-pasted]").remove()}function bI(f){var i=f.target.result,h=aU.opts.imageDefaultWidth;h&&"auto"!=h&&(h+=aU.opts.imageResizeWithPercent?"%":"px"),aU.undo.saveStep(),aU.html.insert('<img data-fr-image-pasted="true" src="'+i+'"'+(h?' style="width: '+h+';"':"")+">");var g=aU.$el.find('img[data-fr-image-pasted="true"]');g&&aR(g,aU.opts.imageDefaultDisplay,aU.opts.imageDefaultAlign),aU.events.trigger("paste.after")}function bz(d){var c=new FileReader;c.onload=bI,c.readAsDataURL(d)}function bh(e){if(e&&e.clipboardData&&e.clipboardData.items){var d=null;if(e.clipboardData.getData("text/rtf")){d=e.clipboardData.items[0].getAsFile()}else{for(var f=0;f<e.clipboardData.items.length&&!(d=e.clipboardData.items[f].getAsFile());f++){}}if(d){return bz(d),!1}}}function aK(c){return c=c.replace(/<img /gi,'<img data-fr-image-pasted="true" ')}function ak(f){if("false"==b(this).parents("[contenteditable]:not(.fr-element):not(.fr-img-caption):not(body):first").attr("contenteditable")){return !0}if(f&&"touchend"==f.type&&bH){return !0}if(f&&aU.edit.isDisabled()){return f.stopPropagation(),f.preventDefault(),!1}for(var e=0;e<b.FE.INSTANCES.length;e++){b.FE.INSTANCES[e]!=aU&&b.FE.INSTANCES[e].events.trigger("image.hideResizer")}aU.toolbar.disable(),f&&(f.stopPropagation(),f.preventDefault()),aU.helpers.isMobile()&&(aU.events.disableBlur(),aU.$el.blur(),aU.events.enableBlur()),aU.opts.iframe&&aU.size.syncIframe(),al=b(this),aU.browser.msie||a(),aH(),aP(),aU.browser.msie||aU.selection.clear(),aU.helpers.isIOS()&&(aU.events.disableBlur(),aU.$el.blur()),aU.button.bulkRefresh(),aU.events.trigger("video.hideResizer")}function ad(c){al&&(bo()||c===!0)&&(aU.toolbar.enable(),ae.removeClass("fr-active"),aU.popups.hide("image.edit"),al=null,bB(),bL=null,bC&&bC.hide())}function bK(){bx=!0}function bB(){bx=!1}function bo(){return bx}function aR(e,g,f){!aU.opts.htmlUntouched&&aU.opts.useClasses?(e.removeClass("fr-fil fr-fir fr-dib fr-dii"),f&&e.addClass("fr-fi"+f[0]),g&&e.addClass("fr-di"+g[0])):"inline"==g?(e.css({display:"inline-block",verticalAlign:"bottom",margin:aU.opts.imageDefaultMargin}),"center"==f?e.css({"float":"none",marginBottom:"",marginTop:"",maxWidth:"calc(100% - "+2*aU.opts.imageDefaultMargin+"px)",textAlign:"center"}):"left"==f?e.css({"float":"left",marginLeft:0,maxWidth:"calc(100% - "+aU.opts.imageDefaultMargin+"px)",textAlign:"left"}):e.css({"float":"right",marginRight:0,maxWidth:"calc(100% - "+aU.opts.imageDefaultMargin+"px)",textAlign:"right"})):"block"==g&&(e.css({display:"block","float":"none",verticalAlign:"top",margin:aU.opts.imageDefaultMargin+"px auto",textAlign:"center"}),"left"==f?e.css({marginLeft:0,textAlign:"left"}):"right"==f&&e.css({marginRight:0,textAlign:"right"}))}function am(d){var e=bJ();e.removeClass("fr-fir fr-fil"),!aU.opts.htmlUntouched&&aU.opts.useClasses?"left"==d?e.addClass("fr-fil"):"right"==d&&e.addClass("fr-fir"):aR(e,bM(),d),a(),aH(),aP(),aU.selection.clear()}function af(d){if("undefined"==typeof d&&(d=bJ()),d){if(d.hasClass("fr-fil")){return"left"}if(d.hasClass("fr-fir")){return"right"}if(d.hasClass("fr-dib")||d.hasClass("fr-dii")){return"center"}var c=d.css("float");if(d.css("float","none"),"block"==d.css("display")){if(d.css("float",""),d.css("float")!=c&&d.css("float",c),0===parseInt(d.css("margin-left"),10)){return"left"}if(0===parseInt(d.css("margin-right"),10)){return"right"}}else{if(d.css("float",""),d.css("float")!=c&&d.css("float",c),"left"==d.css("float")){return"left"}if("right"==d.css("float")){return"right"}}}return"center"}function bM(d){"undefined"==typeof d&&(d=bJ());var c=d.css("float");return d.css("float","none"),"block"==d.css("display")?(d.css("float",""),d.css("float")!=c&&d.css("float",c),"block"):(d.css("float",""),d.css("float")!=c&&d.css("float",c),"inline")}function bE(c){al&&c.find("> *:first").replaceWith(aU.icon.create("image-align-"+af()))}function bu(d,c){al&&c.find('.fr-command[data-param1="'+af()+'"]').addClass("fr-active").attr("aria-selected",!0)}function aV(d){var e=bJ();e.removeClass("fr-dii fr-dib"),!aU.opts.htmlUntouched&&aU.opts.useClasses?"inline"==d?e.addClass("fr-dii"):"block"==d&&e.addClass("fr-dib"):aR(e,d,af()),a(),aH(),aP(),aU.selection.clear()}function ao(d,c){al&&c.find('.fr-command[data-param1="'+bM()+'"]').addClass("fr-active").attr("aria-selected",!0)}function ah(){var f=aU.popups.get("image.insert");f||(f=bc()),aU.popups.isVisible("image.insert")||(ax(),aU.popups.refresh("image.insert"),aU.popups.setContainer("image.insert",aU.$sc));var i=bJ();bi()&&(i=i.find(".fr-img-wrap"));var h=i.offset().left+i.outerWidth()/2,g=i.offset().top+i.outerHeight();aU.popups.show("image.insert",h,g,i.outerHeight(!0))}function a(){if(al){aU.events.disableBlur(),aU.selection.clear();var d=aU.doc.createRange();d.selectNode(al.get(0));var e=aU.selection.get();e.addRange(d),aU.events.enableBlur()}}function bG(){al?(aU.events.disableBlur(),b(".fr-popup input:focus").blur(),at(al)):(aU.events.disableBlur(),aU.selection.restore(),aU.events.enableBlur(),aU.popups.hide("image.insert"),aU.toolbar.showInline())}function bw(){return al}function bJ(){return bi()?al.parents(".fr-img-caption:first"):al}function bA(g,k,j){if("undefined"==typeof k&&(k=aU.opts.imageStyles),"undefined"==typeof j&&(j=aU.opts.imageMultipleStyles),!al){return !1}var i=bJ();if(!j){var h=Object.keys(k);h.splice(h.indexOf(g),1),i.removeClass(h.join(" "))}"object"==typeof k[g]?(i.removeAttr("style"),i.css(k[g].style)):i.toggleClass(g),at(al)}function bi(){return al?al.parents(".fr-img-caption").length>0:!1}function aL(){var d;al&&!bi()?(d=al,al.parent().is("a")&&(d=al.parent()),d.wrap("<span "+(aU.browser.mozilla?"":'contenteditable="false"')+'class="fr-img-caption '+al.attr("class")+'" style="'+(al.attr("style")?al.attr("style")+" ":"")+"width: "+al.width()+'px;" draggable="false"></span>'),d.wrap('<span class="fr-img-wrap"></span>'),d.after('<span class="fr-inner" contenteditable="true">'+b.FE.START_MARKER+"Image caption"+b.FE.END_MARKER+"</span>"),al.removeAttr("class").removeAttr("style").removeAttr("width"),ad(!0),aU.selection.restore()):(d=bJ(),al.insertAfter(d),al.attr("class",d.attr("class").replace("fr-img-caption","")).attr("style",d.attr("style")),d.remove(),at(al))}var al,ae,bL,bC,bp=!1,aS=1,an=2,ag=3,bN=4,bF=5,bv=6,aX=7,ap=8,ai={};ai[aS]="Image cannot be loaded from the passed link.",ai[an]="No link in upload response.",ai[ag]="Error during file upload.",ai[bN]="Parsing response failed.",ai[bF]="File is too large.",ai[bv]="Image file type is invalid.",ai[aX]="Files can be uploaded only to same domain in IE 8 and IE 9.",ai[ap]="Image file is corrupted.";var ab,bH,bx=!1;return{_init:aE,showInsertPopup:aQ,showLayer:a1,refreshUploadButton:a0,refreshByURLButton:aZ,upload:bj,insertByURL:au,align:am,refreshAlign:bE,refreshAlignOnShow:bu,display:aV,refreshDisplayOnShow:ao,replace:ah,back:bG,get:bw,getEl:bJ,insert:aq,showProgressBar:ay,remove:aW,hideProgressBar:ax,applyStyle:bA,showAltPopup:a8,showSizePopup:a4,setAlt:a6,setSize:a2,toggleCaption:aL,hasCaption:bi,exitEdit:ad,edit:at}},b.FE.DefineIcon("insertImage",{NAME:"image"}),b.FE.RegisterShortcut(b.FE.KEYCODE.P,"insertImage",null,"P"),b.FE.RegisterCommand("insertImage",{title:"Insert Image",undo:!1,focus:!0,refreshAfterCallback:!1,popup:!0,callback:function(){this.popups.isVisible("image.insert")?(this.$el.find(".fr-marker").length&&(this.events.disableBlur(),this.selection.restore()),this.popups.hide("image.insert")):this.image.showInsertPopup()},plugin:"image"}),b.FE.DefineIcon("imageUpload",{NAME:"upload"}),b.FE.RegisterCommand("imageUpload",{title:"Upload Image",undo:!1,focus:!1,toggle:!0,callback:function(){this.image.showLayer("image-upload")},refresh:function(c){this.image.refreshUploadButton(c)}}),b.FE.DefineIcon("imageByURL",{NAME:"link"}),b.FE.RegisterCommand("imageByURL",{title:"By URL",undo:!1,focus:!1,toggle:!0,callback:function(){this.image.showLayer("image-by-url")},refresh:function(c){this.image.refreshByURLButton(c)}}),b.FE.RegisterCommand("imageInsertByURL",{title:"Insert Image",undo:!0,refreshAfterCallback:!1,callback:function(){this.image.insertByURL()},refresh:function(d){var c=this.image.get();c?d.text(this.language.translate("Replace")):d.text(this.language.translate("Insert"))}}),b.FE.DefineIcon("imageDisplay",{NAME:"star"}),b.FE.RegisterCommand("imageDisplay",{title:"Display",type:"dropdown",options:{inline:"Inline",block:"Break Text"},callback:function(d,c){this.image.display(c)},refresh:function(c){this.opts.imageTextNear||c.addClass("fr-hidden")},refreshOnShow:function(d,c){this.image.refreshDisplayOnShow(d,c)}}),b.FE.DefineIcon("image-align",{NAME:"align-left"}),b.FE.DefineIcon("image-align-left",{NAME:"align-left"}),b.FE.DefineIcon("image-align-right",{NAME:"align-right"}),b.FE.DefineIcon("image-align-center",{NAME:"align-justify"}),b.FE.DefineIcon("imageAlign",{NAME:"align-justify"}),b.FE.RegisterCommand("imageAlign",{type:"dropdown",title:"Align",options:{left:"Align Left",center:"None",right:"Align Right"},html:function(){var a='<ul class="fr-dropdown-list" role="presentation">',f=b.FE.COMMANDS.imageAlign.options;for(var e in f){f.hasOwnProperty(e)&&(a+='<li role="presentation"><a class="fr-command fr-title" tabIndex="-1" role="option" data-cmd="imageAlign" data-param1="'+e+'" title="'+this.language.translate(f[e])+'">'+this.icon.create("image-align-"+e)+'<span class="fr-sr-only">'+this.language.translate(f[e])+"</span></a></li>")}return a+="</ul>"},callback:function(d,c){this.image.align(c)},refresh:function(c){this.image.refreshAlign(c)},refreshOnShow:function(d,c){this.image.refreshAlignOnShow(d,c)}}),b.FE.DefineIcon("imageReplace",{NAME:"exchange",FA5NAME:"exchange-alt"}),b.FE.RegisterCommand("imageReplace",{title:"Replace",undo:!1,focus:!1,popup:!0,refreshAfterCallback:!1,callback:function(){this.image.replace()}}),b.FE.DefineIcon("imageRemove",{NAME:"trash"}),b.FE.RegisterCommand("imageRemove",{title:"Remove",callback:function(){this.image.remove()}}),b.FE.DefineIcon("imageBack",{NAME:"arrow-left"}),b.FE.RegisterCommand("imageBack",{title:"Back",undo:!1,focus:!1,back:!0,callback:function(){this.image.back()},refresh:function(d){var c=this.image.get();c||this.opts.toolbarInline?(d.removeClass("fr-hidden"),d.next(".fr-separator").removeClass("fr-hidden")):(d.addClass("fr-hidden"),d.next(".fr-separator").addClass("fr-hidden"))}}),b.FE.RegisterCommand("imageDismissError",{title:"OK",undo:!1,callback:function(){this.image.hideProgressBar(!0)}}),b.FE.DefineIcon("imageStyle",{NAME:"magic"}),b.FE.RegisterCommand("imageStyle",{title:"Style",type:"dropdown",html:function(){var f='<ul class="fr-dropdown-list" role="presentation">',e=this.opts.imageStyles;for(var h in e){if(e.hasOwnProperty(h)){var g=e[h];"object"==typeof g&&(g=g.title),f+='<li role="presentation"><a class="fr-command" tabIndex="-1" role="option" data-cmd="imageStyle" data-param1="'+h+'">'+this.language.translate(g)+"</a></li>"}}return f+="</ul>"},callback:function(d,c){this.image.applyStyle(c)},refreshOnShow:function(a,f){var e=this.image.getEl();e&&f.find(".fr-command").each(function(){var d=b(this).data("param1"),g=e.hasClass(d);b(this).toggleClass("fr-active",g).attr("aria-selected",g)})}}),b.FE.DefineIcon("imageAlt",{NAME:"info"}),b.FE.RegisterCommand("imageAlt",{undo:!1,focus:!1,popup:!0,title:"Alternate Text",callback:function(){this.image.showAltPopup()}}),b.FE.RegisterCommand("imageSetAlt",{undo:!0,focus:!1,title:"Update",refreshAfterCallback:!1,callback:function(){this.image.setAlt()}}),b.FE.DefineIcon("imageSize",{NAME:"arrows-alt"}),b.FE.RegisterCommand("imageSize",{undo:!1,focus:!1,popup:!0,title:"Change Size",callback:function(){this.image.showSizePopup()}}),b.FE.RegisterCommand("imageSetSize",{undo:!0,focus:!1,title:"Update",refreshAfterCallback:!1,callback:function(){this.image.setSize()}}),b.FE.DefineIcon("imageCaption",{NAME:"commenting",FA5NAME:"comment-alt"}),b.FE.RegisterCommand("imageCaption",{undo:!0,focus:!1,title:"Image Caption",refreshAfterCallback:!0,callback:function(){this.image.toggleCaption()},refresh:function(c){this.image.get()&&c.toggleClass("fr-active",this.image.hasCaption())}})});