/*!
 * froala_editor v2.7.6 (https://www.froala.com/wysiwyg-editor)
 * License https://froala.com/wysiwyg-editor/terms/
 * Copyright 2014-2018 Froala Labs
 */
;!function(b){"function"==typeof define&&define.amd?define(["jquery"],b):"object"==typeof module&&module.exports?module.exports=function(a,d){return void 0===d&&(d="undefined"!=typeof window?require("jquery"):require("jquery")(a)),b(d)}:b(window.jQuery)}(function(b){b.extend(b.FE.POPUP_TEMPLATES,{"video.insert":"[_BUTTONS_][_BY_URL_LAYER_][_EMBED_LAYER_][_UPLOAD_LAYER_][_PROGRESS_BAR_]","video.edit":"[_BUTTONS_]","video.size":"[_BUTTONS_][_SIZE_LAYER_]"}),b.extend(b.FE.DEFAULTS,{videoAllowedTypes:["mp4","webm","ogg"],videoAllowedProviders:[".*"],videoDefaultAlign:"center",videoDefaultDisplay:"block",videoDefaultWidth:600,videoEditButtons:["videoReplace","videoRemove","|","videoDisplay","videoAlign","videoSize"],videoInsertButtons:["videoBack","|","videoByURL","videoEmbed","videoUpload"],videoMaxSize:52428800,videoMove:!0,videoResize:!0,videoSizeButtons:["videoBack","|"],videoSplitHTML:!1,videoTextNear:!0,videoUpload:!0,videoUploadMethod:"POST",videoUploadParam:"file",videoUploadParams:{},videoUploadToS3:!1,videoUploadURL:"https://i.froala.com/upload"}),b.FE.VIDEO_PROVIDERS=[{test_regex:/^.*((youtu.be)|(youtube.com))\/((v\/)|(\/u\/\w\/)|(embed\/)|(watch\?))?\??v?=?([^#\&\?]*).*/,url_regex:/(?:https?:\/\/)?(?:www\.)?(?:m\.)?(?:youtube\.com|youtu\.be)\/(?:watch\?v=|embed\/)?([0-9a-zA-Z_\-]+)(.+)?/g,url_text:"https://www.youtube.com/embed/$1",html:'<iframe width="640" height="360" src="{url}?wmode=opaque" frameborder="0" allowfullscreen></iframe>',provider:"youtube"},{test_regex:/^.*(?:vimeo.com)\/(?:channels(\/\w+\/)?|groups\/*\/videos\/\u200b\d+\/|video\/|)(\d+)(?:$|\/|\?)/,url_regex:/(?:https?:\/\/)?(?:www\.|player\.)?vimeo.com\/(?:channels\/(?:\w+\/)?|groups\/(?:[^\/]*)\/videos\/|album\/(?:\d+)\/video\/|video\/|)(\d+)(?:[a-zA-Z0-9_\-]+)?/i,url_text:"https://player.vimeo.com/video/$1",html:'<iframe width="640" height="360" src="{url}" frameborder="0" allowfullscreen></iframe>',provider:"vimeo"},{test_regex:/^.+(dailymotion.com|dai.ly)\/(video|hub)?\/?([^_]+)[^#]*(#video=([^_&]+))?/,url_regex:/(?:https?:\/\/)?(?:www\.)?(?:dailymotion\.com|dai\.ly)\/(?:video|hub)?\/?(.+)/g,url_text:"https://www.dailymotion.com/embed/video/$1",html:'<iframe width="640" height="360" src="{url}" frameborder="0" allowfullscreen></iframe>',provider:"dailymotion"},{test_regex:/^.+(screen.yahoo.com)\/[^_&]+/,url_regex:"",url_text:"",html:'<iframe width="640" height="360" src="{url}?format=embed" frameborder="0" allowfullscreen="true" mozallowfullscreen="true" webkitallowfullscreen="true" allowtransparency="true"></iframe>',provider:"yahoo"},{test_regex:/^.+(rutube.ru)\/[^_&]+/,url_regex:/(?:https?:\/\/)?(?:www\.)?(?:rutube\.ru)\/(?:video)?\/?(.+)/g,url_text:"https://rutube.ru/play/embed/$1",html:'<iframe width="640" height="360" src="{url}" frameborder="0" allowfullscreen="true" mozallowfullscreen="true" webkitallowfullscreen="true" allowtransparency="true"></iframe>',provider:"rutube"},{test_regex:/^(?:.+)vidyard.com\/(?:watch)?\/?([^.&\/]+)\/?(?:[^_.&]+)?/,url_regex:/^(?:.+)vidyard.com\/(?:watch)?\/?([^.&\/]+)\/?(?:[^_.&]+)?/g,url_text:"https://play.vidyard.com/$1",html:'<iframe width="640" height="360" src="{url}" frameborder="0" allowfullscreen></iframe>',provider:"vidyard"}],b.FE.VIDEO_EMBED_REGEX=/^\W*((<iframe.*><\/iframe>)|(<embed.*>))\W*$/i,b.FE.PLUGINS.video=function(aL){function aK(){var e=aL.popups.get("video.insert"),g=e.find(".fr-video-by-url-layer input");g.val("").trigger("change");var f=e.find(".fr-video-embed-layer textarea");f.val("").trigger("change"),f=e.find(".fr-video-upload-layer input"),f.val("").trigger("change")}function aI(){var f=aL.$tb.find('.fr-command[data-cmd="insertVideo"]'),i=aL.popups.get("video.insert");if(i||(i=aG()),av(),!i.hasClass("fr-active")){if(aL.popups.refresh("video.insert"),aL.popups.setContainer("video.insert",aL.$tb),f.is(":visible")){var h=f.offset().left+f.outerWidth()/2,g=f.offset().top+(aL.opts.toolbarBottom?10:f.outerHeight()-10);aL.popups.show("video.insert",h,g,f.outerHeight())}else{aL.position.forSelection(i),aL.popups.show("video.insert")}}}function aH(){var f=aL.popups.get("video.edit");if(f||(f=aU()),f){aL.popups.setContainer("video.edit",aL.$sc),aL.popups.refresh("video.edit");var i=bu.find("iframe, embed, video"),h=i.offset().left+i.outerWidth()/2,g=i.offset().top+i.outerHeight();aL.popups.show("video.edit",h,g,i.outerHeight())}}function aG(y){if(y){return aL.popups.onRefresh("video.insert",aK),aL.popups.onHide("image.insert",ab),!0}var x="";aL.opts.videoUpload||aL.opts.videoInsertButtons.splice(aL.opts.videoInsertButtons.indexOf("videoUpload"),1),aL.opts.videoInsertButtons.length>1&&(x='<div class="fr-buttons">'+aL.button.buildList(aL.opts.videoInsertButtons)+"</div>");var w,v="",u=aL.opts.videoInsertButtons.indexOf("videoUpload"),t=aL.opts.videoInsertButtons.indexOf("videoByURL"),s=aL.opts.videoInsertButtons.indexOf("videoEmbed");t>=0&&(w=" fr-active",(t>u&&u>=0||t>s&&s>=0)&&(w=""),v='<div class="fr-video-by-url-layer fr-layer'+w+'" id="fr-video-by-url-layer-'+aL.id+'"><div class="fr-input-line"><input id="fr-video-by-url-layer-text-'+aL.id+'" type="text" placeholder="'+aL.language.translate("Paste in a video URL")+'" tabIndex="1" aria-required="true"></div><div class="fr-action-buttons"><button type="button" class="fr-command fr-submit" data-cmd="videoInsertByURL" tabIndex="2" role="button">'+aL.language.translate("Insert")+"</button></div></div>");var r="";s>=0&&(w=" fr-active",(s>u&&u>=0||s>t&&t>=0)&&(w=""),r='<div class="fr-video-embed-layer fr-layer'+w+'" id="fr-video-embed-layer-'+aL.id+'"><div class="fr-input-line"><textarea id="fr-video-embed-layer-text'+aL.id+'" type="text" placeholder="'+aL.language.translate("Embedded Code")+'" tabIndex="1" aria-required="true" rows="5"></textarea></div><div class="fr-action-buttons"><button type="button" class="fr-command fr-submit" data-cmd="videoInsertEmbed" tabIndex="2" role="button">'+aL.language.translate("Insert")+"</button></div></div>");var q="";u>=0&&(w=" fr-active",(u>s&&s>=0||u>t&&t>=0)&&(w=""),q='<div class="fr-video-upload-layer fr-layer'+w+'" id="fr-video-upload-layer-'+aL.id+'"><strong>'+aL.language.translate("Drop video")+"</strong><br>("+aL.language.translate("or click")+')<div class="fr-form"><input type="file" accept="video/'+aL.opts.videoAllowedTypes.join(", video/").toLowerCase()+'" tabIndex="-1" aria-labelledby="fr-video-upload-layer-'+aL.id+'" role="button"></div></div>');var p='<div class="fr-video-progress-bar-layer fr-layer"><h3 tabIndex="-1" class="fr-message">Uploading</h3><div class="fr-loader"><span class="fr-progress"></span></div><div class="fr-action-buttons"><button type="button" class="fr-command fr-dismiss" data-cmd="videoDismissError" tabIndex="2" role="button">OK</button></div></div>',o={buttons:x,by_url_layer:v,embed_layer:r,upload_layer:q,progress_bar:p},c=aL.popups.create("video.insert",o);return aX(c),c}function aF(g){var k,j,i=aL.popups.get("video.insert");if(!bu&&!aL.opts.toolbarInline){var h=aL.$tb.find('.fr-command[data-cmd="insertVideo"]');k=h.offset().left+h.outerWidth()/2,j=h.offset().top+(aL.opts.toolbarBottom?10:h.outerHeight()-10)}aL.opts.toolbarInline&&(j=i.offset().top-aL.helpers.getPX(i.css("margin-top")),i.hasClass("fr-above")&&(j+=i.outerHeight())),i.find(".fr-layer").removeClass("fr-active"),i.find(".fr-"+g+"-layer").addClass("fr-active"),aL.popups.show("video.insert",k,j,0),aL.accessibility.focusPopup(i)}function aE(d){var e=aL.popups.get("video.insert");e.find(".fr-video-by-url-layer").hasClass("fr-active")&&d.addClass("fr-active").attr("aria-pressed",!0)}function aC(d){var e=aL.popups.get("video.insert");e.find(".fr-video-embed-layer").hasClass("fr-active")&&d.addClass("fr-active").attr("aria-pressed",!0)}function aB(d){var e=aL.popups.get("video.insert");e.find(".fr-video-upload-layer").hasClass("fr-active")&&d.addClass("fr-active").attr("aria-pressed",!0)}function aA(e){aL.events.focus(!0),aL.selection.restore();var g=!1;bu&&(af(),g=!0),aL.html.insert('<span contenteditable="false" draggable="true" class="fr-jiv fr-video">'+e+"</span>",!1,aL.opts.videoSplitHTML),aL.popups.hide("video.insert");var f=aL.$el.find(".fr-jiv");f.removeClass("fr-jiv"),br(f,aL.opts.videoDefaultDisplay,aL.opts.videoDefaultAlign),f.toggleClass("fr-draggable",aL.opts.videoMove),aL.events.trigger(g?"video.replaced":"video.inserted",[f])}function az(){var d=b(this);aL.popups.hide("video.insert"),d.removeClass("fr-uploading"),d.parent().next().is("br")&&d.parent().next().remove(),ap(d.parent()),aL.events.trigger("video.loaded",[d.parent()])}function ay(h,m,l,k,j){aL.edit.off(),au("Loading video"),m&&(h=aL.helpers.sanitizeURL(h));var i=function(){var q,p;if(k){aL.undo.canDo()||k.find("video").hasClass("fr-uploading")||aL.undo.saveStep();var o=k.find("video").data("fr-old-src"),n=k.data("fr-replaced");k.data("fr-replaced",!1),aL.$wp?(q=k.clone(),q.find("video").removeData("fr-old-src").removeClass("fr-uploading"),q.find("video").off("canplay"),o&&k.find("video").attr("src",o),k.replaceWith(q)):q=k;for(var f=q.find("video").get(0).attributes,e=0;e<f.length;e++){var d=f[e];0===d.nodeName.indexOf("data-")&&q.find("video").removeAttr(d.nodeName)}if("undefined"!=typeof l){for(p in l){l.hasOwnProperty(p)&&"link"!=p&&q.find("video").attr("data-"+p,l[p])}}q.find("video").on("canplay",az),q.find("video").attr("src",h),aL.edit.on(),a8(),aL.undo.saveStep(),aL.$el.blur(),aL.events.trigger(n?"video.replaced":"video.inserted",[q,j])}else{q=bh(h,l,az),a8(),aL.undo.saveStep(),aL.events.trigger("video.inserted",[q,j])}};aw("Loading video"),i()}function aw(f){var k=aL.popups.get("video.insert");if(k||(k=aG()),k.find(".fr-layer.fr-active").removeClass("fr-active").addClass("fr-pactive"),k.find(".fr-video-progress-bar-layer").addClass("fr-active"),k.find(".fr-buttons").hide(),bu){var j=bu.find("video");aL.popups.setContainer("video.insert",aL.$sc);var i=j.offset().left+j.width()/2,h=j.offset().top+j.height();aL.popups.show("video.insert",i,h,j.outerHeight())}"undefined"==typeof f&&au(aL.language.translate("Uploading"),0)}function av(e){var g=aL.popups.get("video.insert");if(g&&(g.find(".fr-layer.fr-pactive").addClass("fr-active").removeClass("fr-pactive"),g.find(".fr-video-progress-bar-layer").removeClass("fr-active"),g.find(".fr-buttons").show(),e||aL.$el.find("video.fr-error").length)){if(aL.events.focus(),aL.$el.find("video.fr-error").length&&(aL.$el.find("video.fr-error").parent().remove(),aL.undo.saveStep(),aL.undo.run(),aL.undo.dropRedo()),!aL.$wp&&bu){var f=bu;a4(!0),aL.selection.setAfter(f.find("video").get(0)),aL.selection.restore()}aL.popups.hide("video.insert")}}function au(f,i){var h=aL.popups.get("video.insert");if(h){var g=h.find(".fr-video-progress-bar-layer");g.find("h3").text(f+(i?" "+i+"%":"")),g.removeClass("fr-error"),i?(g.find("div").removeClass("fr-indeterminate"),g.find("div > span").css("width",i+"%")):g.find("div").addClass("fr-indeterminate")}}function at(f){aw();var i=aL.popups.get("video.insert"),h=i.find(".fr-video-progress-bar-layer");h.addClass("fr-error");var g=h.find("h3");g.text(f),aL.events.disableBlur(),g.focus()}function ar(l){if("undefined"==typeof l){var k=aL.popups.get("video.insert");l=(k.find('.fr-video-by-url-layer input[type="text"]').val()||"").trim()}var j=null;if(/^http/.test(l)||(l="https://"+l),aL.helpers.isURL(l)){for(var i=0;i<b.FE.VIDEO_PROVIDERS.length;i++){var h=b.FE.VIDEO_PROVIDERS[i];if(h.test_regex.test(l)&&new RegExp(aL.opts.videoAllowedProviders.join("|")).test(h.provider)){j=l.replace(h.url_regex,h.url_text),j=h.html.replace(/\{url\}/,j);break}}}j?aA(j):aL.events.trigger("video.linkError",[l])}function aq(f){if("undefined"==typeof f){var e=aL.popups.get("video.insert");f=e.find(".fr-video-embed-layer textarea").val()||""}0!==f.length&&b.FE.VIDEO_EMBED_REGEX.test(f)?aA(f):aL.events.trigger("video.codeError",[f])}function ap(c){a5.call(c.get(0))}function ao(e){try{if(aL.events.trigger("video.uploaded",[e],!0)===!1){return aL.edit.on(),!1}var g=JSON.parse(e);return g.link?g:(aV(bi,e),!1)}catch(f){return aV(ai,e),!1}}function an(j){try{var i=b(j).find("Location").text(),h=b(j).find("Key").text();return aL.events.trigger("video.uploadedToS3",[i,h,j],!0)===!1?(aL.edit.on(),!1):i}catch(g){return aV(ai,j),!1}}function am(j){au("Loading video");var q=this.status,p=this.response,o=this.responseXML,n=this.responseText;try{if(aL.opts.videoUploadToS3){if(201==q){var m=an(o);m&&ay(m,!1,[],j,p||o)}else{aV(ai,p||o)}}else{if(q>=200&&300>q){var l=ao(n);l&&ay(l.link,!1,l,j,p||n)}else{aV(aM,p||n)}}}catch(k){aV(ai,p||n)}}function al(){aV(ai,this.response||this.responseText||this.responseXML)}function ak(d){if(d.lengthComputable){var e=d.loaded/d.total*100|0;au(aL.language.translate("Uploading"),e)}}function aj(){aL.edit.on(),av(!0)}function bh(r,q,p){var o,n="";if(q&&"undefined"!=typeof q){for(o in q){q.hasOwnProperty(o)&&"link"!=o&&(n+=" data-"+o+'="'+q[o]+'"')}}var m=aL.opts.videoDefaultWidth;m&&"auto"!=m&&(m+="px");var l=b('<span contenteditable="false" draggable="true" class="fr-video fr-dv'+aL.opts.videoDefaultDisplay[0]+("center"!=aL.opts.videoDefaultAlign?" fr-fv"+aL.opts.videoDefaultAlign[0]:"")+'"><video src="'+r+'" '+n+(m?' style="width: '+m+';" ':"")+" controls>"+aL.language.translate("Your browser does not support HTML5 video.")+"</video></span>");l.toggleClass("fr-draggable",aL.opts.videoMove),aL.edit.on(),aL.events.focus(!0),aL.selection.restore(),aL.undo.saveStep(),aL.opts.videoSplitHTML?aL.markers.split():aL.markers.insert(),aL.html.wrap();var k=aL.$el.find(".fr-marker");return aL.node.isLastSibling(k)&&k.parent().hasClass("fr-deletable")&&k.insertAfter(k.parent()),k.replaceWith(l),aL.selection.clear(),l.find("video").get(0).readyState>l.find("video").get(0).HAVE_FUTURE_DATA||aL.helpers.isIOS()?p.call(l.find("video").get(0)):l.find("video").on("canplaythrough load",p),l}function bg(r){if(!aL.core.sameInstance(ad)){return !0}r.preventDefault(),r.stopPropagation();var q=r.pageX||(r.originalEvent.touches?r.originalEvent.touches[0].pageX:null),p=r.pageY||(r.originalEvent.touches?r.originalEvent.touches[0].pageY:null);if(!q||!p){return !1}if("mousedown"==r.type){var o=aL.$oel.get(0),n=o.ownerDocument,m=n.defaultView||n.parentWindow,l=!1;try{l=m.location!=m.parent.location&&!(m.$&&m.$.FE)}catch(k){}l&&m.frameElement&&(q+=aL.helpers.getPX(b(m.frameElement).offset().left)+m.frameElement.clientLeft,p=r.clientY+aL.helpers.getPX(b(m.frameElement).offset().top)+m.frameElement.clientTop)}aL.undo.canDo()||aL.undo.saveStep(),ah=b(this),ah.data("start-x",q),ah.data("start-y",p),aJ.show(),aL.popups.hideAll(),a2()}function bf(u){if(!aL.core.sameInstance(ad)){return !0}if(ah){u.preventDefault();var t=u.pageX||(u.originalEvent.touches?u.originalEvent.touches[0].pageX:null),s=u.pageY||(u.originalEvent.touches?u.originalEvent.touches[0].pageY:null);if(!t||!s){return !1}var r=ah.data("start-x"),q=ah.data("start-y");ah.data("start-x",t),ah.data("start-y",s);var p=t-r,o=s-q,n=bu.find("iframe, embed, video"),m=n.width(),l=n.height();(ah.hasClass("fr-hnw")||ah.hasClass("fr-hsw"))&&(p=0-p),(ah.hasClass("fr-hnw")||ah.hasClass("fr-hne"))&&(o=0-o),n.css("width",m+p),n.css("height",l+o),n.removeAttr("width"),n.removeAttr("height"),a7()}}function be(c){return aL.core.sameInstance(ad)?void (ah&&bu&&(c&&c.stopPropagation(),ah=null,aJ.hide(),a7(),aH(),aL.undo.saveStep())):!0}function bc(c){return'<div class="fr-handler fr-h'+c+'"></div>'}function bb(f,e,h,g){return f.pageX=e,f.pageY=e,bg.call(this,f),f.pageX=f.pageX+h*Math.floor(Math.pow(1.1,g)),f.pageY=f.pageY+h*Math.floor(Math.pow(1.1,g)),bf.call(this,f),be.call(this,f),++g}function a9(){var j;if(aL.shared.$video_resizer?(ad=aL.shared.$video_resizer,aJ=aL.shared.$vid_overlay,aL.events.on("destroy",function(){ad.removeClass("fr-active").appendTo(b("body:first"))},!0)):(aL.shared.$video_resizer=b('<div class="fr-video-resizer"></div>'),ad=aL.shared.$video_resizer,aL.events.$on(ad,"mousedown",function(c){c.stopPropagation()},!0),aL.opts.videoResize&&(ad.append(bc("nw")+bc("ne")+bc("sw")+bc("se")),aL.shared.$vid_overlay=b('<div class="fr-video-overlay"></div>'),aJ=aL.shared.$vid_overlay,j=ad.get(0).ownerDocument,b(j).find("body:first").append(aJ))),aL.events.on("shared.destroy",function(){ad.html("").removeData().remove(),ad=null,aL.opts.videoResize&&(aJ.remove(),aJ=null)},!0),aL.helpers.isMobile()||aL.events.$on(b(aL.o_win),"resize.video",function(){a4(!0)}),aL.opts.videoResize){j=ad.get(0).ownerDocument,aL.events.$on(ad,aL._mousedown,".fr-handler",bg),aL.events.$on(b(j),aL._mousemove,bf),aL.events.$on(b(j.defaultView||j.parentWindow),aL._mouseup,be),aL.events.$on(aJ,"mouseleave",be);var i=1,h=null,g=0;aL.events.on("keydown",function(f){if(bu){var e=-1!=navigator.userAgent.indexOf("Mac OS X")?f.metaKey:f.ctrlKey,d=f.which;(d!==h||f.timeStamp-g>200)&&(i=1),(d==b.FE.KEYCODE.EQUALS||aL.browser.mozilla&&d==b.FE.KEYCODE.FF_EQUALS)&&e&&!f.altKey?i=bb.call(this,f,1,1,i):(d==b.FE.KEYCODE.HYPHEN||aL.browser.mozilla&&d==b.FE.KEYCODE.FF_HYPHEN)&&e&&!f.altKey&&(i=bb.call(this,f,2,-1,i)),h=d,g=f.timeStamp}}),aL.events.on("keyup",function(){i=1})}}function a8(){var h,g=Array.prototype.slice.call(aL.el.querySelectorAll("video, .fr-video > *")),f=[];for(h=0;h<g.length;h++){f.push(g[h].getAttribute("src")),b(g[h]).toggleClass("fr-draggable",aL.opts.videoMove),""===g[h].getAttribute("class")&&g[h].removeAttribute("class"),""===g[h].getAttribute("style")&&g[h].removeAttribute("style")}if(bs){for(h=0;h<bs.length;h++){f.indexOf(bs[h].getAttribute("src"))<0&&aL.events.trigger("video.removed",[b(bs[h])])}}bs=g}function a7(){ad||a9(),(aL.$wp||aL.$sc).append(ad),ad.data("instance",aL);var c=bu.find("iframe, embed, video");ad.css("top",(aL.opts.iframe?c.offset().top-1:c.offset().top-aL.$wp.offset().top-1)+aL.$wp.scrollTop()).css("left",(aL.opts.iframe?c.offset().left-1:c.offset().left-aL.$wp.offset().left-1)+aL.$wp.scrollLeft()).css("width",c.get(0).getBoundingClientRect().width).css("height",c.get(0).getBoundingClientRect().height).addClass("fr-active")}function a5(f){if(f&&"touchend"==f.type&&bm){return !0}if(f&&aL.edit.isDisabled()){return f.stopPropagation(),f.preventDefault(),!1}if(aL.edit.isDisabled()){return !1}for(var e=0;e<b.FE.INSTANCES.length;e++){b.FE.INSTANCES[e]!=aL&&b.FE.INSTANCES[e].events.trigger("video.hideResizer")}aL.toolbar.disable(),aL.helpers.isMobile()&&(aL.events.disableBlur(),aL.$el.blur(),aL.events.enableBlur()),aL.$el.find(".fr-video.fr-active").removeClass("fr-active"),bu=b(this),bu.addClass("fr-active"),aL.opts.iframe&&aL.size.syncIframe(),ac(),a7(),aH(),aL.selection.clear(),aL.button.bulkRefresh(),aL.events.trigger("image.hideResizer")}function a4(c){bu&&(a1()||c===!0)&&(ad.removeClass("fr-active"),aL.toolbar.enable(),bu.removeClass("fr-active"),bu=null,a2())}function a3(){aL.shared.vid_exit_flag=!0}function a2(){aL.shared.vid_exit_flag=!1}function a1(){return aL.shared.vid_exit_flag}function a0(j){var i=j.originalEvent.dataTransfer;if(i&&i.files&&i.files.length){var h=i.files[0];if(h&&h.type&&-1!==h.type.indexOf("video")){if(!aL.opts.videoUpload){return j.preventDefault(),j.stopPropagation(),!1}aL.markers.remove(),aL.markers.insertAtPoint(j.originalEvent),aL.$el.find(".fr-marker").replaceWith(b.FE.MARKERS),aL.popups.hideAll();var f=aL.popups.get("video.insert");return f||(f=aG()),aL.popups.setContainer("video.insert",aL.$sc),aL.popups.show("video.insert",j.originalEvent.pageX,j.originalEvent.pageY),aw(),aL.opts.videoAllowedTypes.indexOf(h.type.replace(/video\//g,""))>=0?aY(i.files):aV(a),j.preventDefault(),j.stopPropagation(),!1}}}function aY(i){if("undefined"!=typeof i&&i.length>0){if(aL.events.trigger("video.beforeUpload",[i])===!1){return !1}var o=i[0];if(o.size>aL.opts.videoMaxSize){return aV(ae),!1}if(aL.opts.videoAllowedTypes.indexOf(o.type.replace(/video\//g,""))<0){return aV(a),!1}var n;if(aL.drag_support.formdata&&(n=aL.drag_support.formdata?new FormData:null),n){var m;if(aL.opts.videoUploadToS3!==!1){n.append("key",aL.opts.videoUploadToS3.keyStart+(new Date).getTime()+"-"+(o.name||"untitled")),n.append("success_action_status","201"),n.append("X-Requested-With","xhr"),n.append("Content-Type",o.type);for(m in aL.opts.videoUploadToS3.params){aL.opts.videoUploadToS3.params.hasOwnProperty(m)&&n.append(m,aL.opts.videoUploadToS3.params[m])}}for(m in aL.opts.videoUploadParams){aL.opts.videoUploadParams.hasOwnProperty(m)&&n.append(m,aL.opts.videoUploadParams[m])}n.append(aL.opts.videoUploadParam,o);var l=aL.opts.videoUploadURL;aL.opts.videoUploadToS3&&(l=aL.opts.videoUploadToS3.uploadURL?aL.opts.videoUploadToS3.uploadURL:"https://"+aL.opts.videoUploadToS3.region+".amazonaws.com/"+aL.opts.videoUploadToS3.bucket);var k=aL.core.getXHR(l,aL.opts.videoUploadMethod);k.onload=function(){am.call(k,bu)},k.onerror=al,k.upload.onprogress=ak,k.onabort=aj,aw(),aL.events.disableBlur(),aL.edit.off(),aL.events.enableBlur();var j=aL.popups.get("video.insert");j&&j.off("abortUpload").on("abortUpload",function(){4!=k.readyState&&k.abort()}),k.send(n)}}}function aX(d){aL.events.$on(d,"dragover dragenter",".fr-video-upload-layer",function(){return b(this).addClass("fr-drop"),!1},!0),aL.events.$on(d,"dragleave dragend",".fr-video-upload-layer",function(){return b(this).removeClass("fr-drop"),!1},!0),aL.events.$on(d,"drop",".fr-video-upload-layer",function(h){h.preventDefault(),h.stopPropagation(),b(this).removeClass("fr-drop");var g=h.originalEvent.dataTransfer;if(g&&g.files){var c=d.data("instance")||aL;c.events.disableBlur(),c.video.upload(g.files),c.events.enableBlur()}},!0),aL.helpers.isIOS()&&aL.events.$on(d,"touchstart",'.fr-video-upload-layer input[type="file"]',function(){b(this).trigger("click")},!0),aL.events.$on(d,"change",'.fr-video-upload-layer input[type="file"]',function(){if(this.files){var c=d.data("instance")||aL;c.events.disableBlur(),d.find("input:focus").blur(),c.events.enableBlur(),c.video.upload(this.files)}b(this).val("")},!0)}function aW(){aL.events.on("drop",a0,!0),aL.events.on("mousedown window.mousedown",a3),aL.events.on("window.touchmove",a2),aL.events.on("mouseup window.mouseup",a4),aL.events.on("commands.mousedown",function(c){c.parents(".fr-toolbar").length>0&&a4()}),aL.events.on("video.hideResizer commands.undo commands.redo element.dropped",function(){a4(!0)})}function aV(d,e){aL.edit.on(),bu&&bu.find("video").addClass("fr-error"),at(aL.language.translate("Something went wrong. Please try again.")),aL.events.trigger("video.error",[{code:d,message:bj[d]},e])}function aU(){var e="";if(aL.opts.videoEditButtons.length>0){e+='<div class="fr-buttons">',e+=aL.button.buildList(aL.opts.videoEditButtons),e+="</div>";var g={buttons:e},f=aL.popups.create("video.edit",g);return aL.events.$on(aL.$wp,"scroll.video-edit",function(){bu&&aL.popups.isVisible("video.edit")&&(aL.events.disableBlur(),ap(bu))}),f}return !1}function aT(){if(bu){var d=aL.popups.get("video.size"),e=bu.find("iframe, embed, video");d.find('input[name="width"]').val(e.get(0).style.width||e.attr("width")).trigger("change"),d.find('input[name="height"]').val(e.get(0).style.height||e.attr("height")).trigger("change")}}function aS(){var f=aL.popups.get("video.size");f||(f=aR()),av(),aL.popups.refresh("video.size"),aL.popups.setContainer("video.size",aL.$sc);var i=bu.find("iframe, embed, video"),h=i.offset().left+i.width()/2,g=i.offset().top+i.height();aL.popups.show("video.size",h,g,i.height())}function aR(g){if(g){return aL.popups.onRefresh("video.size",aT),!0}var k="";k='<div class="fr-buttons">'+aL.button.buildList(aL.opts.videoSizeButtons)+"</div>";var j="";j='<div class="fr-video-size-layer fr-layer fr-active" id="fr-video-size-layer-'+aL.id+'"><div class="fr-video-group"><div class="fr-input-line"><input id="fr-video-size-layer-width-'+aL.id+'" type="text" name="width" placeholder="'+aL.language.translate("Width")+'" tabIndex="1"></div><div class="fr-input-line"><input id="fr-video-size-layer-height-'+aL.id+'" type="text" name="height" placeholder="'+aL.language.translate("Height")+'" tabIndex="1"></div></div><div class="fr-action-buttons"><button type="button" class="fr-command fr-submit" data-cmd="videoSetSize" tabIndex="2" role="button">'+aL.language.translate("Update")+"</button></div></div>";var i={buttons:k,size_layer:j},h=aL.popups.create("video.size",i);return aL.events.$on(aL.$wp,"scroll",function(){bu&&aL.popups.isVisible("video.size")&&(aL.events.disableBlur(),ap(bu))}),h}function aQ(c){if("undefined"==typeof c&&(c=bu),c){if(c.hasClass("fr-fvl")){return"left"}if(c.hasClass("fr-fvr")){return"right"}if(c.hasClass("fr-dvb")||c.hasClass("fr-dvi")){return"center"}if("block"==c.css("display")){if("left"==c.css("text-algin")){return"left"}if("right"==c.css("text-align")){return"right"}}else{if("left"==c.css("float")){return"left"}if("right"==c.css("float")){return"right"}}}return"center"}function aP(c){bu.removeClass("fr-fvr fr-fvl"),!aL.opts.htmlUntouched&&aL.opts.useClasses?"left"==c?bu.addClass("fr-fvl"):"right"==c&&bu.addClass("fr-fvr"):br(bu,aN(),c),ac(),a7(),aH(),aL.selection.clear()}function aO(c){return bu?void c.find("> *:first").replaceWith(aL.icon.create("video-align-"+aQ())):!1}function bo(d,c){bu&&c.find('.fr-command[data-param1="'+aQ()+'"]').addClass("fr-active").attr("aria-selected",!0)}function aN(d){"undefined"==typeof d&&(d=bu);var c=d.css("float");return d.css("float","none"),"block"==d.css("display")?(d.css("float",""),d.css("float")!=c&&d.css("float",c),"block"):(d.css("float",""),d.css("float")!=c&&d.css("float",c),"inline")}function bk(c){bu.removeClass("fr-dvi fr-dvb"),!aL.opts.htmlUntouched&&aL.opts.useClasses?"inline"==c?bu.addClass("fr-dvi"):"block"==c&&bu.addClass("fr-dvb"):br(bu,c,aQ()),ac(),a7(),aH(),aL.selection.clear()}function aZ(d,c){bu&&c.find('.fr-command[data-param1="'+aN()+'"]').addClass("fr-active").attr("aria-selected",!0)}function ax(){var e=aL.popups.get("video.insert");e||(e=aG()),aL.popups.isVisible("video.insert")||(av(),aL.popups.refresh("video.insert"),aL.popups.setContainer("video.insert",aL.$sc));var g=bu.offset().left+bu.width()/2,f=bu.offset().top+bu.height();aL.popups.show("video.insert",g,f,bu.outerHeight())}function af(){if(bu&&aL.events.trigger("video.beforeRemove",[bu])!==!1){var c=bu;aL.popups.hideAll(),a4(!0),aL.selection.setBefore(c.get(0))||aL.selection.setAfter(c.get(0)),c.remove(),aL.selection.restore(),aL.html.fillEmptyBlocks(),aL.events.trigger("video.removed",[c])}}function ab(){av()}function br(e,g,f){!aL.opts.htmlUntouched&&aL.opts.useClasses?(e.removeClass("fr-fvl fr-fvr fr-dvb fr-dvi"),e.addClass("fr-fv"+f[0]+" fr-dv"+g[0])):"inline"==g?(e.css({display:"inline-block"}),"center"==f?e.css({"float":"none"}):"left"==f?e.css({"float":"left"}):e.css({"float":"right"})):(e.css({display:"block",clear:"both"}),"left"==f?e.css({textAlign:"left"}):"right"==f?e.css({textAlign:"right"}):e.css({textAlign:"center"}))}function bl(c){c.hasClass("fr-dvi")||c.hasClass("fr-dvb")||(c.addClass("fr-fv"+aQ(c)[0]),c.addClass("fr-dv"+aN(c)[0]))}function a6(e){var d=e.hasClass("fr-dvb")?"block":e.hasClass("fr-dvi")?"inline":null,f=e.hasClass("fr-fvl")?"left":e.hasClass("fr-fvr")?"right":aQ(e);br(e,d,f),e.removeClass("fr-dvb fr-dvi fr-fvr fr-fvl")}function aD(){aL.$el.find("video").filter(function(){return 0===b(this).parents("span.fr-video").length}).wrap('<span class="fr-video" contenteditable="false"></span>'),aL.$el.find("embed, iframe").filter(function(){if(aL.browser.safari&&this.getAttribute("src")&&this.setAttribute("src",this.src),b(this).parents("span.fr-video").length>0){return !1}for(var k=b(this).attr("src"),j=0;j<b.FE.VIDEO_PROVIDERS.length;j++){var i=b.FE.VIDEO_PROVIDERS[j];if(i.test_regex.test(k)&&new RegExp(aL.opts.videoAllowedProviders.join("|")).test(i.provider)){return !0}}return !1}).map(function(){return 0===b(this).parents("object").length?this:b(this).parents("object").get(0)}).wrap('<span class="fr-video" contenteditable="false"></span>');for(var h=aL.$el.find("span.fr-video, video"),g=0;g<h.length;g++){var f=b(h[g]);!aL.opts.htmlUntouched&&aL.opts.useClasses?(bl(f),aL.opts.videoTextNear||f.removeClass("fr-dvi").addClass("fr-dvb")):aL.opts.htmlUntouched||aL.opts.useClasses||a6(f)}h.toggleClass("fr-draggable",aL.opts.videoMove)}function ag(){aW(),aL.helpers.isMobile()&&(aL.events.$on(aL.$el,"touchstart","span.fr-video",function(){bm=!1}),aL.events.$on(aL.$el,"touchmove",function(){bm=!0})),aL.events.on("html.set",aD),aD(),aL.events.$on(aL.$el,"mousedown","span.fr-video",function(c){c.stopPropagation()}),aL.events.$on(aL.$el,"click touchend","span.fr-video",function(c){return"false"==b(this).parents("[contenteditable]:not(.fr-element):not(.fr-img-caption):not(body):first").attr("contenteditable")?!0:void a5.call(this,c)}),aL.events.on("keydown",function(f){var e=f.which;return !bu||e!=b.FE.KEYCODE.BACKSPACE&&e!=b.FE.KEYCODE.DELETE?bu&&e==b.FE.KEYCODE.ESC?(a4(!0),f.preventDefault(),!1):bu&&e!=b.FE.KEYCODE.F10&&!aL.keys.isBrowserAction(f)?(f.preventDefault(),!1):void 0:(f.preventDefault(),af(),aL.undo.saveStep(),!1)},!0),aL.events.on("toolbar.esc",function(){return bu?(aL.events.disableBlur(),aL.events.focus(),!1):void 0},!0),aL.events.on("toolbar.focusEditor",function(){return bu?!1:void 0},!0),aL.events.on("keydown",function(){aL.$el.find("span.fr-video:empty").remove()}),aL.$wp&&(a8(),aL.events.on("contentChanged",a8)),aG(!0),aR(!0)}function ac(){if(bu){aL.selection.clear();var d=aL.doc.createRange();d.selectNode(bu.get(0));var e=aL.selection.get();e.addRange(d)}}function bt(){bu?(aL.events.disableBlur(),bu.trigger("click")):(aL.events.disableBlur(),aL.selection.restore(),aL.events.enableBlur(),aL.popups.hide("video.insert"),aL.toolbar.showInline())}function bn(f,i){if(bu){var h=aL.popups.get("video.size"),g=bu.find("iframe, embed, video");g.css("width",f||h.find('input[name="width"]').val()),g.css("height",i||h.find('input[name="height"]').val()),g.get(0).style.width&&g.removeAttr("width"),g.get(0).style.height&&g.removeAttr("height"),h.find("input:focus").blur(),setTimeout(function(){bu.trigger("click")},aL.helpers.isAndroid()?50:0)}}function bd(){return bu}var aJ,ah,ad,bu,bp=1,bi=2,aM=3,ai=4,ae=5,a=6,bq=7,bj={};bj[bp]="Video cannot be loaded from the passed link.",bj[bi]="No link in upload response.",bj[aM]="Error during file upload.",bj[ai]="Parsing response failed.",bj[ae]="File is too large.",bj[a]="Video file type is invalid.",bj[bq]="Files can be uploaded only to same domain in IE 8 and IE 9.";var bs,bm;return aL.shared.vid_exit_flag=!1,{_init:ag,showInsertPopup:aI,showLayer:aF,refreshByURLButton:aE,refreshEmbedButton:aC,refreshUploadButton:aB,upload:aY,insertByURL:ar,insertEmbed:aq,insert:aA,align:aP,refreshAlign:aO,refreshAlignOnShow:bo,display:bk,refreshDisplayOnShow:aZ,remove:af,hideProgressBar:av,showSizePopup:aS,replace:ax,back:bt,setSize:bn,get:bd}},b.FE.RegisterCommand("insertVideo",{title:"Insert Video",undo:!1,focus:!0,refreshAfterCallback:!1,popup:!0,callback:function(){this.popups.isVisible("video.insert")?(this.$el.find(".fr-marker").length&&(this.events.disableBlur(),this.selection.restore()),this.popups.hide("video.insert")):this.video.showInsertPopup()},plugin:"video"}),b.FE.DefineIcon("insertVideo",{NAME:"video-camera",FA5NAME:"camera"}),b.FE.DefineIcon("videoByURL",{NAME:"link"}),b.FE.RegisterCommand("videoByURL",{title:"By URL",undo:!1,focus:!1,toggle:!0,callback:function(){this.video.showLayer("video-by-url")},refresh:function(c){this.video.refreshByURLButton(c)}}),b.FE.DefineIcon("videoEmbed",{NAME:"code"}),b.FE.RegisterCommand("videoEmbed",{title:"Embedded Code",undo:!1,focus:!1,toggle:!0,callback:function(){this.video.showLayer("video-embed")},refresh:function(c){this.video.refreshEmbedButton(c)}}),b.FE.DefineIcon("videoUpload",{NAME:"upload"}),b.FE.RegisterCommand("videoUpload",{title:"Upload Video",undo:!1,focus:!1,toggle:!0,callback:function(){this.video.showLayer("video-upload")},refresh:function(c){this.video.refreshUploadButton(c)}}),b.FE.RegisterCommand("videoInsertByURL",{undo:!0,focus:!0,callback:function(){this.video.insertByURL()}}),b.FE.RegisterCommand("videoInsertEmbed",{undo:!0,focus:!0,callback:function(){this.video.insertEmbed()}}),b.FE.DefineIcon("videoDisplay",{NAME:"star"}),b.FE.RegisterCommand("videoDisplay",{title:"Display",type:"dropdown",options:{inline:"Inline",block:"Break Text"},callback:function(d,c){this.video.display(c)},refresh:function(c){this.opts.videoTextNear||c.addClass("fr-hidden")},refreshOnShow:function(d,c){this.video.refreshDisplayOnShow(d,c)}}),b.FE.DefineIcon("video-align",{NAME:"align-left"}),b.FE.DefineIcon("video-align-left",{NAME:"align-left"}),b.FE.DefineIcon("video-align-right",{NAME:"align-right"}),b.FE.DefineIcon("video-align-center",{NAME:"align-justify"}),b.FE.DefineIcon("videoAlign",{NAME:"align-center"}),b.FE.RegisterCommand("videoAlign",{type:"dropdown",title:"Align",options:{left:"Align Left",center:"None",right:"Align Right"},html:function(){var a='<ul class="fr-dropdown-list" role="presentation">',f=b.FE.COMMANDS.videoAlign.options;for(var e in f){f.hasOwnProperty(e)&&(a+='<li role="presentation"><a class="fr-command fr-title" tabIndex="-1" role="option" data-cmd="videoAlign" data-param1="'+e+'" title="'+this.language.translate(f[e])+'">'+this.icon.create("video-align-"+e)+'<span class="fr-sr-only">'+this.language.translate(f[e])+"</span></a></li>")}return a+="</ul>"},callback:function(d,c){this.video.align(c)},refresh:function(c){this.video.refreshAlign(c)},refreshOnShow:function(d,c){this.video.refreshAlignOnShow(d,c)}}),b.FE.DefineIcon("videoReplace",{NAME:"exchange"}),b.FE.RegisterCommand("videoReplace",{title:"Replace",undo:!1,focus:!1,popup:!0,refreshAfterCallback:!1,callback:function(){this.video.replace()}}),b.FE.DefineIcon("videoRemove",{NAME:"trash"}),b.FE.RegisterCommand("videoRemove",{title:"Remove",callback:function(){this.video.remove()}}),b.FE.DefineIcon("videoSize",{NAME:"arrows-alt"}),b.FE.RegisterCommand("videoSize",{undo:!1,focus:!1,popup:!0,title:"Change Size",callback:function(){this.video.showSizePopup()}}),b.FE.DefineIcon("videoBack",{NAME:"arrow-left"}),b.FE.RegisterCommand("videoBack",{title:"Back",undo:!1,focus:!1,back:!0,callback:function(){this.video.back()},refresh:function(d){var c=this.video.get();c||this.opts.toolbarInline?(d.removeClass("fr-hidden"),d.next(".fr-separator").removeClass("fr-hidden")):(d.addClass("fr-hidden"),d.next(".fr-separator").addClass("fr-hidden"))}}),b.FE.RegisterCommand("videoDismissError",{title:"OK",undo:!1,callback:function(){this.video.hideProgressBar(!0)}}),b.FE.RegisterCommand("videoSetSize",{undo:!0,focus:!1,title:"Update",refreshAfterCallback:!1,callback:function(){this.video.setSize()}})});