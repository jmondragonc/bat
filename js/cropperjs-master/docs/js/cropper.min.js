/*!
 * Cropper.js v1.3.1
 * https://github.com/fengyuanchen/cropperjs
 *
 * Copyright (c) 2015-2018 Chen Fengyuan
 * Released under the MIT license
 *
 * Date: 2018-02-28T13:25:11.920Z
 */
(function(b,a){typeof exports==="object"&&typeof module!=="undefined"?module.exports=a():typeof define==="function"&&define.amd?define(a):(b.Cropper=a())}(this,(function(){var an=typeof window!=="undefined"?window:{};var G="cropper";var X="all";var a2="crop";var bt="move";var A="zoom";var ap="e";var P="w";var c="s";var bE="n";var aP="ne";var at="nw";var f="se";var bu="sw";var bk=G+"-crop";var g=G+"-disabled";var h=G+"-hidden";var ad=G+"-hide";var ac=G+"-invisible";var a9=G+"-modal";var bH=G+"-move";var ba="action";var aQ="preview";var aj="crop";var aE="move";var al="none";var bw="crop";var aO="cropend";var bC="cropmove";var y="cropstart";var bx="dblclick";var ay="load";var bh=an.PointerEvent?"pointerdown":"touchstart mousedown";var bp=an.PointerEvent?"pointermove":"touchmove mousemove";var by=an.PointerEvent?"pointerup pointercancel":"touchend touchcancel mouseup";var ae="ready";var aq="resize";var az="wheel mousewheel DOMMouseScroll";var ai="zoom";var L=/^(?:e|w|s|n|se|sw|ne|nw|all|crop|move|zoom)$/;var aX=/^data:/;var bo=/^data:image\/jpeg;base64,/;var aY=/^(?:img|canvas)$/i;var N={viewMode:0,dragMode:aj,aspectRatio:NaN,data:null,preview:"",responsive:true,restore:true,checkCrossOrigin:true,checkOrientation:true,modal:true,guides:true,center:true,highlight:true,background:true,autoCrop:true,autoCropArea:0.8,movable:true,rotatable:true,scalable:true,zoomable:true,zoomOnTouch:true,zoomOnWheel:true,wheelZoomRatio:0.1,cropBoxMovable:true,cropBoxResizable:true,toggleDragModeOnDblclick:true,minCanvasWidth:0,minCanvasHeight:0,minCropBoxWidth:0,minCropBoxHeight:0,minContainerWidth:200,minContainerHeight:100,ready:null,cropstart:null,cropmove:null,cropend:null,crop:null,zoom:null};var af='<div class="cropper-container" touch-action="none"><div class="cropper-wrap-box"><div class="cropper-canvas"></div></div><div class="cropper-drag-box"></div><div class="cropper-crop-box"><span class="cropper-view-box"></span><span class="cropper-dashed dashed-h"></span><span class="cropper-dashed dashed-v"></span><span class="cropper-center"></span><span class="cropper-face"></span><span class="cropper-line line-e" data-action="e"></span><span class="cropper-line line-n" data-action="n"></span><span class="cropper-line line-w" data-action="w"></span><span class="cropper-line line-s" data-action="s"></span><span class="cropper-point point-e" data-action="e"></span><span class="cropper-point point-n" data-action="n"></span><span class="cropper-point point-w" data-action="w"></span><span class="cropper-point point-s" data-action="s"></span><span class="cropper-point point-ne" data-action="ne"></span><span class="cropper-point point-nw" data-action="nw"></span><span class="cropper-point point-sw" data-action="sw"></span><span class="cropper-point point-se" data-action="se"></span></div></div>';var B=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(bK){return typeof bK}:function(bK){return bK&&typeof Symbol==="function"&&bK.constructor===Symbol&&bK!==Symbol.prototype?"symbol":typeof bK};var aA=function(bK,bL){if(!(bK instanceof bL)){throw new TypeError("Cannot call a class as a function")}};var a=function(){function bK(bO,bM){for(var bL=0;bL<bM.length;bL++){var bN=bM[bL];bN.enumerable=bN.enumerable||false;bN.configurable=true;if("value" in bN){bN.writable=true}Object.defineProperty(bO,bN.key,bN)}}return function(bN,bL,bM){if(bL){bK(bN.prototype,bL)}if(bM){bK(bN,bM)}return bN}}();var bB=function(bK){if(Array.isArray(bK)){for(var bM=0,bL=Array(bK.length);bM<bK.length;bM++){bL[bM]=bK[bM]}return bL}else{return Array.from(bK)}};var ax=Number.isNaN||an.isNaN;function Y(bK){return typeof bK==="number"&&!ax(bK)}function aF(bK){return typeof bK==="undefined"}function bG(bK){return(typeof bK==="undefined"?"undefined":B(bK))==="object"&&bK!==null}var D=Object.prototype.hasOwnProperty;function u(bL){if(!bG(bL)){return false}try{var bN=bL.constructor;var bK=bN.prototype;return bN&&bK&&D.call(bK,"isPrototypeOf")}catch(bM){return false}}function n(bK){return typeof bK==="function"}function ak(bM,bN){if(bM&&n(bN)){if(Array.isArray(bM)||Y(bM.length)){var bL=bM.length;var bK=void 0;for(bK=0;bK<bL;bK+=1){if(bN.call(bM,bM[bK],bK,bM)===false){break}}}else{if(bG(bM)){Object.keys(bM).forEach(function(bO){bN.call(bM,bM[bO],bO,bM)})}}}return bM}var Z=Object.assign||function Z(bN){for(var bK=arguments.length,bL=Array(bK>1?bK-1:0),bM=1;bM<bK;bM++){bL[bM-1]=arguments[bM]}if(bG(bN)&&bL.length>0){bL.forEach(function(bO){if(bG(bO)){Object.keys(bO).forEach(function(bP){bN[bP]=bO[bP]})}})}return bN};var a7=/\.\d*(?:0|9){12}\d*$/i;function bb(bK){var bL=arguments.length>1&&arguments[1]!==undefined?arguments[1]:100000000000;return a7.test(bK)?Math.round(bK*bL)/bL:bK}var i=/^(?:width|height|left|top|marginLeft|marginTop)$/;function M(bK,bM){var bL=bK.style;ak(bM,function(bO,bN){if(i.test(bN)&&Y(bO)){bO+="px"}bL[bN]=bO})}function w(bK,bL){return bK.classList?bK.classList.contains(bL):bK.className.indexOf(bL)>-1}function v(bK,bM){if(!bM){return}if(Y(bK.length)){ak(bK,function(bN){v(bN,bM)});return}if(bK.classList){bK.classList.add(bM);return}var bL=bK.className.trim();if(!bL){bK.className=bM}else{if(bL.indexOf(bM)<0){bK.className=bL+" "+bM}}}function aU(bK,bL){if(!bL){return}if(Y(bK.length)){ak(bK,function(bM){aU(bM,bL)});return}if(bK.classList){bK.classList.remove(bL);return}if(bK.className.indexOf(bL)>=0){bK.className=bK.className.replace(bL,"")}}function aS(bK,bM,bL){if(!bM){return}if(Y(bK.length)){ak(bK,function(bN){aS(bN,bM,bL)});return}if(bL){v(bK,bM)}else{aU(bK,bM)}}var aZ=/([a-z\d])([A-Z])/g;function bq(bK){return bK.replace(aZ,"$1-$2").toLowerCase()}function a4(bL,bK){if(bG(bL[bK])){return bL[bK]}else{if(bL.dataset){return bL.dataset[bK]}}return bL.getAttribute("data-"+bq(bK))}function am(bL,bK,bM){if(bG(bM)){bL[bK]=bM}else{if(bL.dataset){bL.dataset[bK]=bM}else{bL.setAttribute("data-"+bq(bK),bM)}}}function p(bL,bK){if(bG(bL[bK])){try{delete bL[bK]}catch(bM){bL[bK]=undefined}}else{if(bL.dataset){try{delete bL.dataset[bK]}catch(bM){bL.dataset[bK]=undefined}}else{bL.removeAttribute("data-"+bq(bK))}}}var C=/\s\s*/;function j(bL,bM,bN){var bK=arguments.length>3&&arguments[3]!==undefined?arguments[3]:{};ak(bM.trim().split(C),function(bO){bL.removeEventListener(bO,bN,bK)})}function bg(bM,bN,bP){var bL=arguments.length>3&&arguments[3]!==undefined?arguments[3]:{};if(bL.once){var bK=bP;bP=function bO(){for(var bQ=arguments.length,bS=Array(bQ),bR=0;bR<bQ;bR++){bS[bR]=arguments[bR]}j(bM,bN,bP,bL);return bK.apply(bM,bS)}}ak(bN.trim().split(C),function(bQ){bM.addEventListener(bQ,bP,bL)})}function aJ(bK,bL,bN){var bM=void 0;if(n(Event)&&n(CustomEvent)){bM=new CustomEvent(bL,{detail:bN,bubbles:true,cancelable:true})}else{bM=document.createEvent("CustomEvent");bM.initCustomEvent(bL,true,true,bN)}return bK.dispatchEvent(bM)}function bF(bK){var bL=bK.getBoundingClientRect();return{left:bL.left+(window.pageXOffset-document.documentElement.clientLeft),top:bL.top+(window.pageYOffset-document.documentElement.clientTop)}}var aC=an.location;var aG=/^(https?:)\/\/([^:/?#]+):?(\d*)/i;function a6(bK){var bL=bK.match(aG);return bL&&(bL[1]!==aC.protocol||bL[2]!==aC.hostname||bL[3]!==aC.port)}function bz(bK){var bL="timestamp="+new Date().getTime();return bK+(bK.indexOf("?")===-1?"?":"&")+bL}function E(bP){var bO=bP.rotate,bN=bP.scaleX,bL=bP.scaleY,bR=bP.translateX,bQ=bP.translateY;var bK=[];if(Y(bR)&&bR!==0){bK.push("translateX("+bR+"px)")}if(Y(bQ)&&bQ!==0){bK.push("translateY("+bQ+"px)")}if(Y(bO)&&bO!==0){bK.push("rotate("+bO+"deg)")}if(Y(bN)&&bN!==1){bK.push("scaleX("+bN+")")}if(Y(bL)&&bL!==1){bK.push("scaleY("+bL+")")}var bM=bK.length?bK.join(" "):"none";return{WebkitTransform:bM,msTransform:bM,transform:bM}}function a3(bK){var bM=Z({},bK);var bL=[];ak(bK,function(bO,bN){delete bM[bN];ak(bM,function(bP){var bR=Math.abs(bO.startX-bP.startX);var bU=Math.abs(bO.startY-bP.startY);var bQ=Math.abs(bO.endX-bP.endX);var bS=Math.abs(bO.endY-bP.endY);var bW=Math.sqrt(bR*bR+bU*bU);var bV=Math.sqrt(bQ*bQ+bS*bS);var bT=(bV-bW)/bW;bL.push(bT)})});bL.sort(function(bO,bN){return Math.abs(bO)<Math.abs(bN)});return bL[0]}function ar(bO,bN){var bM=bO.pageX,bL=bO.pageY;var bK={endX:bM,endY:bL};return bN?bK:Z({startX:bM,startY:bL},bK)}function bf(bK){var bM=0;var bL=0;var bN=0;ak(bK,function(bQ){var bP=bQ.startX,bO=bQ.startY;bM+=bP;bL+=bO;bN+=1});bM/=bN;bL/=bN;return{pageX:bM,pageY:bL}}var t=Number.isFinite||an.isFinite;function bi(bQ){var bP=bQ.aspectRatio,bK=bQ.height,bO=bQ.width;var bN=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"contain";var bL=function bL(bR){return t(bR)&&bR>0};if(bL(bO)&&bL(bK)){var bM=bK*bP;if(bN==="contain"&&bM>bO||bN==="cover"&&bM<bO){bK=bO/bP}else{bO=bK*bP}}else{if(bL(bO)){bK=bO/bP}else{if(bL(bK)){bO=bK*bP}}}return{width:bO,height:bK}}function bd(bN){var bL=bN.width,bS=bN.height,bO=bN.degree;bO=Math.abs(bO)%180;if(bO===90){return{width:bS,height:bL}}var bM=bO%90*Math.PI/180;var bQ=Math.sin(bM);var bR=Math.cos(bM);var bP=bL*bR+bS*bQ;var bK=bL*bQ+bS*bR;return bO>90?{width:bK,height:bP}:{width:bP,height:bK}}function aV(b2,bN,bK,ch){var bY=bN.rotate,b8=bY===undefined?0:bY,b4=bN.scaleX,ce=b4===undefined?1:b4,b3=bN.scaleY,cc=b3===undefined?1:b3;var bL=bK.aspectRatio,bR=bK.naturalWidth,bP=bK.naturalHeight;var bX=ch.fillColor,bV=bX===undefined?"transparent":bX,bU=ch.imageSmoothingEnabled,bM=bU===undefined?true:bU,cf=ch.imageSmoothingQuality,bQ=cf===undefined?"low":cf,cg=ch.maxWidth,b9=cg===undefined?Infinity:cg,ca=ch.maxHeight,b6=ca===undefined?Infinity:ca,b7=ch.minWidth,b0=b7===undefined?0:b7,bZ=ch.minHeight,bW=bZ===undefined?0:bZ;var bS=document.createElement("canvas");var bO=bS.getContext("2d");var bT=bi({aspectRatio:bL,width:b9,height:b6});var cd=bi({aspectRatio:bL,width:b0,height:bW},"cover");var b5=Math.min(bT.width,Math.max(cd.width,bR));var b1=Math.min(bT.height,Math.max(cd.height,bP));var cb=[-b5/2,-b1/2,b5,b1];bS.width=bb(b5);bS.height=bb(b1);bO.fillStyle=bV;bO.fillRect(0,0,b5,b1);bO.save();bO.translate(b5/2,b1/2);bO.rotate(b8*Math.PI/180);bO.scale(ce,cc);bO.imageSmoothingEnabled=bM;bO.imageSmoothingQuality=bQ;bO.drawImage.apply(bO,[b2].concat(bB(cb.map(function(ci){return Math.floor(bb(ci))}))));bO.restore();return bS}var q=String.fromCharCode;function I(bN,bO,bL){var bM="";var bK=void 0;bL+=bO;for(bK=bO;bK<bL;bK+=1){bM+=q(bN.getUint8(bK))}return bM}var U=/^data:.*,/;function aw(bN){var bL=bN.replace(U,"");var bO=atob(bL);var bM=new ArrayBuffer(bO.length);var bK=new Uint8Array(bM);ak(bK,function(bQ,bP){bK[bP]=bO.charCodeAt(bP)});return bM}function T(bL,bN){var bK=new Uint8Array(bL);var bM="";ak(bK,function(bO){bM+=q(bO)});return"data:"+bN+";base64,"+btoa(bM)}function au(bR){var bV=new DataView(bR);var bM=void 0;var bL=void 0;var bQ=void 0;var bY=void 0;if(bV.getUint8(0)===255&&bV.getUint8(1)===216){var bN=bV.byteLength;var bO=2;while(bO<bN){if(bV.getUint8(bO)===255&&bV.getUint8(bO+1)===225){bQ=bO;break}bO+=1}}if(bQ){var bX=bQ+4;var bU=bQ+10;if(I(bV,bX,4)==="Exif"){var bT=bV.getUint16(bU);bL=bT===18761;if(bL||bT===19789){if(bV.getUint16(bU+2,bL)===42){var bK=bV.getUint32(bU+4,bL);if(bK>=8){bY=bU+bK}}}}}if(bY){var bS=bV.getUint16(bY,bL);var bW=void 0;var bP=void 0;for(bP=0;bP<bS;bP+=1){bW=bY+bP*12+2;if(bV.getUint16(bW,bL)===274){bW+=8;bM=bV.getUint16(bW,bL);bV.setUint16(bW,1,bL);break}}}return bM}function k(bL){var bN=0;var bM=1;var bK=1;switch(bL){case 2:bM=-1;break;case 3:bN=-180;break;case 4:bK=-1;break;case 5:bN=90;bK=-1;break;case 6:bN=90;break;case 7:bN=90;bM=-1;break;case 8:bN=-90;break;default:}return{rotate:bN,scaleX:bM,scaleY:bK}}var R={render:function R(){this.initContainer();this.initCanvas();this.initCropBox();this.renderCanvas();if(this.cropped){this.renderCropBox()}},initContainer:function bc(){var bN=this.element,bM=this.options,bL=this.container,bO=this.cropper;v(bO,h);aU(bN,h);var bK={width:Math.max(bL.offsetWidth,Number(bM.minContainerWidth)||200),height:Math.max(bL.offsetHeight,Number(bM.minContainerHeight)||100)};this.containerData=bK;M(bO,{width:bK.width,height:bK.height});v(bN,h);aU(bO,h)},initCanvas:function be(){var bR=this.containerData,bK=this.imageData;var bM=this.options.viewMode;var bL=Math.abs(bK.rotate)%180===90;var bQ=bL?bK.naturalHeight:bK.naturalWidth;var bS=bL?bK.naturalWidth:bK.naturalHeight;var bT=bQ/bS;var bN=bR.width;var bP=bR.height;if(bR.height*bT>bR.width){if(bM===3){bN=bR.height*bT}else{bP=bR.width/bT}}else{if(bM===3){bP=bR.width/bT}else{bN=bR.height*bT}}var bO={aspectRatio:bT,naturalWidth:bQ,naturalHeight:bS,width:bN,height:bP};bO.left=(bR.width-bN)/2;bO.top=(bR.height-bP)/2;bO.oldLeft=bO.left;bO.oldTop=bO.top;this.canvasData=bO;this.limited=bM===1||bM===2;this.limitCanvas(true,true);this.initialImageData=Z({},bK);this.initialCanvasData=Z({},bO)},limitCanvas:function a8(bK,bP){var bX=this.options,bR=this.containerData,bQ=this.canvasData,bN=this.cropBoxData;var bO=bX.viewMode;var bV=bQ.aspectRatio;var bU=this.cropped&&bN;if(bK){var bW=Number(bX.minCanvasWidth)||0;var bS=Number(bX.minCanvasHeight)||0;if(bO>1){bW=Math.max(bW,bR.width);bS=Math.max(bS,bR.height);if(bO===3){if(bS*bV>bW){bW=bS*bV}else{bS=bW/bV}}}else{if(bO>0){if(bW){bW=Math.max(bW,bU?bN.width:0)}else{if(bS){bS=Math.max(bS,bU?bN.height:0)}else{if(bU){bW=bN.width;bS=bN.height;if(bS*bV>bW){bW=bS*bV}else{bS=bW/bV}}}}}}var bL=bi({aspectRatio:bV,width:bW,height:bS});bW=bL.width;bS=bL.height;bQ.minWidth=bW;bQ.minHeight=bS;bQ.maxWidth=Infinity;bQ.maxHeight=Infinity}if(bP){if(bO){var bM=bR.width-bQ.width;var bT=bR.height-bQ.height;bQ.minLeft=Math.min(0,bM);bQ.minTop=Math.min(0,bT);bQ.maxLeft=Math.max(0,bM);bQ.maxTop=Math.max(0,bT);if(bU&&this.limited){bQ.minLeft=Math.min(bN.left,bN.left+(bN.width-bQ.width));bQ.minTop=Math.min(bN.top,bN.top+(bN.height-bQ.height));bQ.maxLeft=bN.left;bQ.maxTop=bN.top;if(bO===2){if(bQ.width>=bR.width){bQ.minLeft=Math.min(0,bM);bQ.maxLeft=Math.max(0,bM)}if(bQ.height>=bR.height){bQ.minTop=Math.min(0,bT);bQ.maxTop=Math.max(0,bT)}}}}else{bQ.minLeft=-bQ.width;bQ.minTop=-bQ.height;bQ.maxLeft=bR.width;bQ.maxTop=bR.height}}},renderCanvas:function br(bP,bN){var bO=this.canvasData,bK=this.imageData;if(bN){var bM=bd({width:bK.naturalWidth*Math.abs(bK.scaleX||1),height:bK.naturalHeight*Math.abs(bK.scaleY||1),degree:bK.rotate||0}),bQ=bM.width,bR=bM.height;var bL=bO.width*(bQ/bO.naturalWidth);var bS=bO.height*(bR/bO.naturalHeight);bO.left-=(bL-bO.width)/2;bO.top-=(bS-bO.height)/2;bO.width=bL;bO.height=bS;bO.aspectRatio=bQ/bR;bO.naturalWidth=bQ;bO.naturalHeight=bR;this.limitCanvas(true,false)}if(bO.width>bO.maxWidth||bO.width<bO.minWidth){bO.left=bO.oldLeft}if(bO.height>bO.maxHeight||bO.height<bO.minHeight){bO.top=bO.oldTop}bO.width=Math.min(Math.max(bO.width,bO.minWidth),bO.maxWidth);bO.height=Math.min(Math.max(bO.height,bO.minHeight),bO.maxHeight);this.limitCanvas(false,true);bO.left=Math.min(Math.max(bO.left,bO.minLeft),bO.maxLeft);bO.top=Math.min(Math.max(bO.top,bO.minTop),bO.maxTop);bO.oldLeft=bO.left;bO.oldTop=bO.top;M(this.canvas,Z({width:bO.width,height:bO.height},E({translateX:bO.left,translateY:bO.top})));this.renderImage(bP);if(this.cropped&&this.limited){this.limitCropBox(true,true)}},renderImage:function bs(bN){var bL=this.canvasData,bO=this.imageData;var bM=bO.naturalWidth*(bL.width/bL.naturalWidth);var bK=bO.naturalHeight*(bL.height/bL.naturalHeight);Z(bO,{width:bM,height:bK,left:(bL.width-bM)/2,top:(bL.height-bK)/2});M(this.image,Z({width:bO.width,height:bO.height},E(Z({translateX:bO.left,translateY:bO.top},bO))));if(bN){this.output()}},initCropBox:function e(){var bL=this.options,bK=this.canvasData;var bM=bL.aspectRatio;var bO=Number(bL.autoCropArea)||0.8;var bN={width:bK.width,height:bK.height};if(bM){if(bK.height*bM>bK.width){bN.height=bN.width/bM}else{bN.width=bN.height*bM}}this.cropBoxData=bN;this.limitCropBox(true,true);bN.width=Math.min(Math.max(bN.width,bN.minWidth),bN.maxWidth);bN.height=Math.min(Math.max(bN.height,bN.minHeight),bN.maxHeight);bN.width=Math.max(bN.minWidth,bN.width*bO);bN.height=Math.max(bN.minHeight,bN.height*bO);bN.left=bK.left+(bK.width-bN.width)/2;bN.top=bK.top+(bK.height-bN.height)/2;bN.oldLeft=bN.left;bN.oldTop=bN.top;this.initialCropBoxData=Z({},bN)},limitCropBox:function bn(bK,bN){var bV=this.options,bP=this.containerData,bO=this.canvasData,bM=this.cropBoxData,bS=this.limited;var bU=bV.aspectRatio;if(bK){var bL=Number(bV.minCropBoxWidth)||0;var bQ=Number(bV.minCropBoxHeight)||0;var bR=Math.min(bP.width,bS?bO.width:bP.width);var bT=Math.min(bP.height,bS?bO.height:bP.height);bL=Math.min(bL,bP.width);bQ=Math.min(bQ,bP.height);if(bU){if(bL&&bQ){if(bQ*bU>bL){bQ=bL/bU}else{bL=bQ*bU}}else{if(bL){bQ=bL/bU}else{if(bQ){bL=bQ*bU}}}if(bT*bU>bR){bT=bR/bU}else{bR=bT*bU}}bM.minWidth=Math.min(bL,bR);bM.minHeight=Math.min(bQ,bT);bM.maxWidth=bR;bM.maxHeight=bT}if(bN){if(bS){bM.minLeft=Math.max(0,bO.left);bM.minTop=Math.max(0,bO.top);bM.maxLeft=Math.min(bP.width,bO.left+bO.width)-bM.width;bM.maxTop=Math.min(bP.height,bO.top+bO.height)-bM.height}else{bM.minLeft=0;bM.minTop=0;bM.maxLeft=bP.width-bM.width;bM.maxTop=bP.height-bM.height}}},renderCropBox:function H(){var bL=this.options,bK=this.containerData,bM=this.cropBoxData;if(bM.width>bM.maxWidth||bM.width<bM.minWidth){bM.left=bM.oldLeft}if(bM.height>bM.maxHeight||bM.height<bM.minHeight){bM.top=bM.oldTop}bM.width=Math.min(Math.max(bM.width,bM.minWidth),bM.maxWidth);bM.height=Math.min(Math.max(bM.height,bM.minHeight),bM.maxHeight);this.limitCropBox(false,true);bM.left=Math.min(Math.max(bM.left,bM.minLeft),bM.maxLeft);bM.top=Math.min(Math.max(bM.top,bM.minTop),bM.maxTop);bM.oldLeft=bM.left;bM.oldTop=bM.top;if(bL.movable&&bL.cropBoxMovable){am(this.face,ba,bM.width>=bK.width&&bM.height>=bK.height?bt:X)}M(this.cropBox,Z({width:bM.width,height:bM.height},E({translateX:bM.left,translateY:bM.top})));if(this.cropped&&this.limited){this.limitCanvas(true,true)}if(!this.disabled){this.output()}},output:function bD(){this.preview();aJ(this.element,bw,this.getData())}};var b={initPreview:function bm(){var bK=this.crossOrigin;var bO=this.options.preview;var bL=bK?this.crossOriginUrl:this.url;var bN=document.createElement("img");if(bK){bN.crossOrigin=bK}bN.src=bL;this.viewBox.appendChild(bN);this.viewBoxImage=bN;if(!bO){return}var bM=bO;if(typeof bO==="string"){bM=this.element.ownerDocument.querySelectorAll(bO)}else{if(bO.querySelector){bM=[bO]}}this.previews=bM;ak(bM,function(bQ){var bP=document.createElement("img");am(bQ,aQ,{width:bQ.offsetWidth,height:bQ.offsetHeight,html:bQ.innerHTML});if(bK){bP.crossOrigin=bK}bP.src=bL;bP.style.cssText='display:block;width:100%;height:auto;min-width:0!important;min-height:0!important;max-width:none!important;max-height:none!important;image-orientation:0deg!important;"';bQ.innerHTML="";bQ.appendChild(bP)})},resetPreview:function bJ(){ak(this.previews,function(bK){var bL=a4(bK,aQ);M(bK,{width:bL.width,height:bL.height});bK.innerHTML=bL.html;p(bK,aQ)})},preview:function b(){var bK=this.imageData,bP=this.canvasData,bN=this.cropBoxData;var bL=bN.width,bQ=bN.height;var bM=bK.width,bS=bK.height;var bO=bN.left-bP.left-bK.left;var bR=bN.top-bP.top-bK.top;if(!this.cropped||this.disabled){return}M(this.viewBoxImage,Z({width:bM,height:bS},E(Z({translateX:-bO,translateY:-bR},bK))));ak(this.previews,function(bU){var bY=a4(bU,aQ);var bZ=bY.width;var bX=bY.height;var bW=bZ;var bT=bX;var bV=1;if(bL){bV=bZ/bL;bT=bQ*bV}if(bQ&&bT>bX){bV=bX/bQ;bW=bL*bV;bT=bX}M(bU,{width:bW,height:bT});M(bU.getElementsByTagName("img")[0],Z({width:bM*bV,height:bS*bV},E(Z({translateX:-bO*bV,translateY:-bR*bV},bK))))})}};var bA={bind:function aI(){var bL=this.element,bK=this.options,bM=this.cropper;if(n(bK.cropstart)){bg(bL,y,bK.cropstart)}if(n(bK.cropmove)){bg(bL,bC,bK.cropmove)}if(n(bK.cropend)){bg(bL,aO,bK.cropend)}if(n(bK.crop)){bg(bL,bw,bK.crop)}if(n(bK.zoom)){bg(bL,ai,bK.zoom)}bg(bM,bh,this.onCropStart=this.cropStart.bind(this));if(bK.zoomable&&bK.zoomOnWheel){bg(bM,az,this.onWheel=this.wheel.bind(this))}if(bK.toggleDragModeOnDblclick){bg(bM,bx,this.onDblclick=this.dblclick.bind(this))}bg(bL.ownerDocument,bp,this.onCropMove=this.cropMove.bind(this));bg(bL.ownerDocument,by,this.onCropEnd=this.cropEnd.bind(this));if(bK.responsive){bg(window,aq,this.onResize=this.resize.bind(this))}},unbind:function a5(){var bL=this.element,bK=this.options,bM=this.cropper;if(n(bK.cropstart)){j(bL,y,bK.cropstart)}if(n(bK.cropmove)){j(bL,bC,bK.cropmove)}if(n(bK.cropend)){j(bL,aO,bK.cropend)}if(n(bK.crop)){j(bL,bw,bK.crop)}if(n(bK.zoom)){j(bL,ai,bK.zoom)}j(bM,bh,this.onCropStart);if(bK.zoomable&&bK.zoomOnWheel){j(bM,az,this.onWheel)}if(bK.toggleDragModeOnDblclick){j(bM,bx,this.onDblclick)}j(bL.ownerDocument,bp,this.onCropMove);j(bL.ownerDocument,by,this.onCropEnd);if(bK.responsive){j(window,aq,this.onResize)}}};var aT={resize:function x(){var bO=this.options,bL=this.container,bK=this.containerData;var bR=Number(bO.minContainerWidth)||200;var bM=Number(bO.minContainerHeight)||100;if(this.disabled||bK.width<=bR||bK.height<=bM){return}var bP=bL.offsetWidth/bK.width;if(bP!==1||bL.offsetHeight!==bK.height){var bN=void 0;var bQ=void 0;if(bO.restore){bN=this.getCanvasData();bQ=this.getCropBoxData()}this.render();if(bO.restore){this.setCanvasData(ak(bN,function(bT,bS){bN[bS]=bT*bP}));this.setCropBoxData(ak(bQ,function(bT,bS){bQ[bS]=bT*bP}))}}},dblclick:function ab(){if(this.disabled||this.options.dragMode===al){return}this.setDragMode(w(this.dragBox,bk)?aE:aj)},wheel:function l(bL){var bN=this;var bK=Number(this.options.wheelZoomRatio)||0.1;var bM=1;if(this.disabled){return}bL.preventDefault();if(this.wheeling){return}this.wheeling=true;setTimeout(function(){bN.wheeling=false},50);if(bL.deltaY){bM=bL.deltaY>0?1:-1}else{if(bL.wheelDelta){bM=-bL.wheelDelta/120}else{if(bL.detail){bM=bL.detail>0?1:-1}}}this.zoom(-bM*bK,bL)},cropStart:function a1(bN){if(this.disabled){return}var bL=this.options,bK=this.pointers;var bM=void 0;if(bN.changedTouches){ak(bN.changedTouches,function(bO){bK[bO.identifier]=ar(bO)})}else{bK[bN.pointerId||0]=ar(bN)}if(Object.keys(bK).length>1&&bL.zoomable&&bL.zoomOnTouch){bM=A}else{bM=a4(bN.target,ba)}if(!L.test(bM)){return}if(aJ(this.element,y,{originalEvent:bN,action:bM})===false){return}bN.preventDefault();this.action=bM;this.cropping=false;if(bM===a2){this.cropping=true;v(this.dragBox,a9)}},cropMove:function aM(bM){var bL=this.action;if(this.disabled||!bL){return}var bK=this.pointers;bM.preventDefault();if(aJ(this.element,bC,{originalEvent:bM,action:bL})===false){return}if(bM.changedTouches){ak(bM.changedTouches,function(bN){Z(bK[bN.identifier],ar(bN,true))})}else{Z(bK[bM.pointerId||0],ar(bM,true))}this.change(bM)},cropEnd:function bj(bM){if(this.disabled){return}var bL=this.action,bK=this.pointers;if(bM.changedTouches){ak(bM.changedTouches,function(bN){delete bK[bN.identifier]})}else{delete bK[bM.pointerId||0]}if(!bL){return}bM.preventDefault();if(!Object.keys(bK).length){this.action=""}if(this.cropping){this.cropping=false;aS(this.dragBox,a9,this.cropped&&this.options.modal)}aJ(this.element,aO,{originalEvent:bM,action:bL})}};var aD={change:function aD(b4){var bM=this.options,bS=this.canvasData,bL=this.containerData,bX=this.cropBoxData,bR=this.pointers;var b2=this.action;var bK=bM.aspectRatio;var bN=bX.left,bU=bX.top,b0=bX.width,bV=bX.height;var b6=bN+b0;var bP=bU+bV;var bW=0;var bQ=0;var b3=bL.width;var bZ=bL.height;var bY=true;var bO=void 0;if(!bK&&b4.shiftKey){bK=b0&&bV?b0/bV:1}if(this.limited){bW=bX.minLeft;bQ=bX.minTop;b3=bW+Math.min(bL.width,bS.width,bS.left+bS.width);bZ=bQ+Math.min(bL.height,bS.height,bS.top+bS.height)}var b1=bR[Object.keys(bR)[0]];var bT={x:b1.endX-b1.startX,y:b1.endY-b1.startY};var b5=function b5(b7){switch(b7){case ap:if(b6+bT.x>b3){bT.x=b3-b6}break;case P:if(bN+bT.x<bW){bT.x=bW-bN}break;case bE:if(bU+bT.y<bQ){bT.y=bQ-bU}break;case c:if(bP+bT.y>bZ){bT.y=bZ-bP}break;default:}};switch(b2){case X:bN+=bT.x;bU+=bT.y;break;case ap:if(bT.x>=0&&(b6>=b3||bK&&(bU<=bQ||bP>=bZ))){bY=false;break}b5(ap);b0+=bT.x;if(bK){bV=b0/bK;bU-=bT.x/bK/2}if(b0<0){b2=P;b0=0}break;case bE:if(bT.y<=0&&(bU<=bQ||bK&&(bN<=bW||b6>=b3))){bY=false;break}b5(bE);bV-=bT.y;bU+=bT.y;if(bK){b0=bV*bK;bN+=bT.y*bK/2}if(bV<0){b2=c;bV=0}break;case P:if(bT.x<=0&&(bN<=bW||bK&&(bU<=bQ||bP>=bZ))){bY=false;break}b5(P);b0-=bT.x;bN+=bT.x;if(bK){bV=b0/bK;bU+=bT.x/bK/2}if(b0<0){b2=ap;b0=0}break;case c:if(bT.y>=0&&(bP>=bZ||bK&&(bN<=bW||b6>=b3))){bY=false;break}b5(c);bV+=bT.y;if(bK){b0=bV*bK;bN-=bT.y*bK/2}if(bV<0){b2=bE;bV=0}break;case aP:if(bK){if(bT.y<=0&&(bU<=bQ||b6>=b3)){bY=false;break}b5(bE);bV-=bT.y;bU+=bT.y;b0=bV*bK}else{b5(bE);b5(ap);if(bT.x>=0){if(b6<b3){b0+=bT.x}else{if(bT.y<=0&&bU<=bQ){bY=false}}}else{b0+=bT.x}if(bT.y<=0){if(bU>bQ){bV-=bT.y;bU+=bT.y}}else{bV-=bT.y;bU+=bT.y}}if(b0<0&&bV<0){b2=bu;bV=0;b0=0}else{if(b0<0){b2=at;b0=0}else{if(bV<0){b2=f;bV=0}}}break;case at:if(bK){if(bT.y<=0&&(bU<=bQ||bN<=bW)){bY=false;break}b5(bE);bV-=bT.y;bU+=bT.y;b0=bV*bK;bN+=bT.y*bK}else{b5(bE);b5(P);if(bT.x<=0){if(bN>bW){b0-=bT.x;bN+=bT.x}else{if(bT.y<=0&&bU<=bQ){bY=false}}}else{b0-=bT.x;bN+=bT.x}if(bT.y<=0){if(bU>bQ){bV-=bT.y;bU+=bT.y}}else{bV-=bT.y;bU+=bT.y}}if(b0<0&&bV<0){b2=f;bV=0;b0=0}else{if(b0<0){b2=aP;b0=0}else{if(bV<0){b2=bu;bV=0}}}break;case bu:if(bK){if(bT.x<=0&&(bN<=bW||bP>=bZ)){bY=false;break}b5(P);b0-=bT.x;bN+=bT.x;bV=b0/bK}else{b5(c);b5(P);if(bT.x<=0){if(bN>bW){b0-=bT.x;bN+=bT.x}else{if(bT.y>=0&&bP>=bZ){bY=false}}}else{b0-=bT.x;bN+=bT.x}if(bT.y>=0){if(bP<bZ){bV+=bT.y}}else{bV+=bT.y}}if(b0<0&&bV<0){b2=aP;bV=0;b0=0}else{if(b0<0){b2=f;b0=0}else{if(bV<0){b2=at;bV=0}}}break;case f:if(bK){if(bT.x>=0&&(b6>=b3||bP>=bZ)){bY=false;break}b5(ap);b0+=bT.x;bV=b0/bK}else{b5(c);b5(ap);if(bT.x>=0){if(b6<b3){b0+=bT.x}else{if(bT.y>=0&&bP>=bZ){bY=false}}}else{b0+=bT.x}if(bT.y>=0){if(bP<bZ){bV+=bT.y}}else{bV+=bT.y}}if(b0<0&&bV<0){b2=at;bV=0;b0=0}else{if(b0<0){b2=bu;b0=0}else{if(bV<0){b2=aP;bV=0}}}break;case bt:this.move(bT.x,bT.y);bY=false;break;case A:this.zoom(a3(bR),b4);bY=false;break;case a2:if(!bT.x||!bT.y){bY=false;break}bO=bF(this.cropper);bN=b1.startX-bO.left;bU=b1.startY-bO.top;b0=bX.minWidth;bV=bX.minHeight;if(bT.x>0){b2=bT.y>0?f:aP}else{if(bT.x<0){bN-=b0;b2=bT.y>0?bu:at}}if(bT.y<0){bU-=bV}if(!this.cropped){aU(this.cropBox,h);this.cropped=true;if(this.limited){this.limitCropBox(true,true)}}break;default:}if(bY){bX.width=b0;bX.height=bV;bX.left=bN;bX.top=bU;this.action=b2;this.renderCropBox()}ak(bR,function(b7){b7.startX=b7.endX;b7.startY=b7.endY})}};var ao={crop:function o(){if(this.ready&&!this.cropped&&!this.disabled){this.cropped=true;this.limitCropBox(true,true);if(this.options.modal){v(this.dragBox,a9)}aU(this.cropBox,h);this.setCropBoxData(this.initialCropBoxData)}return this},reset:function a0(){if(this.ready&&!this.disabled){this.imageData=Z({},this.initialImageData);this.canvasData=Z({},this.initialCanvasData);this.cropBoxData=Z({},this.initialCropBoxData);this.renderCanvas();if(this.cropped){this.renderCropBox()}}return this},clear:function bv(){if(this.cropped&&!this.disabled){Z(this.cropBoxData,{left:0,top:0,width:0,height:0});this.cropped=false;this.renderCropBox();this.limitCanvas(true,true);this.renderCanvas();aU(this.dragBox,a9);v(this.cropBox,h)}return this},replace:function aK(bL){var bK=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;if(!this.disabled&&bL){if(this.isImg){this.element.src=bL}if(bK){this.url=bL;this.image.src=bL;if(this.ready){this.viewBoxImage.src=bL;ak(this.previews,function(bM){bM.getElementsByTagName("img")[0].src=bL})}}else{if(this.isImg){this.replaced=true}this.options.data=null;this.uncreate();this.load(bL)}}return this},enable:function m(){if(this.ready&&this.disabled){this.disabled=false;aU(this.cropper,g)}return this},disable:function av(){if(this.ready&&!this.disabled){this.disabled=true;v(this.cropper,g)}return this},destroy:function r(){var bK=this.element;if(!a4(bK,G)){return this}if(this.isImg&&this.replaced){bK.src=this.originalUrl}this.uncreate();p(bK,G);return this},move:function F(bK){var bO=arguments.length>1&&arguments[1]!==undefined?arguments[1]:bK;var bL=this.canvasData,bN=bL.left,bM=bL.top;return this.moveTo(aF(bK)?bK:bN+Number(bK),aF(bO)?bO:bM+Number(bO))},moveTo:function bl(bK){var bN=arguments.length>1&&arguments[1]!==undefined?arguments[1]:bK;var bL=this.canvasData;var bM=false;bK=Number(bK);bN=Number(bN);if(this.ready&&!this.disabled&&this.options.movable){if(Y(bK)){bL.left=bK;bM=true}if(Y(bN)){bL.top=bN;bM=true}if(bM){this.renderCanvas(true)}}return this},zoom:function aR(bM,bK){var bL=this.canvasData;bM=Number(bM);if(bM<0){bM=1/(1-bM)}else{bM=1+bM}return this.zoomTo(bL.width*bM/bL.naturalWidth,null,bK)},zoomTo:function aL(bR,bV,bS){var bX=this.options,bO=this.canvasData;var bM=bO.width,bW=bO.height,bQ=bO.naturalWidth,bT=bO.naturalHeight;bR=Number(bR);if(bR>=0&&this.ready&&!this.disabled&&bX.zoomable){var bP=bQ*bR;var bL=bT*bR;if(aJ(this.element,ai,{originalEvent:bS,oldRatio:bM/bQ,ratio:bP/bQ})===false){return this}if(bS){var bU=this.pointers;var bN=bF(this.cropper);var bK=bU&&Object.keys(bU).length?bf(bU):{pageX:bS.pageX,pageY:bS.pageY};bO.left-=(bP-bM)*((bK.pageX-bN.left-bO.left)/bM);bO.top-=(bL-bW)*((bK.pageY-bN.top-bO.top)/bW)}else{if(u(bV)&&Y(bV.x)&&Y(bV.y)){bO.left-=(bP-bM)*((bV.x-bO.left)/bM);bO.top-=(bL-bW)*((bV.y-bO.top)/bW)}else{bO.left-=(bP-bM)/2;bO.top-=(bL-bW)/2}}bO.width=bP;bO.height=bL;this.renderCanvas(true)}return this},rotate:function s(bK){return this.rotateTo((this.imageData.rotate||0)+Number(bK))},rotateTo:function bI(bK){bK=Number(bK);if(Y(bK)&&this.ready&&!this.disabled&&this.options.rotatable){this.imageData.rotate=bK%360;this.renderCanvas(true,true)}return this},scaleX:function Q(bL){var bK=this.imageData.scaleY;return this.scale(bL,Y(bK)?bK:1)},scaleY:function O(bL){var bK=this.imageData.scaleX;return this.scale(Y(bK)?bK:1,bL)},scale:function aN(bM){var bK=arguments.length>1&&arguments[1]!==undefined?arguments[1]:bM;var bN=this.imageData;var bL=false;bM=Number(bM);bK=Number(bK);if(this.ready&&!this.disabled&&this.options.scalable){if(Y(bM)){bN.scaleX=bM;bL=true}if(Y(bK)){bN.scaleY=bK;bL=true}if(bL){this.renderCanvas(true,true)}}return this},getData:function aa(){var bK=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;var bM=this.options,bQ=this.imageData,bL=this.canvasData,bP=this.cropBoxData;var bO=void 0;if(this.ready&&this.cropped){bO={x:bP.left-bL.left,y:bP.top-bL.top,width:bP.width,height:bP.height};var bN=bQ.width/bQ.naturalWidth;ak(bO,function(bS,bR){bS/=bN;bO[bR]=bK?Math.round(bS):bS})}else{bO={x:0,y:0,width:0,height:0}}if(bM.rotatable){bO.rotate=bQ.rotate||0}if(bM.scalable){bO.scaleX=bQ.scaleX||1;bO.scaleY=bQ.scaleY||1}return bO},setData:function aB(bP){var bM=this.options,bQ=this.imageData,bL=this.canvasData;var bO={};if(this.ready&&!this.disabled&&u(bP)){var bK=false;if(bM.rotatable){if(Y(bP.rotate)&&bP.rotate!==bQ.rotate){bQ.rotate=bP.rotate;bK=true}}if(bM.scalable){if(Y(bP.scaleX)&&bP.scaleX!==bQ.scaleX){bQ.scaleX=bP.scaleX;bK=true}if(Y(bP.scaleY)&&bP.scaleY!==bQ.scaleY){bQ.scaleY=bP.scaleY;bK=true}}if(bK){this.renderCanvas(true,true)}var bN=bQ.width/bQ.naturalWidth;if(Y(bP.x)){bO.left=bP.x*bN+bL.left}if(Y(bP.y)){bO.top=bP.y*bN+bL.top}if(Y(bP.width)){bO.width=bP.width*bN}if(Y(bP.height)){bO.height=bP.height*bN}this.setCropBoxData(bO)}return this},getContainerData:function aW(){return this.ready?Z({},this.containerData):{}},getImageData:function W(){return this.sized?Z({},this.imageData):{}},getCanvasData:function S(){var bK=this.canvasData;var bL={};if(this.ready){ak(["left","top","width","height","naturalWidth","naturalHeight"],function(bM){bL[bM]=bK[bM]})}return bL},setCanvasData:function d(bM){var bK=this.canvasData;var bL=bK.aspectRatio;if(this.ready&&!this.disabled&&u(bM)){if(Y(bM.left)){bK.left=bM.left}if(Y(bM.top)){bK.top=bM.top}if(Y(bM.width)){bK.width=bM.width;bK.height=bM.width/bL}else{if(Y(bM.height)){bK.height=bM.height;bK.width=bM.height*bL}}this.renderCanvas(true)}return this},getCropBoxData:function ag(){var bL=this.cropBoxData;var bK=void 0;if(this.ready&&this.cropped){bK={left:bL.left,top:bL.top,width:bL.width,height:bL.height}}return bK||{}},setCropBoxData:function aH(bO){var bN=this.cropBoxData;var bL=this.options.aspectRatio;var bM=void 0;var bK=void 0;if(this.ready&&this.cropped&&!this.disabled&&u(bO)){if(Y(bO.left)){bN.left=bO.left}if(Y(bO.top)){bN.top=bO.top}if(Y(bO.width)&&bO.width!==bN.width){bM=true;bN.width=bO.width}if(Y(bO.height)&&bO.height!==bN.height){bK=true;bN.height=bO.height}if(bL){if(bM){bN.height=bN.width/bL}else{if(bK){bN.width=bN.height*bL}}}this.renderCropBox()}return this},getCroppedCanvas:function ah(){var bU=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};if(!this.ready||!window.HTMLCanvasElement){return null}var b0=this.canvasData;var b6=aV(this.image,this.imageData,b0,bU);if(!this.cropped){return b6}var bZ=this.getData(),cd=bZ.x,cc=bZ.y,bW=bZ.width,b8=bZ.height;var bY=b6.width/Math.floor(b0.naturalWidth);if(bY!==1){cd*=bY;cc*=bY;bW*=bY;b8*=bY}var bM=bW/b8;var bV=bi({aspectRatio:bM,width:bU.maxWidth||Infinity,height:bU.maxHeight||Infinity});var cb=bi({aspectRatio:bM,width:bU.minWidth||0,height:bU.minHeight||0},"cover");var bX=bi({aspectRatio:bM,width:bU.width||(bY!==1?b6.width:bW),height:bU.height||(bY!==1?b6.height:b8)}),b5=bX.width,b4=bX.height;b5=Math.min(bV.width,Math.max(cb.width,b5));b4=Math.min(bV.height,Math.max(cb.height,b4));var bT=document.createElement("canvas");var bP=bT.getContext("2d");bT.width=bb(b5);bT.height=bb(b4);bP.fillStyle=bU.fillColor||"transparent";bP.fillRect(0,0,b5,b4);var b7=bU.imageSmoothingEnabled,bL=b7===undefined?true:b7,bR=bU.imageSmoothingQuality;bP.imageSmoothingEnabled=bL;if(bR){bP.imageSmoothingQuality=bR}var b1=b6.width;var bQ=b6.height;var bK=cd;var cf=cc;var b3=void 0;var ca=void 0;var bO=void 0;var bN=void 0;var bS=void 0;var b2=void 0;if(bK<=-bW||bK>b1){bK=0;b3=0;bO=0;bS=0}else{if(bK<=0){bO=-bK;bK=0;b3=Math.min(b1,bW+bK);bS=b3}else{if(bK<=b1){bO=0;b3=Math.min(bW,b1-bK);bS=b3}}}if(b3<=0||cf<=-b8||cf>bQ){cf=0;ca=0;bN=0;b2=0}else{if(cf<=0){bN=-cf;cf=0;ca=Math.min(bQ,b8+cf);b2=ca}else{if(cf<=bQ){bN=0;ca=Math.min(b8,bQ-cf);b2=ca}}}var b9=[bK,cf,b3,ca];if(bS>0&&b2>0){var ce=b5/bW;b9.push(bO*ce,bN*ce,bS*ce,b2*ce)}bP.drawImage.apply(bP,[b6].concat(bB(b9.map(function(cg){return Math.floor(bb(cg))}))));return bT},setAspectRatio:function z(bL){var bK=this.options;if(!this.disabled&&!aF(bL)){bK.aspectRatio=Math.max(0,bL)||NaN;if(this.ready){this.initCropBox();if(this.cropped){this.renderCropBox()}}}return this},setDragMode:function V(bP){var bK=this.options,bL=this.dragBox,bM=this.face;if(this.ready&&!this.disabled){var bO=bP===aj;var bN=bK.movable&&bP===aE;bP=bO||bN?bP:al;bK.dragMode=bP;am(bL,ba,bP);aS(bL,bk,bO);aS(bL,bH,bN);if(!bK.cropBoxMovable){am(bM,ba,bP);aS(bM,bk,bO);aS(bM,bH,bN)}}return this}};var J=an.Cropper;var K=function(){function bR(bX){var bW=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};aA(this,bR);if(!bX||!aY.test(bX.tagName)){throw new Error("The first argument is required and must be an <img> or <canvas> element.")}this.element=bX;this.options=Z({},N,u(bW)&&bW);this.cropped=false;this.disabled=false;this.pointers={};this.ready=false;this.reloading=false;this.replaced=false;this.sized=false;this.sizing=false;this.init()}a(bR,[{key:"init",value:function bU(){var bY=this.element;var bX=bY.tagName.toLowerCase();var bW=void 0;if(a4(bY,G)){return}am(bY,G,this);if(bX==="img"){this.isImg=true;bW=bY.getAttribute("src")||"";this.originalUrl=bW;if(!bW){return}bW=bY.src}else{if(bX==="canvas"&&window.HTMLCanvasElement){bW=bY.toDataURL()}}this.load(bW)}},{key:"load",value:function bT(bY){var b1=this;if(!bY){return}this.url=bY;this.imageData={};var bZ=this.element,bX=this.options;if(!bX.checkOrientation||!window.ArrayBuffer){this.clone();return}if(aX.test(bY)){if(bo.test(bY)){this.read(aw(bY))}else{this.clone()}return}var b0=new XMLHttpRequest();this.reloading=true;this.xhr=b0;var bW=function bW(){b1.reloading=false;b1.xhr=null};b0.ontimeout=bW;b0.onabort=bW;b0.onerror=function(){bW();b1.clone()};b0.onload=function(){bW();b1.read(b0.response)};if(bX.checkCrossOrigin&&a6(bY)&&bZ.crossOrigin){bY=bz(bY)}b0.open("get",bY);b0.responseType="arraybuffer";b0.withCredentials=bZ.crossOrigin==="use-credentials";b0.send()}},{key:"read",value:function bM(b1){var b0=this.options,b3=this.imageData;var bX=au(b1);var bZ=0;var bY=1;var bW=1;if(bX>1){this.url=T(b1,"image/jpeg");var b2=k(bX);bZ=b2.rotate;bY=b2.scaleX;bW=b2.scaleY}if(b0.rotatable){b3.rotate=bZ}if(b0.scalable){b3.scaleX=bY;b3.scaleY=bW}this.clone()}},{key:"clone",value:function bP(){var bZ=this.element,bX=this.url;var bW=void 0;var b0=void 0;if(this.options.checkCrossOrigin&&a6(bX)){bW=bZ.crossOrigin;if(bW){b0=bX}else{bW="anonymous";b0=bz(bX)}}this.crossOrigin=bW;this.crossOriginUrl=b0;var b1=document.createElement("img");if(bW){b1.crossOrigin=bW}b1.src=b0||bX;var b2=this.start.bind(this);var bY=this.stop.bind(this);this.image=b1;this.onStart=b2;this.onStop=bY;if(this.isImg){if(bZ.complete){this.timeout=setTimeout(b2,0)}else{bg(bZ,ay,b2,{once:true})}}else{b1.onload=b2;b1.onerror=bY;v(b1,ad);bZ.parentNode.insertBefore(b1,bZ.nextSibling)}}},{key:"start",value:function bL(b0){var bZ=this;var b2=this.isImg?this.element:this.image;if(b0){b2.onload=null;b2.onerror=null}this.sizing=true;var bY=an.navigator&&/(Macintosh|iPhone|iPod|iPad).*AppleWebKit/i.test(an.navigator.userAgent);var bX=function bX(b3,b4){Z(bZ.imageData,{naturalWidth:b3,naturalHeight:b4,aspectRatio:b3/b4});bZ.sizing=false;bZ.sized=true;bZ.build()};if(b2.naturalWidth&&!bY){bX(b2.naturalWidth,b2.naturalHeight);return}var b1=document.createElement("img");var bW=document.body||document.documentElement;this.sizingImage=b1;b1.onload=function(){bX(b1.width,b1.height);if(!bY){bW.removeChild(b1)}};b1.src=b2.src;if(!bY){b1.style.cssText="left:0;max-height:none!important;max-width:none!important;min-height:0!important;min-width:0!important;opacity:0;position:absolute;top:0;z-index:-1;";bW.appendChild(b1)}}},{key:"stop",value:function bQ(){var bW=this.image;bW.onload=null;bW.onerror=null;bW.parentNode.removeChild(bW);this.image=null}},{key:"build",value:function bS(){if(!this.sized||this.ready){return}var b2=this.element,b5=this.options,bZ=this.image;var bX=b2.parentNode;var b4=document.createElement("div");b4.innerHTML=af;var bW=b4.querySelector("."+G+"-container");var bY=bW.querySelector("."+G+"-canvas");var b1=bW.querySelector("."+G+"-drag-box");var b0=bW.querySelector("."+G+"-crop-box");var b3=b0.querySelector("."+G+"-face");this.container=bX;this.cropper=bW;this.canvas=bY;this.dragBox=b1;this.cropBox=b0;this.viewBox=bW.querySelector("."+G+"-view-box");this.face=b3;bY.appendChild(bZ);v(b2,h);bX.insertBefore(bW,b2.nextSibling);if(!this.isImg){aU(bZ,ad)}this.initPreview();this.bind();b5.aspectRatio=Math.max(0,b5.aspectRatio)||NaN;b5.viewMode=Math.max(0,Math.min(3,Math.round(b5.viewMode)))||0;v(b0,h);if(!b5.guides){v(b0.getElementsByClassName(G+"-dashed"),h)}if(!b5.center){v(b0.getElementsByClassName(G+"-center"),h)}if(b5.background){v(bW,G+"-bg")}if(!b5.highlight){v(b3,ac)}if(b5.cropBoxMovable){v(b3,bH);am(b3,ba,X)}if(!b5.cropBoxResizable){v(b0.getElementsByClassName(G+"-line"),h);v(b0.getElementsByClassName(G+"-point"),h)}this.render();this.ready=true;this.setDragMode(b5.dragMode);if(b5.autoCrop){this.crop()}this.setData(b5.data);if(n(b5.ready)){bg(b2,ae,b5.ready,{once:true})}aJ(b2,ae)}},{key:"unbuild",value:function bV(){if(!this.ready){return}this.ready=false;this.unbind();this.resetPreview();this.cropper.parentNode.removeChild(this.cropper);aU(this.element,h)}},{key:"uncreate",value:function bK(){var bW=this.element;if(this.ready){this.unbuild();this.ready=false;this.cropped=false}else{if(this.sizing){this.sizingImage.onload=null;this.sizing=false;this.sized=false}else{if(this.reloading){this.xhr.abort()}else{if(this.isImg){if(bW.complete){clearTimeout(this.timeout)}else{j(bW,ay,this.onStart)}}else{if(this.image){this.stop()}}}}}}}],[{key:"noConflict",value:function bN(){window.Cropper=J;return bR}},{key:"setDefaults",value:function bO(bW){Z(N,u(bW)&&bW)}}]);return bR}();Z(K.prototype,R,b,bA,aT,aD,ao);return K})));