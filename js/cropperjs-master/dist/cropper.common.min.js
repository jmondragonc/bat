/*!
 * Cropper.js v1.3.1
 * https://github.com/fengyuanchen/cropperjs
 *
 * Copyright (c) 2015-2018 Chen Fengyuan
 * Released under the MIT license
 *
 * Date: 2018-02-28T13:25:11.920Z
 */
;"use strict";var WINDOW=typeof window!=="undefined"?window:{};var NAMESPACE="cropper";var ACTION_ALL="all";var ACTION_CROP="crop";var ACTION_MOVE="move";var ACTION_ZOOM="zoom";var ACTION_EAST="e";var ACTION_WEST="w";var ACTION_SOUTH="s";var ACTION_NORTH="n";var ACTION_NORTH_EAST="ne";var ACTION_NORTH_WEST="nw";var ACTION_SOUTH_EAST="se";var ACTION_SOUTH_WEST="sw";var CLASS_CROP=NAMESPACE+"-crop";var CLASS_DISABLED=NAMESPACE+"-disabled";var CLASS_HIDDEN=NAMESPACE+"-hidden";var CLASS_HIDE=NAMESPACE+"-hide";var CLASS_INVISIBLE=NAMESPACE+"-invisible";var CLASS_MODAL=NAMESPACE+"-modal";var CLASS_MOVE=NAMESPACE+"-move";var DATA_ACTION="action";var DATA_PREVIEW="preview";var DRAG_MODE_CROP="crop";var DRAG_MODE_MOVE="move";var DRAG_MODE_NONE="none";var EVENT_CROP="crop";var EVENT_CROP_END="cropend";var EVENT_CROP_MOVE="cropmove";var EVENT_CROP_START="cropstart";var EVENT_DBLCLICK="dblclick";var EVENT_LOAD="load";var EVENT_POINTER_DOWN=WINDOW.PointerEvent?"pointerdown":"touchstart mousedown";var EVENT_POINTER_MOVE=WINDOW.PointerEvent?"pointermove":"touchmove mousemove";var EVENT_POINTER_UP=WINDOW.PointerEvent?"pointerup pointercancel":"touchend touchcancel mouseup";var EVENT_READY="ready";var EVENT_RESIZE="resize";var EVENT_WHEEL="wheel mousewheel DOMMouseScroll";var EVENT_ZOOM="zoom";var REGEXP_ACTIONS=/^(?:e|w|s|n|se|sw|ne|nw|all|crop|move|zoom)$/;var REGEXP_DATA_URL=/^data:/;var REGEXP_DATA_URL_JPEG=/^data:image\/jpeg;base64,/;var REGEXP_TAG_NAME=/^(?:img|canvas)$/i;var DEFAULTS={viewMode:0,dragMode:DRAG_MODE_CROP,aspectRatio:NaN,data:null,preview:"",responsive:true,restore:true,checkCrossOrigin:true,checkOrientation:true,modal:true,guides:true,center:true,highlight:true,background:true,autoCrop:true,autoCropArea:0.8,movable:true,rotatable:true,scalable:true,zoomable:true,zoomOnTouch:true,zoomOnWheel:true,wheelZoomRatio:0.1,cropBoxMovable:true,cropBoxResizable:true,toggleDragModeOnDblclick:true,minCanvasWidth:0,minCanvasHeight:0,minCropBoxWidth:0,minCropBoxHeight:0,minContainerWidth:200,minContainerHeight:100,ready:null,cropstart:null,cropmove:null,cropend:null,crop:null,zoom:null};var TEMPLATE='<div class="cropper-container" touch-action="none"><div class="cropper-wrap-box"><div class="cropper-canvas"></div></div><div class="cropper-drag-box"></div><div class="cropper-crop-box"><span class="cropper-view-box"></span><span class="cropper-dashed dashed-h"></span><span class="cropper-dashed dashed-v"></span><span class="cropper-center"></span><span class="cropper-face"></span><span class="cropper-line line-e" data-action="e"></span><span class="cropper-line line-n" data-action="n"></span><span class="cropper-line line-w" data-action="w"></span><span class="cropper-line line-s" data-action="s"></span><span class="cropper-point point-e" data-action="e"></span><span class="cropper-point point-n" data-action="n"></span><span class="cropper-point point-w" data-action="w"></span><span class="cropper-point point-s" data-action="s"></span><span class="cropper-point point-ne" data-action="ne"></span><span class="cropper-point point-nw" data-action="nw"></span><span class="cropper-point point-sw" data-action="sw"></span><span class="cropper-point point-se" data-action="se"></span></div></div>';var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(a){return typeof a}:function(a){return a&&typeof Symbol==="function"&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a};var classCallCheck=function(a,b){if(!(a instanceof b)){throw new TypeError("Cannot call a class as a function")}};var createClass=function(){function a(e,c){for(var b=0;b<c.length;b++){var d=c[b];d.enumerable=d.enumerable||false;d.configurable=true;if("value" in d){d.writable=true}Object.defineProperty(e,d.key,d)}}return function(d,b,c){if(b){a(d.prototype,b)}if(c){a(d,c)}return d}}();var toConsumableArray=function(a){if(Array.isArray(a)){for(var c=0,b=Array(a.length);c<a.length;c++){b[c]=a[c]}return b}else{return Array.from(a)}};var isNaN=Number.isNaN||WINDOW.isNaN;function isNumber(a){return typeof a==="number"&&!isNaN(a)}function isUndefined(a){return typeof a==="undefined"}function isObject(a){return(typeof a==="undefined"?"undefined":_typeof(a))==="object"&&a!==null}var hasOwnProperty=Object.prototype.hasOwnProperty;function isPlainObject(b){if(!isObject(b)){return false}try{var d=b.constructor;var a=d.prototype;return d&&a&&hasOwnProperty.call(a,"isPrototypeOf")}catch(c){return false}}function isFunction(a){return typeof a==="function"}function forEach(c,d){if(c&&isFunction(d)){if(Array.isArray(c)||isNumber(c.length)){var b=c.length;var a=void 0;for(a=0;a<b;a+=1){if(d.call(c,c[a],a,c)===false){break}}}else{if(isObject(c)){Object.keys(c).forEach(function(e){d.call(c,c[e],e,c)})}}}return c}var assign=Object.assign||function assign(d){for(var a=arguments.length,b=Array(a>1?a-1:0),c=1;c<a;c++){b[c-1]=arguments[c]}if(isObject(d)&&b.length>0){b.forEach(function(e){if(isObject(e)){Object.keys(e).forEach(function(f){d[f]=e[f]})}})}return d};var REGEXP_DECIMALS=/\.\d*(?:0|9){12}\d*$/i;function normalizeDecimalNumber(a){var b=arguments.length>1&&arguments[1]!==undefined?arguments[1]:100000000000;return REGEXP_DECIMALS.test(a)?Math.round(a*b)/b:a}var REGEXP_SUFFIX=/^(?:width|height|left|top|marginLeft|marginTop)$/;function setStyle(a,c){var b=a.style;forEach(c,function(e,d){if(REGEXP_SUFFIX.test(d)&&isNumber(e)){e+="px"}b[d]=e})}function hasClass(a,b){return a.classList?a.classList.contains(b):a.className.indexOf(b)>-1}function addClass(a,c){if(!c){return}if(isNumber(a.length)){forEach(a,function(d){addClass(d,c)});return}if(a.classList){a.classList.add(c);return}var b=a.className.trim();if(!b){a.className=c}else{if(b.indexOf(c)<0){a.className=b+" "+c}}}function removeClass(a,b){if(!b){return}if(isNumber(a.length)){forEach(a,function(c){removeClass(c,b)});return}if(a.classList){a.classList.remove(b);return}if(a.className.indexOf(b)>=0){a.className=a.className.replace(b,"")}}function toggleClass(a,c,b){if(!c){return}if(isNumber(a.length)){forEach(a,function(d){toggleClass(d,c,b)});return}if(b){addClass(a,c)}else{removeClass(a,c)}}var REGEXP_HYPHENATE=/([a-z\d])([A-Z])/g;function hyphenate(a){return a.replace(REGEXP_HYPHENATE,"$1-$2").toLowerCase()}function getData(b,a){if(isObject(b[a])){return b[a]}else{if(b.dataset){return b.dataset[a]}}return b.getAttribute("data-"+hyphenate(a))}function setData(b,a,c){if(isObject(c)){b[a]=c}else{if(b.dataset){b.dataset[a]=c}else{b.setAttribute("data-"+hyphenate(a),c)}}}function removeData(b,a){if(isObject(b[a])){try{delete b[a]}catch(c){b[a]=undefined}}else{if(b.dataset){try{delete b.dataset[a]}catch(c){b.dataset[a]=undefined}}else{b.removeAttribute("data-"+hyphenate(a))}}}var REGEXP_SPACES=/\s\s*/;function removeListener(b,c,d){var a=arguments.length>3&&arguments[3]!==undefined?arguments[3]:{};forEach(c.trim().split(REGEXP_SPACES),function(e){b.removeEventListener(e,d,a)})}function addListener(c,d,f){var b=arguments.length>3&&arguments[3]!==undefined?arguments[3]:{};if(b.once){var a=f;f=function e(){for(var g=arguments.length,i=Array(g),h=0;h<g;h++){i[h]=arguments[h]}removeListener(c,d,f,b);return a.apply(c,i)}}forEach(d.trim().split(REGEXP_SPACES),function(g){c.addEventListener(g,f,b)})}function dispatchEvent(a,b,d){var c=void 0;if(isFunction(Event)&&isFunction(CustomEvent)){c=new CustomEvent(b,{detail:d,bubbles:true,cancelable:true})}else{c=document.createEvent("CustomEvent");c.initCustomEvent(b,true,true,d)}return a.dispatchEvent(c)}function getOffset(a){var b=a.getBoundingClientRect();return{left:b.left+(window.pageXOffset-document.documentElement.clientLeft),top:b.top+(window.pageYOffset-document.documentElement.clientTop)}}var location=WINDOW.location;var REGEXP_ORIGINS=/^(https?:)\/\/([^:/?#]+):?(\d*)/i;function isCrossOriginURL(a){var b=a.match(REGEXP_ORIGINS);return b&&(b[1]!==location.protocol||b[2]!==location.hostname||b[3]!==location.port)}function addTimestamp(a){var b="timestamp="+new Date().getTime();return a+(a.indexOf("?")===-1?"?":"&")+b}function getTransforms(f){var e=f.rotate,d=f.scaleX,b=f.scaleY,h=f.translateX,g=f.translateY;var a=[];if(isNumber(h)&&h!==0){a.push("translateX("+h+"px)")}if(isNumber(g)&&g!==0){a.push("translateY("+g+"px)")}if(isNumber(e)&&e!==0){a.push("rotate("+e+"deg)")}if(isNumber(d)&&d!==1){a.push("scaleX("+d+")")}if(isNumber(b)&&b!==1){a.push("scaleY("+b+")")}var c=a.length?a.join(" "):"none";return{WebkitTransform:c,msTransform:c,transform:c}}function getMaxZoomRatio(a){var c=assign({},a);var b=[];forEach(a,function(e,d){delete c[d];forEach(c,function(f){var h=Math.abs(e.startX-f.startX);var k=Math.abs(e.startY-f.startY);var g=Math.abs(e.endX-f.endX);var i=Math.abs(e.endY-f.endY);var m=Math.sqrt(h*h+k*k);var l=Math.sqrt(g*g+i*i);var j=(l-m)/m;b.push(j)})});b.sort(function(e,d){return Math.abs(e)<Math.abs(d)});return b[0]}function getPointer(e,d){var c=e.pageX,b=e.pageY;var a={endX:c,endY:b};return d?a:assign({startX:c,startY:b},a)}function getPointersCenter(a){var c=0;var b=0;var d=0;forEach(a,function(g){var f=g.startX,e=g.startY;c+=f;b+=e;d+=1});c/=d;b/=d;return{pageX:c,pageY:b}}var isFinite=Number.isFinite||WINDOW.isFinite;function getAdjustedSizes(g){var f=g.aspectRatio,a=g.height,e=g.width;var d=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"contain";var b=function b(h){return isFinite(h)&&h>0};if(b(e)&&b(a)){var c=a*f;if(d==="contain"&&c>e||d==="cover"&&c<e){a=e/f}else{e=a*f}}else{if(b(e)){a=e/f}else{if(b(a)){e=a*f}}}return{width:e,height:a}}function getRotatedSizes(d){var b=d.width,i=d.height,e=d.degree;e=Math.abs(e)%180;if(e===90){return{width:i,height:b}}var c=e%90*Math.PI/180;var g=Math.sin(c);var h=Math.cos(c);var f=b*h+i*g;var a=b*g+i*h;return e>90?{width:a,height:f}:{width:f,height:a}}function getSourceCanvas(s,d,a,H){var o=d.rotate,y=o===undefined?0:o,u=d.scaleX,E=u===undefined?1:u,t=d.scaleY,C=t===undefined?1:t;var b=a.aspectRatio,h=a.naturalWidth,f=a.naturalHeight;var n=H.fillColor,l=n===undefined?"transparent":n,k=H.imageSmoothingEnabled,c=k===undefined?true:k,F=H.imageSmoothingQuality,g=F===undefined?"low":F,G=H.maxWidth,z=G===undefined?Infinity:G,A=H.maxHeight,w=A===undefined?Infinity:A,x=H.minWidth,q=x===undefined?0:x,p=H.minHeight,m=p===undefined?0:p;var i=document.createElement("canvas");var e=i.getContext("2d");var j=getAdjustedSizes({aspectRatio:b,width:z,height:w});var D=getAdjustedSizes({aspectRatio:b,width:q,height:m},"cover");var v=Math.min(j.width,Math.max(D.width,h));var r=Math.min(j.height,Math.max(D.height,f));var B=[-v/2,-r/2,v,r];i.width=normalizeDecimalNumber(v);i.height=normalizeDecimalNumber(r);e.fillStyle=l;e.fillRect(0,0,v,r);e.save();e.translate(v/2,r/2);e.rotate(y*Math.PI/180);e.scale(E,C);e.imageSmoothingEnabled=c;e.imageSmoothingQuality=g;e.drawImage.apply(e,[s].concat(toConsumableArray(B.map(function(I){return Math.floor(normalizeDecimalNumber(I))}))));e.restore();return i}var fromCharCode=String.fromCharCode;function getStringFromCharCode(d,e,b){var c="";var a=void 0;b+=e;for(a=e;a<b;a+=1){c+=fromCharCode(d.getUint8(a))}return c}var REGEXP_DATA_URL_HEAD=/^data:.*,/;function dataURLToArrayBuffer(d){var b=d.replace(REGEXP_DATA_URL_HEAD,"");var e=atob(b);var c=new ArrayBuffer(e.length);var a=new Uint8Array(c);forEach(a,function(g,f){a[f]=e.charCodeAt(f)});return c}function arrayBufferToDataURL(b,d){var a=new Uint8Array(b);var c="";forEach(a,function(e){c+=fromCharCode(e)});return"data:"+d+";base64,"+btoa(c)}function getOrientation(h){var m=new DataView(h);var c=void 0;var b=void 0;var g=void 0;var p=void 0;if(m.getUint8(0)===255&&m.getUint8(1)===216){var d=m.byteLength;var e=2;while(e<d){if(m.getUint8(e)===255&&m.getUint8(e+1)===225){g=e;break}e+=1}}if(g){var o=g+4;var l=g+10;if(getStringFromCharCode(m,o,4)==="Exif"){var k=m.getUint16(l);b=k===18761;if(b||k===19789){if(m.getUint16(l+2,b)===42){var a=m.getUint32(l+4,b);if(a>=8){p=l+a}}}}}if(p){var j=m.getUint16(p,b);var n=void 0;var f=void 0;for(f=0;f<j;f+=1){n=p+f*12+2;if(m.getUint16(n,b)===274){n+=8;c=m.getUint16(n,b);m.setUint16(n,1,b);break}}}return c}function parseOrientation(b){var d=0;var c=1;var a=1;switch(b){case 2:c=-1;break;case 3:d=-180;break;case 4:a=-1;break;case 5:d=90;a=-1;break;case 6:d=90;break;case 7:d=90;c=-1;break;case 8:d=-90;break;default:}return{rotate:d,scaleX:c,scaleY:a}}var render={render:function render(){this.initContainer();this.initCanvas();this.initCropBox();this.renderCanvas();if(this.cropped){this.renderCropBox()}},initContainer:function initContainer(){var d=this.element,c=this.options,b=this.container,e=this.cropper;addClass(e,CLASS_HIDDEN);removeClass(d,CLASS_HIDDEN);var a={width:Math.max(b.offsetWidth,Number(c.minContainerWidth)||200),height:Math.max(b.offsetHeight,Number(c.minContainerHeight)||100)};this.containerData=a;setStyle(e,{width:a.width,height:a.height});addClass(d,CLASS_HIDDEN);removeClass(e,CLASS_HIDDEN)},initCanvas:function initCanvas(){var h=this.containerData,a=this.imageData;var c=this.options.viewMode;var b=Math.abs(a.rotate)%180===90;var g=b?a.naturalHeight:a.naturalWidth;var i=b?a.naturalWidth:a.naturalHeight;var j=g/i;var d=h.width;var f=h.height;if(h.height*j>h.width){if(c===3){d=h.height*j}else{f=h.width/j}}else{if(c===3){f=h.width/j}else{d=h.height*j}}var e={aspectRatio:j,naturalWidth:g,naturalHeight:i,width:d,height:f};e.left=(h.width-d)/2;e.top=(h.height-f)/2;e.oldLeft=e.left;e.oldTop=e.top;this.canvasData=e;this.limited=c===1||c===2;this.limitCanvas(true,true);this.initialImageData=assign({},a);this.initialCanvasData=assign({},e)},limitCanvas:function limitCanvas(a,f){var n=this.options,h=this.containerData,g=this.canvasData,d=this.cropBoxData;var e=n.viewMode;var l=g.aspectRatio;var k=this.cropped&&d;if(a){var m=Number(n.minCanvasWidth)||0;var i=Number(n.minCanvasHeight)||0;if(e>1){m=Math.max(m,h.width);i=Math.max(i,h.height);if(e===3){if(i*l>m){m=i*l}else{i=m/l}}}else{if(e>0){if(m){m=Math.max(m,k?d.width:0)}else{if(i){i=Math.max(i,k?d.height:0)}else{if(k){m=d.width;i=d.height;if(i*l>m){m=i*l}else{i=m/l}}}}}}var b=getAdjustedSizes({aspectRatio:l,width:m,height:i});m=b.width;i=b.height;g.minWidth=m;g.minHeight=i;g.maxWidth=Infinity;g.maxHeight=Infinity}if(f){if(e){var c=h.width-g.width;var j=h.height-g.height;g.minLeft=Math.min(0,c);g.minTop=Math.min(0,j);g.maxLeft=Math.max(0,c);g.maxTop=Math.max(0,j);if(k&&this.limited){g.minLeft=Math.min(d.left,d.left+(d.width-g.width));g.minTop=Math.min(d.top,d.top+(d.height-g.height));g.maxLeft=d.left;g.maxTop=d.top;if(e===2){if(g.width>=h.width){g.minLeft=Math.min(0,c);g.maxLeft=Math.max(0,c)}if(g.height>=h.height){g.minTop=Math.min(0,j);g.maxTop=Math.max(0,j)}}}}else{g.minLeft=-g.width;g.minTop=-g.height;g.maxLeft=h.width;g.maxTop=h.height}}},renderCanvas:function renderCanvas(f,d){var e=this.canvasData,a=this.imageData;if(d){var c=getRotatedSizes({width:a.naturalWidth*Math.abs(a.scaleX||1),height:a.naturalHeight*Math.abs(a.scaleY||1),degree:a.rotate||0}),g=c.width,h=c.height;var b=e.width*(g/e.naturalWidth);var i=e.height*(h/e.naturalHeight);e.left-=(b-e.width)/2;e.top-=(i-e.height)/2;e.width=b;e.height=i;e.aspectRatio=g/h;e.naturalWidth=g;e.naturalHeight=h;this.limitCanvas(true,false)}if(e.width>e.maxWidth||e.width<e.minWidth){e.left=e.oldLeft}if(e.height>e.maxHeight||e.height<e.minHeight){e.top=e.oldTop}e.width=Math.min(Math.max(e.width,e.minWidth),e.maxWidth);e.height=Math.min(Math.max(e.height,e.minHeight),e.maxHeight);this.limitCanvas(false,true);e.left=Math.min(Math.max(e.left,e.minLeft),e.maxLeft);e.top=Math.min(Math.max(e.top,e.minTop),e.maxTop);e.oldLeft=e.left;e.oldTop=e.top;setStyle(this.canvas,assign({width:e.width,height:e.height},getTransforms({translateX:e.left,translateY:e.top})));this.renderImage(f);if(this.cropped&&this.limited){this.limitCropBox(true,true)}},renderImage:function renderImage(d){var b=this.canvasData,e=this.imageData;var c=e.naturalWidth*(b.width/b.naturalWidth);var a=e.naturalHeight*(b.height/b.naturalHeight);assign(e,{width:c,height:a,left:(b.width-c)/2,top:(b.height-a)/2});setStyle(this.image,assign({width:e.width,height:e.height},getTransforms(assign({translateX:e.left,translateY:e.top},e))));if(d){this.output()}},initCropBox:function initCropBox(){var b=this.options,a=this.canvasData;var c=b.aspectRatio;var e=Number(b.autoCropArea)||0.8;var d={width:a.width,height:a.height};if(c){if(a.height*c>a.width){d.height=d.width/c}else{d.width=d.height*c}}this.cropBoxData=d;this.limitCropBox(true,true);d.width=Math.min(Math.max(d.width,d.minWidth),d.maxWidth);d.height=Math.min(Math.max(d.height,d.minHeight),d.maxHeight);d.width=Math.max(d.minWidth,d.width*e);d.height=Math.max(d.minHeight,d.height*e);d.left=a.left+(a.width-d.width)/2;d.top=a.top+(a.height-d.height)/2;d.oldLeft=d.left;d.oldTop=d.top;this.initialCropBoxData=assign({},d)},limitCropBox:function limitCropBox(a,d){var l=this.options,f=this.containerData,e=this.canvasData,c=this.cropBoxData,i=this.limited;var k=l.aspectRatio;if(a){var b=Number(l.minCropBoxWidth)||0;var g=Number(l.minCropBoxHeight)||0;var h=Math.min(f.width,i?e.width:f.width);var j=Math.min(f.height,i?e.height:f.height);b=Math.min(b,f.width);g=Math.min(g,f.height);if(k){if(b&&g){if(g*k>b){g=b/k}else{b=g*k}}else{if(b){g=b/k}else{if(g){b=g*k}}}if(j*k>h){j=h/k}else{h=j*k}}c.minWidth=Math.min(b,h);c.minHeight=Math.min(g,j);c.maxWidth=h;c.maxHeight=j}if(d){if(i){c.minLeft=Math.max(0,e.left);c.minTop=Math.max(0,e.top);c.maxLeft=Math.min(f.width,e.left+e.width)-c.width;c.maxTop=Math.min(f.height,e.top+e.height)-c.height}else{c.minLeft=0;c.minTop=0;c.maxLeft=f.width-c.width;c.maxTop=f.height-c.height}}},renderCropBox:function renderCropBox(){var b=this.options,a=this.containerData,c=this.cropBoxData;if(c.width>c.maxWidth||c.width<c.minWidth){c.left=c.oldLeft}if(c.height>c.maxHeight||c.height<c.minHeight){c.top=c.oldTop}c.width=Math.min(Math.max(c.width,c.minWidth),c.maxWidth);c.height=Math.min(Math.max(c.height,c.minHeight),c.maxHeight);this.limitCropBox(false,true);c.left=Math.min(Math.max(c.left,c.minLeft),c.maxLeft);c.top=Math.min(Math.max(c.top,c.minTop),c.maxTop);c.oldLeft=c.left;c.oldTop=c.top;if(b.movable&&b.cropBoxMovable){setData(this.face,DATA_ACTION,c.width>=a.width&&c.height>=a.height?ACTION_MOVE:ACTION_ALL)}setStyle(this.cropBox,assign({width:c.width,height:c.height},getTransforms({translateX:c.left,translateY:c.top})));if(this.cropped&&this.limited){this.limitCanvas(true,true)}if(!this.disabled){this.output()}},output:function output(){this.preview();dispatchEvent(this.element,EVENT_CROP,this.getData())}};var preview={initPreview:function initPreview(){var a=this.crossOrigin;var e=this.options.preview;var b=a?this.crossOriginUrl:this.url;var d=document.createElement("img");if(a){d.crossOrigin=a}d.src=b;this.viewBox.appendChild(d);this.viewBoxImage=d;if(!e){return}var c=e;if(typeof e==="string"){c=this.element.ownerDocument.querySelectorAll(e)}else{if(e.querySelector){c=[e]}}this.previews=c;forEach(c,function(g){var f=document.createElement("img");setData(g,DATA_PREVIEW,{width:g.offsetWidth,height:g.offsetHeight,html:g.innerHTML});if(a){f.crossOrigin=a}f.src=b;f.style.cssText='display:block;width:100%;height:auto;min-width:0!important;min-height:0!important;max-width:none!important;max-height:none!important;image-orientation:0deg!important;"';g.innerHTML="";g.appendChild(f)})},resetPreview:function resetPreview(){forEach(this.previews,function(a){var b=getData(a,DATA_PREVIEW);setStyle(a,{width:b.width,height:b.height});a.innerHTML=b.html;removeData(a,DATA_PREVIEW)})},preview:function preview(){var a=this.imageData,f=this.canvasData,d=this.cropBoxData;var b=d.width,g=d.height;var c=a.width,i=a.height;var e=d.left-f.left-a.left;var h=d.top-f.top-a.top;if(!this.cropped||this.disabled){return}setStyle(this.viewBoxImage,assign({width:c,height:i},getTransforms(assign({translateX:-e,translateY:-h},a))));forEach(this.previews,function(k){var o=getData(k,DATA_PREVIEW);var p=o.width;var n=o.height;var m=p;var j=n;var l=1;if(b){l=p/b;j=g*l}if(g&&j>n){l=n/g;m=b*l;j=n}setStyle(k,{width:m,height:j});setStyle(k.getElementsByTagName("img")[0],assign({width:c*l,height:i*l},getTransforms(assign({translateX:-e*l,translateY:-h*l},a))))})}};var events={bind:function bind(){var b=this.element,a=this.options,c=this.cropper;if(isFunction(a.cropstart)){addListener(b,EVENT_CROP_START,a.cropstart)}if(isFunction(a.cropmove)){addListener(b,EVENT_CROP_MOVE,a.cropmove)}if(isFunction(a.cropend)){addListener(b,EVENT_CROP_END,a.cropend)}if(isFunction(a.crop)){addListener(b,EVENT_CROP,a.crop)}if(isFunction(a.zoom)){addListener(b,EVENT_ZOOM,a.zoom)}addListener(c,EVENT_POINTER_DOWN,this.onCropStart=this.cropStart.bind(this));if(a.zoomable&&a.zoomOnWheel){addListener(c,EVENT_WHEEL,this.onWheel=this.wheel.bind(this))}if(a.toggleDragModeOnDblclick){addListener(c,EVENT_DBLCLICK,this.onDblclick=this.dblclick.bind(this))}addListener(b.ownerDocument,EVENT_POINTER_MOVE,this.onCropMove=this.cropMove.bind(this));addListener(b.ownerDocument,EVENT_POINTER_UP,this.onCropEnd=this.cropEnd.bind(this));if(a.responsive){addListener(window,EVENT_RESIZE,this.onResize=this.resize.bind(this))}},unbind:function unbind(){var b=this.element,a=this.options,c=this.cropper;if(isFunction(a.cropstart)){removeListener(b,EVENT_CROP_START,a.cropstart)}if(isFunction(a.cropmove)){removeListener(b,EVENT_CROP_MOVE,a.cropmove)}if(isFunction(a.cropend)){removeListener(b,EVENT_CROP_END,a.cropend)}if(isFunction(a.crop)){removeListener(b,EVENT_CROP,a.crop)}if(isFunction(a.zoom)){removeListener(b,EVENT_ZOOM,a.zoom)}removeListener(c,EVENT_POINTER_DOWN,this.onCropStart);if(a.zoomable&&a.zoomOnWheel){removeListener(c,EVENT_WHEEL,this.onWheel)}if(a.toggleDragModeOnDblclick){removeListener(c,EVENT_DBLCLICK,this.onDblclick)}removeListener(b.ownerDocument,EVENT_POINTER_MOVE,this.onCropMove);removeListener(b.ownerDocument,EVENT_POINTER_UP,this.onCropEnd);if(a.responsive){removeListener(window,EVENT_RESIZE,this.onResize)}}};var handlers={resize:function resize(){var e=this.options,b=this.container,a=this.containerData;var h=Number(e.minContainerWidth)||200;var c=Number(e.minContainerHeight)||100;if(this.disabled||a.width<=h||a.height<=c){return}var f=b.offsetWidth/a.width;if(f!==1||b.offsetHeight!==a.height){var d=void 0;var g=void 0;if(e.restore){d=this.getCanvasData();g=this.getCropBoxData()}this.render();if(e.restore){this.setCanvasData(forEach(d,function(k,j){d[j]=k*f}));this.setCropBoxData(forEach(g,function(k,j){g[j]=k*f}))}}},dblclick:function dblclick(){if(this.disabled||this.options.dragMode===DRAG_MODE_NONE){return}this.setDragMode(hasClass(this.dragBox,CLASS_CROP)?DRAG_MODE_MOVE:DRAG_MODE_CROP)},wheel:function wheel(b){var d=this;var a=Number(this.options.wheelZoomRatio)||0.1;var c=1;if(this.disabled){return}b.preventDefault();if(this.wheeling){return}this.wheeling=true;setTimeout(function(){d.wheeling=false},50);if(b.deltaY){c=b.deltaY>0?1:-1}else{if(b.wheelDelta){c=-b.wheelDelta/120}else{if(b.detail){c=b.detail>0?1:-1}}}this.zoom(-c*a,b)},cropStart:function cropStart(d){if(this.disabled){return}var b=this.options,a=this.pointers;var c=void 0;if(d.changedTouches){forEach(d.changedTouches,function(e){a[e.identifier]=getPointer(e)})}else{a[d.pointerId||0]=getPointer(d)}if(Object.keys(a).length>1&&b.zoomable&&b.zoomOnTouch){c=ACTION_ZOOM}else{c=getData(d.target,DATA_ACTION)}if(!REGEXP_ACTIONS.test(c)){return}if(dispatchEvent(this.element,EVENT_CROP_START,{originalEvent:d,action:c})===false){return}d.preventDefault();this.action=c;this.cropping=false;if(c===ACTION_CROP){this.cropping=true;addClass(this.dragBox,CLASS_MODAL)}},cropMove:function cropMove(c){var b=this.action;if(this.disabled||!b){return}var a=this.pointers;c.preventDefault();if(dispatchEvent(this.element,EVENT_CROP_MOVE,{originalEvent:c,action:b})===false){return}if(c.changedTouches){forEach(c.changedTouches,function(d){assign(a[d.identifier],getPointer(d,true))})}else{assign(a[c.pointerId||0],getPointer(c,true))}this.change(c)},cropEnd:function cropEnd(c){if(this.disabled){return}var b=this.action,a=this.pointers;if(c.changedTouches){forEach(c.changedTouches,function(d){delete a[d.identifier]})}else{delete a[c.pointerId||0]}if(!b){return}c.preventDefault();if(!Object.keys(a).length){this.action=""}if(this.cropping){this.cropping=false;toggleClass(this.dragBox,CLASS_MODAL,this.cropped&&this.options.modal)}dispatchEvent(this.element,EVENT_CROP_END,{originalEvent:c,action:b})}};var change={change:function change(v){var c=this.options,j=this.canvasData,b=this.containerData,o=this.cropBoxData,i=this.pointers;var t=this.action;var a=c.aspectRatio;var d=o.left,l=o.top,r=o.width,m=o.height;var x=d+r;var g=l+m;var n=0;var h=0;var u=b.width;var q=b.height;var p=true;var f=void 0;if(!a&&v.shiftKey){a=r&&m?r/m:1}if(this.limited){n=o.minLeft;h=o.minTop;u=n+Math.min(b.width,j.width,j.left+j.width);q=h+Math.min(b.height,j.height,j.top+j.height)}var s=i[Object.keys(i)[0]];var k={x:s.endX-s.startX,y:s.endY-s.startY};var w=function w(e){switch(e){case ACTION_EAST:if(x+k.x>u){k.x=u-x}break;case ACTION_WEST:if(d+k.x<n){k.x=n-d}break;case ACTION_NORTH:if(l+k.y<h){k.y=h-l}break;case ACTION_SOUTH:if(g+k.y>q){k.y=q-g}break;default:}};switch(t){case ACTION_ALL:d+=k.x;l+=k.y;break;case ACTION_EAST:if(k.x>=0&&(x>=u||a&&(l<=h||g>=q))){p=false;break}w(ACTION_EAST);r+=k.x;if(a){m=r/a;l-=k.x/a/2}if(r<0){t=ACTION_WEST;r=0}break;case ACTION_NORTH:if(k.y<=0&&(l<=h||a&&(d<=n||x>=u))){p=false;break}w(ACTION_NORTH);m-=k.y;l+=k.y;if(a){r=m*a;d+=k.y*a/2}if(m<0){t=ACTION_SOUTH;m=0}break;case ACTION_WEST:if(k.x<=0&&(d<=n||a&&(l<=h||g>=q))){p=false;break}w(ACTION_WEST);r-=k.x;d+=k.x;if(a){m=r/a;l+=k.x/a/2}if(r<0){t=ACTION_EAST;r=0}break;case ACTION_SOUTH:if(k.y>=0&&(g>=q||a&&(d<=n||x>=u))){p=false;break}w(ACTION_SOUTH);m+=k.y;if(a){r=m*a;d-=k.y*a/2}if(m<0){t=ACTION_NORTH;m=0}break;case ACTION_NORTH_EAST:if(a){if(k.y<=0&&(l<=h||x>=u)){p=false;break}w(ACTION_NORTH);m-=k.y;l+=k.y;r=m*a}else{w(ACTION_NORTH);w(ACTION_EAST);if(k.x>=0){if(x<u){r+=k.x}else{if(k.y<=0&&l<=h){p=false}}}else{r+=k.x}if(k.y<=0){if(l>h){m-=k.y;l+=k.y}}else{m-=k.y;l+=k.y}}if(r<0&&m<0){t=ACTION_SOUTH_WEST;m=0;r=0}else{if(r<0){t=ACTION_NORTH_WEST;r=0}else{if(m<0){t=ACTION_SOUTH_EAST;m=0}}}break;case ACTION_NORTH_WEST:if(a){if(k.y<=0&&(l<=h||d<=n)){p=false;break}w(ACTION_NORTH);m-=k.y;l+=k.y;r=m*a;d+=k.y*a}else{w(ACTION_NORTH);w(ACTION_WEST);if(k.x<=0){if(d>n){r-=k.x;d+=k.x}else{if(k.y<=0&&l<=h){p=false}}}else{r-=k.x;d+=k.x}if(k.y<=0){if(l>h){m-=k.y;l+=k.y}}else{m-=k.y;l+=k.y}}if(r<0&&m<0){t=ACTION_SOUTH_EAST;m=0;r=0}else{if(r<0){t=ACTION_NORTH_EAST;r=0}else{if(m<0){t=ACTION_SOUTH_WEST;m=0}}}break;case ACTION_SOUTH_WEST:if(a){if(k.x<=0&&(d<=n||g>=q)){p=false;break}w(ACTION_WEST);r-=k.x;d+=k.x;m=r/a}else{w(ACTION_SOUTH);w(ACTION_WEST);if(k.x<=0){if(d>n){r-=k.x;d+=k.x}else{if(k.y>=0&&g>=q){p=false}}}else{r-=k.x;d+=k.x}if(k.y>=0){if(g<q){m+=k.y}}else{m+=k.y}}if(r<0&&m<0){t=ACTION_NORTH_EAST;m=0;r=0}else{if(r<0){t=ACTION_SOUTH_EAST;r=0}else{if(m<0){t=ACTION_NORTH_WEST;m=0}}}break;case ACTION_SOUTH_EAST:if(a){if(k.x>=0&&(x>=u||g>=q)){p=false;break}w(ACTION_EAST);r+=k.x;m=r/a}else{w(ACTION_SOUTH);w(ACTION_EAST);if(k.x>=0){if(x<u){r+=k.x}else{if(k.y>=0&&g>=q){p=false}}}else{r+=k.x}if(k.y>=0){if(g<q){m+=k.y}}else{m+=k.y}}if(r<0&&m<0){t=ACTION_NORTH_WEST;m=0;r=0}else{if(r<0){t=ACTION_SOUTH_WEST;r=0}else{if(m<0){t=ACTION_NORTH_EAST;m=0}}}break;case ACTION_MOVE:this.move(k.x,k.y);p=false;break;case ACTION_ZOOM:this.zoom(getMaxZoomRatio(i),v);p=false;break;case ACTION_CROP:if(!k.x||!k.y){p=false;break}f=getOffset(this.cropper);d=s.startX-f.left;l=s.startY-f.top;r=o.minWidth;m=o.minHeight;if(k.x>0){t=k.y>0?ACTION_SOUTH_EAST:ACTION_NORTH_EAST}else{if(k.x<0){d-=r;t=k.y>0?ACTION_SOUTH_WEST:ACTION_NORTH_WEST}}if(k.y<0){l-=m}if(!this.cropped){removeClass(this.cropBox,CLASS_HIDDEN);this.cropped=true;if(this.limited){this.limitCropBox(true,true)}}break;default:}if(p){o.width=r;o.height=m;o.left=d;o.top=l;this.action=t;this.renderCropBox()}forEach(i,function(e){e.startX=e.endX;e.startY=e.endY})}};var methods={crop:function crop(){if(this.ready&&!this.cropped&&!this.disabled){this.cropped=true;this.limitCropBox(true,true);if(this.options.modal){addClass(this.dragBox,CLASS_MODAL)}removeClass(this.cropBox,CLASS_HIDDEN);this.setCropBoxData(this.initialCropBoxData)}return this},reset:function reset(){if(this.ready&&!this.disabled){this.imageData=assign({},this.initialImageData);this.canvasData=assign({},this.initialCanvasData);this.cropBoxData=assign({},this.initialCropBoxData);this.renderCanvas();if(this.cropped){this.renderCropBox()}}return this},clear:function clear(){if(this.cropped&&!this.disabled){assign(this.cropBoxData,{left:0,top:0,width:0,height:0});this.cropped=false;this.renderCropBox();this.limitCanvas(true,true);this.renderCanvas();removeClass(this.dragBox,CLASS_MODAL);addClass(this.cropBox,CLASS_HIDDEN)}return this},replace:function replace(b){var a=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;if(!this.disabled&&b){if(this.isImg){this.element.src=b}if(a){this.url=b;this.image.src=b;if(this.ready){this.viewBoxImage.src=b;forEach(this.previews,function(c){c.getElementsByTagName("img")[0].src=b})}}else{if(this.isImg){this.replaced=true}this.options.data=null;this.uncreate();this.load(b)}}return this},enable:function enable(){if(this.ready&&this.disabled){this.disabled=false;removeClass(this.cropper,CLASS_DISABLED)}return this},disable:function disable(){if(this.ready&&!this.disabled){this.disabled=true;addClass(this.cropper,CLASS_DISABLED)}return this},destroy:function destroy(){var a=this.element;if(!getData(a,NAMESPACE)){return this}if(this.isImg&&this.replaced){a.src=this.originalUrl}this.uncreate();removeData(a,NAMESPACE);return this},move:function move(a){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:a;var b=this.canvasData,d=b.left,c=b.top;return this.moveTo(isUndefined(a)?a:d+Number(a),isUndefined(e)?e:c+Number(e))},moveTo:function moveTo(a){var d=arguments.length>1&&arguments[1]!==undefined?arguments[1]:a;var b=this.canvasData;var c=false;a=Number(a);d=Number(d);if(this.ready&&!this.disabled&&this.options.movable){if(isNumber(a)){b.left=a;c=true}if(isNumber(d)){b.top=d;c=true}if(c){this.renderCanvas(true)}}return this},zoom:function zoom(c,a){var b=this.canvasData;c=Number(c);if(c<0){c=1/(1-c)}else{c=1+c}return this.zoomTo(b.width*c/b.naturalWidth,null,a)},zoomTo:function zoomTo(h,l,i){var n=this.options,e=this.canvasData;var c=e.width,m=e.height,g=e.naturalWidth,j=e.naturalHeight;h=Number(h);if(h>=0&&this.ready&&!this.disabled&&n.zoomable){var f=g*h;var b=j*h;if(dispatchEvent(this.element,EVENT_ZOOM,{originalEvent:i,oldRatio:c/g,ratio:f/g})===false){return this}if(i){var k=this.pointers;var d=getOffset(this.cropper);var a=k&&Object.keys(k).length?getPointersCenter(k):{pageX:i.pageX,pageY:i.pageY};e.left-=(f-c)*((a.pageX-d.left-e.left)/c);e.top-=(b-m)*((a.pageY-d.top-e.top)/m)}else{if(isPlainObject(l)&&isNumber(l.x)&&isNumber(l.y)){e.left-=(f-c)*((l.x-e.left)/c);e.top-=(b-m)*((l.y-e.top)/m)}else{e.left-=(f-c)/2;e.top-=(b-m)/2}}e.width=f;e.height=b;this.renderCanvas(true)}return this},rotate:function rotate(a){return this.rotateTo((this.imageData.rotate||0)+Number(a))},rotateTo:function rotateTo(a){a=Number(a);if(isNumber(a)&&this.ready&&!this.disabled&&this.options.rotatable){this.imageData.rotate=a%360;this.renderCanvas(true,true)}return this},scaleX:function scaleX(b){var a=this.imageData.scaleY;return this.scale(b,isNumber(a)?a:1)},scaleY:function scaleY(b){var a=this.imageData.scaleX;return this.scale(isNumber(a)?a:1,b)},scale:function scale(c){var a=arguments.length>1&&arguments[1]!==undefined?arguments[1]:c;var d=this.imageData;var b=false;c=Number(c);a=Number(a);if(this.ready&&!this.disabled&&this.options.scalable){if(isNumber(c)){d.scaleX=c;b=true}if(isNumber(a)){d.scaleY=a;b=true}if(b){this.renderCanvas(true,true)}}return this},getData:function getData$$1(){var a=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;var c=this.options,g=this.imageData,b=this.canvasData,f=this.cropBoxData;var e=void 0;if(this.ready&&this.cropped){e={x:f.left-b.left,y:f.top-b.top,width:f.width,height:f.height};var d=g.width/g.naturalWidth;forEach(e,function(j,h){j/=d;e[h]=a?Math.round(j):j})}else{e={x:0,y:0,width:0,height:0}}if(c.rotatable){e.rotate=g.rotate||0}if(c.scalable){e.scaleX=g.scaleX||1;e.scaleY=g.scaleY||1}return e},setData:function setData$$1(f){var c=this.options,g=this.imageData,b=this.canvasData;var e={};if(this.ready&&!this.disabled&&isPlainObject(f)){var a=false;if(c.rotatable){if(isNumber(f.rotate)&&f.rotate!==g.rotate){g.rotate=f.rotate;a=true}}if(c.scalable){if(isNumber(f.scaleX)&&f.scaleX!==g.scaleX){g.scaleX=f.scaleX;a=true}if(isNumber(f.scaleY)&&f.scaleY!==g.scaleY){g.scaleY=f.scaleY;a=true}}if(a){this.renderCanvas(true,true)}var d=g.width/g.naturalWidth;if(isNumber(f.x)){e.left=f.x*d+b.left}if(isNumber(f.y)){e.top=f.y*d+b.top}if(isNumber(f.width)){e.width=f.width*d}if(isNumber(f.height)){e.height=f.height*d}this.setCropBoxData(e)}return this},getContainerData:function getContainerData(){return this.ready?assign({},this.containerData):{}},getImageData:function getImageData(){return this.sized?assign({},this.imageData):{}},getCanvasData:function getCanvasData(){var a=this.canvasData;var b={};if(this.ready){forEach(["left","top","width","height","naturalWidth","naturalHeight"],function(c){b[c]=a[c]})}return b},setCanvasData:function setCanvasData(c){var a=this.canvasData;var b=a.aspectRatio;if(this.ready&&!this.disabled&&isPlainObject(c)){if(isNumber(c.left)){a.left=c.left}if(isNumber(c.top)){a.top=c.top}if(isNumber(c.width)){a.width=c.width;a.height=c.width/b}else{if(isNumber(c.height)){a.height=c.height;a.width=c.height*b}}this.renderCanvas(true)}return this},getCropBoxData:function getCropBoxData(){var b=this.cropBoxData;var a=void 0;if(this.ready&&this.cropped){a={left:b.left,top:b.top,width:b.width,height:b.height}}return a||{}},setCropBoxData:function setCropBoxData(e){var d=this.cropBoxData;var b=this.options.aspectRatio;var c=void 0;var a=void 0;if(this.ready&&this.cropped&&!this.disabled&&isPlainObject(e)){if(isNumber(e.left)){d.left=e.left}if(isNumber(e.top)){d.top=e.top}if(isNumber(e.width)&&e.width!==d.width){c=true;d.width=e.width}if(isNumber(e.height)&&e.height!==d.height){a=true;d.height=e.height}if(b){if(c){d.height=d.width/b}else{if(a){d.width=d.height*b}}}this.renderCropBox()}return this},getCroppedCanvas:function getCroppedCanvas(){var k=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};if(!this.ready||!window.HTMLCanvasElement){return null}var q=this.canvasData;var w=getSourceCanvas(this.image,this.imageData,q,k);if(!this.cropped){return w}var p=this.getData(),D=p.x,C=p.y,m=p.width,y=p.height;var o=w.width/Math.floor(q.naturalWidth);if(o!==1){D*=o;C*=o;m*=o;y*=o}var c=m/y;var l=getAdjustedSizes({aspectRatio:c,width:k.maxWidth||Infinity,height:k.maxHeight||Infinity});var B=getAdjustedSizes({aspectRatio:c,width:k.minWidth||0,height:k.minHeight||0},"cover");var n=getAdjustedSizes({aspectRatio:c,width:k.width||(o!==1?w.width:m),height:k.height||(o!==1?w.height:y)}),v=n.width,u=n.height;v=Math.min(l.width,Math.max(B.width,v));u=Math.min(l.height,Math.max(B.height,u));var j=document.createElement("canvas");var f=j.getContext("2d");j.width=normalizeDecimalNumber(v);j.height=normalizeDecimalNumber(u);f.fillStyle=k.fillColor||"transparent";f.fillRect(0,0,v,u);var x=k.imageSmoothingEnabled,b=x===undefined?true:x,h=k.imageSmoothingQuality;f.imageSmoothingEnabled=b;if(h){f.imageSmoothingQuality=h}var r=w.width;var g=w.height;var a=D;var F=C;var t=void 0;var A=void 0;var e=void 0;var d=void 0;var i=void 0;var s=void 0;if(a<=-m||a>r){a=0;t=0;e=0;i=0}else{if(a<=0){e=-a;a=0;t=Math.min(r,m+a);i=t}else{if(a<=r){e=0;t=Math.min(m,r-a);i=t}}}if(t<=0||F<=-y||F>g){F=0;A=0;d=0;s=0}else{if(F<=0){d=-F;F=0;A=Math.min(g,y+F);s=A}else{if(F<=g){d=0;A=Math.min(y,g-F);s=A}}}var z=[a,F,t,A];if(i>0&&s>0){var E=v/m;z.push(e*E,d*E,i*E,s*E)}f.drawImage.apply(f,[w].concat(toConsumableArray(z.map(function(G){return Math.floor(normalizeDecimalNumber(G))}))));return j},setAspectRatio:function setAspectRatio(b){var a=this.options;if(!this.disabled&&!isUndefined(b)){a.aspectRatio=Math.max(0,b)||NaN;if(this.ready){this.initCropBox();if(this.cropped){this.renderCropBox()}}}return this},setDragMode:function setDragMode(f){var a=this.options,b=this.dragBox,c=this.face;if(this.ready&&!this.disabled){var e=f===DRAG_MODE_CROP;var d=a.movable&&f===DRAG_MODE_MOVE;f=e||d?f:DRAG_MODE_NONE;a.dragMode=f;setData(b,DATA_ACTION,f);toggleClass(b,CLASS_CROP,e);toggleClass(b,CLASS_MOVE,d);if(!a.cropBoxMovable){setData(c,DATA_ACTION,f);toggleClass(c,CLASS_CROP,e);toggleClass(c,CLASS_MOVE,d)}}return this}};var AnotherCropper=WINDOW.Cropper;var Cropper=function(){function h(n){var m=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};classCallCheck(this,h);if(!n||!REGEXP_TAG_NAME.test(n.tagName)){throw new Error("The first argument is required and must be an <img> or <canvas> element.")}this.element=n;this.options=assign({},DEFAULTS,isPlainObject(m)&&m);this.cropped=false;this.disabled=false;this.pointers={};this.ready=false;this.reloading=false;this.replaced=false;this.sized=false;this.sizing=false;this.init()}createClass(h,[{key:"init",value:function k(){var o=this.element;var n=o.tagName.toLowerCase();var m=void 0;if(getData(o,NAMESPACE)){return}setData(o,NAMESPACE,this);if(n==="img"){this.isImg=true;m=o.getAttribute("src")||"";this.originalUrl=m;if(!m){return}m=o.src}else{if(n==="canvas"&&window.HTMLCanvasElement){m=o.toDataURL()}}this.load(m)}},{key:"load",value:function j(o){var r=this;if(!o){return}this.url=o;this.imageData={};var p=this.element,n=this.options;if(!n.checkOrientation||!window.ArrayBuffer){this.clone();return}if(REGEXP_DATA_URL.test(o)){if(REGEXP_DATA_URL_JPEG.test(o)){this.read(dataURLToArrayBuffer(o))}else{this.clone()}return}var q=new XMLHttpRequest();this.reloading=true;this.xhr=q;var m=function m(){r.reloading=false;r.xhr=null};q.ontimeout=m;q.onabort=m;q.onerror=function(){m();r.clone()};q.onload=function(){m();r.read(q.response)};if(n.checkCrossOrigin&&isCrossOriginURL(o)&&p.crossOrigin){o=addTimestamp(o)}q.open("get",o);q.responseType="arraybuffer";q.withCredentials=p.crossOrigin==="use-credentials";q.send()}},{key:"read",value:function c(r){var q=this.options,t=this.imageData;var n=getOrientation(r);var p=0;var o=1;var m=1;if(n>1){this.url=arrayBufferToDataURL(r,"image/jpeg");var s=parseOrientation(n);p=s.rotate;o=s.scaleX;m=s.scaleY}if(q.rotatable){t.rotate=p}if(q.scalable){t.scaleX=o;t.scaleY=m}this.clone()}},{key:"clone",value:function f(){var p=this.element,n=this.url;var m=void 0;var q=void 0;if(this.options.checkCrossOrigin&&isCrossOriginURL(n)){m=p.crossOrigin;if(m){q=n}else{m="anonymous";q=addTimestamp(n)}}this.crossOrigin=m;this.crossOriginUrl=q;var r=document.createElement("img");if(m){r.crossOrigin=m}r.src=q||n;var s=this.start.bind(this);var o=this.stop.bind(this);this.image=r;this.onStart=s;this.onStop=o;if(this.isImg){if(p.complete){this.timeout=setTimeout(s,0)}else{addListener(p,EVENT_LOAD,s,{once:true})}}else{r.onload=s;r.onerror=o;addClass(r,CLASS_HIDE);p.parentNode.insertBefore(r,p.nextSibling)}}},{key:"start",value:function b(q){var p=this;var s=this.isImg?this.element:this.image;if(q){s.onload=null;s.onerror=null}this.sizing=true;var o=WINDOW.navigator&&/(Macintosh|iPhone|iPod|iPad).*AppleWebKit/i.test(WINDOW.navigator.userAgent);var n=function n(t,u){assign(p.imageData,{naturalWidth:t,naturalHeight:u,aspectRatio:t/u});p.sizing=false;p.sized=true;p.build()};if(s.naturalWidth&&!o){n(s.naturalWidth,s.naturalHeight);return}var r=document.createElement("img");var m=document.body||document.documentElement;this.sizingImage=r;r.onload=function(){n(r.width,r.height);if(!o){m.removeChild(r)}};r.src=s.src;if(!o){r.style.cssText="left:0;max-height:none!important;max-width:none!important;min-height:0!important;min-width:0!important;opacity:0;position:absolute;top:0;z-index:-1;";m.appendChild(r)}}},{key:"stop",value:function g(){var m=this.image;m.onload=null;m.onerror=null;m.parentNode.removeChild(m);this.image=null}},{key:"build",value:function i(){if(!this.sized||this.ready){return}var s=this.element,v=this.options,p=this.image;var n=s.parentNode;var u=document.createElement("div");u.innerHTML=TEMPLATE;var m=u.querySelector("."+NAMESPACE+"-container");var o=m.querySelector("."+NAMESPACE+"-canvas");var r=m.querySelector("."+NAMESPACE+"-drag-box");var q=m.querySelector("."+NAMESPACE+"-crop-box");var t=q.querySelector("."+NAMESPACE+"-face");this.container=n;this.cropper=m;this.canvas=o;this.dragBox=r;this.cropBox=q;this.viewBox=m.querySelector("."+NAMESPACE+"-view-box");this.face=t;o.appendChild(p);addClass(s,CLASS_HIDDEN);n.insertBefore(m,s.nextSibling);if(!this.isImg){removeClass(p,CLASS_HIDE)}this.initPreview();this.bind();v.aspectRatio=Math.max(0,v.aspectRatio)||NaN;v.viewMode=Math.max(0,Math.min(3,Math.round(v.viewMode)))||0;addClass(q,CLASS_HIDDEN);if(!v.guides){addClass(q.getElementsByClassName(NAMESPACE+"-dashed"),CLASS_HIDDEN)}if(!v.center){addClass(q.getElementsByClassName(NAMESPACE+"-center"),CLASS_HIDDEN)}if(v.background){addClass(m,NAMESPACE+"-bg")}if(!v.highlight){addClass(t,CLASS_INVISIBLE)}if(v.cropBoxMovable){addClass(t,CLASS_MOVE);setData(t,DATA_ACTION,ACTION_ALL)}if(!v.cropBoxResizable){addClass(q.getElementsByClassName(NAMESPACE+"-line"),CLASS_HIDDEN);addClass(q.getElementsByClassName(NAMESPACE+"-point"),CLASS_HIDDEN)}this.render();this.ready=true;this.setDragMode(v.dragMode);if(v.autoCrop){this.crop()}this.setData(v.data);if(isFunction(v.ready)){addListener(s,EVENT_READY,v.ready,{once:true})}dispatchEvent(s,EVENT_READY)}},{key:"unbuild",value:function l(){if(!this.ready){return}this.ready=false;this.unbind();this.resetPreview();this.cropper.parentNode.removeChild(this.cropper);removeClass(this.element,CLASS_HIDDEN)}},{key:"uncreate",value:function a(){var m=this.element;if(this.ready){this.unbuild();this.ready=false;this.cropped=false}else{if(this.sizing){this.sizingImage.onload=null;this.sizing=false;this.sized=false}else{if(this.reloading){this.xhr.abort()}else{if(this.isImg){if(m.complete){clearTimeout(this.timeout)}else{removeListener(m,EVENT_LOAD,this.onStart)}}else{if(this.image){this.stop()}}}}}}}],[{key:"noConflict",value:function d(){window.Cropper=AnotherCropper;return h}},{key:"setDefaults",value:function e(m){assign(DEFAULTS,isPlainObject(m)&&m)}}]);return h}();assign(Cropper.prototype,render,preview,events,handlers,change,methods);module.exports=Cropper;