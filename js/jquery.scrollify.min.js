/*!
 * jQuery Scrollify
 * Version 1.0.19
 *
 * Requires:
 * - jQuery 1.7 or higher
 *
 * https://github.com/lukehaas/Scrollify
 *
 * Copyright 2016, Luke Haas
 * Permission is hereby granted, free of charge, to any person obtaining a copy of
 * this software and associated documentation files (the "Software"), to deal in
 * the Software without restriction, including without limitation the rights to
 * use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of
 * the Software, and to permit persons to whom the Software is furnished to do so,
 * subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS
 * FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR
 * COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER
 * IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN
 * CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.



if touchScroll is false - update index

 */
(function(b,a){if(typeof define==="function"&&define.amd){define(["jquery"],function(c){return a(c,b,b.document)})}else{if(typeof module==="object"&&module.exports){module.exports=a(require("jquery"),b,b.document)}else{a(jQuery,b,b.document)}}}(typeof window!=="undefined"?window:this,function(w,A,c,i){var C=[],G=[],d=[],B=[],v=0,b=0,p=1,o=false,n,D,E=w(A),j,f=E.scrollTop(),u=false,t=false,q=false,H,J,g,x=false,I=[],e=new Date().getTime(),h=true,a=false,k=0,y="onwheel" in c?"wheel":c.onmousewheel!==i?"mousewheel":"DOMMouseScroll",F={section:".section",sectionName:"section-name",interstitialSection:"",easing:"easeOutExpo",scrollSpeed:1100,offset:0,scrollbars:true,target:"html,body",standardScrollElements:false,setHeights:true,overflowScroll:true,updateHash:true,touchScroll:true,before:function(){},after:function(){},afterResize:function(){},afterRender:function(){}};function s(){return(E.height()+F.offset)}function z(L,K,N,M){if(b===L){N=false}if(x===true){return true}if(G[L]){u=false;if(h===true){F.afterRender();h=false}if(N){if(typeof F.before=="function"&&F.before(L,d)===false){return true}}p=1;k=C[L];if(h===false&&b>L&&M===false){if(B[L]){j=s();p=parseInt(d[L].outerHeight()/j);k=parseInt(C[L])+(d[L].outerHeight()-j)}}if(F.updateHash&&F.sectionName&&!(h===true&&L===0)){if(history.pushState){try{history.replaceState(null,null,G[L])}catch(O){if(A.console){console.warn("Scrollify warning: Page must be hosted to manipulate the hash value.")}}}else{A.location.hash=G[L]}}b=L;if(K){w(F.target).stop().scrollTop(k);if(N){F.after(L,d)}}else{t=true;if(w().velocity){w(F.target).stop().velocity("scroll",{duration:F.scrollSpeed,easing:F.easing,offset:k,mobileHA:false})}else{w(F.target).stop().animate({scrollTop:k},F.scrollSpeed,F.easing)}if(A.location.hash.length&&F.sectionName&&A.console){try{if(w(A.location.hash).length){console.warn("Scrollify warning: ID matches hash value - this will cause the page to anchor.")}}catch(O){}}w(F.target).promise().done(function(){t=false;h=false;if(N){F.after(L,d)}})}}}function r(L){function N(P){var R=0;var O=L.slice(Math.max(L.length-P,1));for(var Q=0;Q<O.length;Q++){R+=O[Q]}return Math.ceil(R/P)}var M=N(10);var K=N(70);if(M>=K){return true}else{return false}}var m=function(L){a=true;w.easing.easeOutExpo=function(R,S,Q,U,T){return(S==T)?Q+U:U*(-Math.pow(2,-10*S/T)+1)+Q};H={handleMousedown:function(){if(x===true){return true}u=false;q=false},handleMouseup:function(){if(x===true){return true}u=true;if(q){H.calculateNearest(false,true)}},handleScroll:function(){if(x===true){return true}if(n){clearTimeout(n)}n=setTimeout(function(){q=true;if(u===false){return false}u=false;H.calculateNearest(false,true)},200)},calculateNearest:function(R,V){f=E.scrollTop();var S=1,Q=C.length,U=0,T=Math.abs(C[0]-f),W;for(;S<Q;S++){W=Math.abs(C[S]-f);if(W<T){T=W;U=S}}if((M()&&U>v)||O()){v=U;z(U,R,V,false)}},wheelHandler:function(R){if(x===true){return true}else{if(F.standardScrollElements){if(w(R.target).is(F.standardScrollElements)||w(R.target).closest(F.standardScrollElements).length){return true}}}if(!B[v]){R.preventDefault()}var T=new Date().getTime();R=R||A.event;var Q=R.originalEvent.wheelDelta||-R.originalEvent.deltaY||-R.originalEvent.detail;var S=Math.max(-1,Math.min(1,Q));if(I.length>149){I.shift()}I.push(Math.abs(Q));if((T-e)>200){I=[]}e=T;if(t){return false}if(S<0){if(v<C.length-1){if(M()){if(r(I)){R.preventDefault();v++;t=true;z(v,false,true,false)}else{return false}}}}else{if(S>0){if(v>0){if(O()){if(r(I)){R.preventDefault();v--;t=true;z(v,false,true,false)}else{return false}}}}}},keyHandler:function(Q){if(x===true||c.activeElement.readOnly===false){return true}if(t===true){return false}if(Q.keyCode==38||Q.keyCode==33){if(v>0){if(O()){Q.preventDefault();v--;z(v,false,true,false)}}}else{if(Q.keyCode==40||Q.keyCode==34){if(v<C.length-1){if(M()){Q.preventDefault();v++;z(v,false,true,false)}}}}},init:function(){if(F.scrollbars){E.on("mousedown",H.handleMousedown);E.on("mouseup",H.handleMouseup);E.on("scroll",H.handleScroll)}else{w("body").css({overflow:"hidden"})}E.on(y,H.wheelHandler);E.on("keydown",H.keyHandler)}};J={touches:{touchstart:{y:-1,x:-1},touchmove:{y:-1,x:-1},touchend:false,direction:"undetermined"},options:{distance:30,timeGap:800,timeStamp:new Date().getTime()},touchHandler:function(Q){if(x===true){return true}else{if(F.standardScrollElements){if(w(Q.target).is(F.standardScrollElements)||w(Q.target).closest(F.standardScrollElements).length){return true}}}var R;if(typeof Q!=="undefined"){if(typeof Q.touches!=="undefined"){R=Q.touches[0];switch(Q.type){case"touchstart":J.touches.touchstart.y=R.pageY;J.touches.touchmove.y=-1;J.touches.touchstart.x=R.pageX;J.touches.touchmove.x=-1;J.options.timeStamp=new Date().getTime();J.touches.touchend=false;case"touchmove":J.touches.touchmove.y=R.pageY;J.touches.touchmove.x=R.pageX;if(J.touches.touchstart.y!==J.touches.touchmove.y&&(Math.abs(J.touches.touchstart.y-J.touches.touchmove.y)>Math.abs(J.touches.touchstart.x-J.touches.touchmove.x))){Q.preventDefault();J.touches.direction="y";if((J.options.timeStamp+J.options.timeGap)<(new Date().getTime())&&J.touches.touchend==false){J.touches.touchend=true;if(J.touches.touchstart.y>-1){if(Math.abs(J.touches.touchmove.y-J.touches.touchstart.y)>J.options.distance){if(J.touches.touchstart.y<J.touches.touchmove.y){J.up()}else{J.down()}}}}}break;case"touchend":if(J.touches[Q.type]===false){J.touches[Q.type]=true;if(J.touches.touchstart.y>-1&&J.touches.touchmove.y>-1&&J.touches.direction==="y"){if(Math.abs(J.touches.touchmove.y-J.touches.touchstart.y)>J.options.distance){if(J.touches.touchstart.y<J.touches.touchmove.y){J.up()}else{J.down()}}J.touches.touchstart.y=-1;J.touches.touchstart.x=-1;J.touches.direction="undetermined"}}default:break}}}},down:function(){if(v<C.length){if(M()&&v<C.length-1){v++;z(v,false,true,false)}else{j=s();if(Math.floor(d[v].height()/j)>p){K(parseInt(C[v])+(j*p));p+=1}else{K(parseInt(C[v])+(d[v].outerHeight()-j))}}}},up:function(){if(v>=0){if(O()&&v>0){v--;z(v,false,true,false)}else{if(p>2){j=s();p-=1;K(parseInt(C[v])+(j*p))}else{p=1;K(parseInt(C[v]))}}}},init:function(){if(c.addEventListener&&F.touchScroll){var Q={passive:false};c.addEventListener("touchstart",J.touchHandler,Q);c.addEventListener("touchmove",J.touchHandler,Q);c.addEventListener("touchend",J.touchHandler,Q)}}};g={refresh:function(R,Q){clearTimeout(D);D=setTimeout(function(){P(true);N(Q,false);if(R){F.afterResize()}},400)},handleUpdate:function(){g.refresh(false,false)},handleResize:function(){g.refresh(true,false)},handleOrientation:function(){g.refresh(true,true)}};F=w.extend(F,L);P(false);N(false,true);if(true===o){z(v,false,true,true)}else{setTimeout(function(){H.calculateNearest(true,false)},200)}if(C.length){H.init();J.init();E.on("resize",g.handleResize);if(c.addEventListener){A.addEventListener("orientationchange",g.handleOrientation,false)}}function K(Q){if(w().velocity){w(F.target).stop().velocity("scroll",{duration:F.scrollSpeed,easing:F.easing,offset:Q,mobileHA:false})}else{w(F.target).stop().animate({scrollTop:Q},F.scrollSpeed,F.easing)}}function P(R){if(R){f=E.scrollTop()}var Q=F.section;B=[];if(F.interstitialSection.length){Q+=","+F.interstitialSection}if(F.scrollbars===false){F.overflowScroll=false}j=s();w(Q).each(function(S){var T=w(this);if(F.setHeights){if(T.is(F.interstitialSection)){B[S]=false}else{if((T.css("height","auto").outerHeight()<j)||T.css("overflow")==="hidden"){T.css({height:j});B[S]=false}else{T.css({height:T.height()});if(F.overflowScroll){B[S]=true}else{B[S]=false}}}}else{if((T.outerHeight()<j)||(F.overflowScroll===false)){B[S]=false}else{B[S]=true}}});if(R){E.scrollTop(f)}}function N(R,S){var Q=F.section;if(F.interstitialSection.length){Q+=","+F.interstitialSection}C=[];G=[];d=[];w(Q).each(function(T){var V=w(this);if(T>0){C[T]=parseInt(V.offset().top)+F.offset}else{C[T]=parseInt(V.offset().top)}if(F.sectionName&&V.data(F.sectionName)){G[T]="#"+V.data(F.sectionName).toString().replace(/ /g,"-")}else{if(V.is(F.interstitialSection)===false){G[T]="#"+(T+1)}else{G[T]="#";if(T===w(Q).length-1&&T>1){C[T]=C[T-1]+(parseInt(w(w(Q)[T-1]).outerHeight())-parseInt(w(A).height()))+parseInt(V.outerHeight())}}}d[T]=V;try{if(w(G[T]).length&&A.console){console.warn("Scrollify warning: Section names can't match IDs - this will cause the browser to anchor.")}}catch(U){}if(A.location.hash===G[T]){v=T;o=true}});if(true===R){z(v,false,false,false)}}function O(){if(!B[v]){return true}f=E.scrollTop();if(f>parseInt(C[v])){return false}else{return true}}function M(){if(!B[v]){return true}f=E.scrollTop();j=s();if(f<parseInt(C[v])+(d[v].outerHeight()-j)-28){return false}else{return true}}};function l(K,L){var M=G.length;for(;M>=0;M--){if(typeof K==="string"){if(G[M]===K){v=M;z(M,L,true,true)}}else{if(M===K){v=M;z(M,L,true,true)}}}}m.move=function(K){if(K===i){return false}if(K.originalEvent){K=w(this).attr("href")}l(K,false)};m.instantMove=function(K){if(K===i){return false}l(K,true)};m.next=function(){if(v<G.length){v+=1;z(v,false,true,true)}};m.previous=function(){if(v>0){v-=1;z(v,false,true,true)}};m.instantNext=function(){if(v<G.length){v+=1;z(v,true,true,true)}};m.instantPrevious=function(){if(v>0){v-=1;z(v,true,true,true)}};m.destroy=function(){if(!a){return false}if(F.setHeights){w(F.section).each(function(){w(this).css("height","auto")})}E.off("resize",g.handleResize);if(F.scrollbars){E.off("mousedown",H.handleMousedown);E.off("mouseup",H.handleMouseup);E.off("scroll",H.handleScroll)}E.off(y,H.wheelHandler);E.off("keydown",H.keyHandler);if(c.addEventListener&&F.touchScroll){c.removeEventListener("touchstart",J.touchHandler,false);c.removeEventListener("touchmove",J.touchHandler,false);c.removeEventListener("touchend",J.touchHandler,false)}C=[];G=[];d=[];B=[]};m.update=function(){if(!a){return false}g.handleUpdate()};m.current=function(){return d[v]};m.currentIndex=function(){return v};m.disable=function(){x=true};m.enable=function(){x=false;if(a){H.calculateNearest(false,false)}};m.isDisabled=function(){return x};m.setOptions=function(K){if(!a){return false}if(typeof K==="object"){F=w.extend(F,K);g.handleUpdate()}else{if(A.console){console.warn("Scrollify warning: setOptions expects an object.")}}};w.scrollify=m;return m}));